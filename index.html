<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Artificial Intelligence Math Foundations</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Comic+Neue:wght@400;700&family=Fredoka:wght@400;600;700&family=Nunito:wght@400;600;700&family=Playfair+Display:wght@500;700&family=Source+Sans+3:wght@400;600;700&display=swap" rel="stylesheet">
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)'], ['$', '$']],
                displayMath: [['\\[', '\\]'], ['$$', '$$']]
            },
            svg: { fontCache: 'global' }
        };
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>
<body data-theme="light">
    <header>
        <h1>üß† Artificial Intelligence Math Foundations</h1>
        <p>Playful visuals and mini missions to explore the math behind neural networks</p>
        <div class="mode-switcher" role="group" aria-label="Theme mode">
            <span class="mode-label">Mode:</span>
            <button class="mode-btn is-active" data-theme="light" type="button">Light</button>
            <button class="mode-btn" data-theme="dark" type="button">Dark</button>
            <button class="mode-btn" data-theme="kid" type="button">Kid Comic</button>
            <button class="mode-btn" data-theme="holiday" type="button">Holiday Kids</button>
            <button class="mode-btn" data-theme="adult" type="button">Adult</button>
        </div>
    </header>

    <div class="chapter-switcher" role="tablist" aria-label="Learning chapters">
        <button class="chapter-btn is-active" type="button" role="tab" aria-selected="true" data-chapter="foundations">Foundations</button>
        <button class="chapter-btn" type="button" role="tab" aria-selected="false" data-chapter="ml">Machine Learning</button>
        <button class="chapter-btn" type="button" role="tab" aria-selected="false" data-chapter="neural">Neural Networks</button>
        <button class="chapter-btn" type="button" role="tab" aria-selected="false" data-chapter="llm-foundations">Large Language Models</button>
        <button class="chapter-btn" type="button" role="tab" aria-selected="false" data-chapter="reinforcement-learning">Reinforcement Learning</button>
        <button class="chapter-btn" type="button" role="tab" aria-selected="false" data-chapter="notebook">Notebook Lab</button>
    </div>

    <div class="holiday-parade" aria-hidden="true">
        <div class="snow-layer" aria-hidden="true">
            <span class="snowflake" style="--x: 6%; --delay: 0s; --duration: 9s; --size: 14px;">‚ùÑ</span>
            <span class="snowflake" style="--x: 14%; --delay: 2s; --duration: 11s; --size: 18px;">‚ùÑ</span>
            <span class="snowflake" style="--x: 22%; --delay: 1s; --duration: 8s; --size: 12px;">‚ùÑ</span>
            <span class="snowflake" style="--x: 32%; --delay: 3s; --duration: 10s; --size: 16px;">‚ùÑ</span>
            <span class="snowflake" style="--x: 44%; --delay: 0.5s; --duration: 12s; --size: 20px;">‚ùÑ</span>
            <span class="snowflake" style="--x: 54%; --delay: 1.5s; --duration: 9.5s; --size: 13px;">‚ùÑ</span>
            <span class="snowflake" style="--x: 63%; --delay: 2.4s; --duration: 11.5s; --size: 17px;">‚ùÑ</span>
            <span class="snowflake" style="--x: 71%; --delay: 0.2s; --duration: 8.5s; --size: 12px;">‚ùÑ</span>
            <span class="snowflake" style="--x: 79%; --delay: 1.1s; --duration: 10.5s; --size: 15px;">‚ùÑ</span>
            <span class="snowflake" style="--x: 88%; --delay: 2.7s; --duration: 9.2s; --size: 19px;">‚ùÑ</span>
            <span class="snowflake" style="--x: 95%; --delay: 3.4s; --duration: 12.5s; --size: 14px;">‚ùÑ</span>
        </div>
        <div class="santa-ride" aria-hidden="true">
            <span class="santa-emoji" aria-hidden="true">üéÖ</span>
            <span class="santa-emoji" aria-hidden="true">üõ∑</span>
        </div>
    </div>

    <main>
        <section class="chapter is-active" data-chapter="foundations">
            <nav class="chapter-nav" aria-label="Foundations sections">
                <a href="#ai-categories">What is AI?</a>
                <a href="#fundamentals">Foundations</a>
                <a href="#vectors">Vectors</a>
                <a href="#matrices">Matrices</a>
                <a href="#probability">Probability</a>
                <a href="#gradient-descent">Gradient Descent</a>
                <a href="#activations">Activation Functions</a>
            </nav>

            <section class="example-section ai-intro" id="ai-categories">
                <div class="ai-hero">
                    <div class="ai-hero-copy">
                        <h2>What is AI?</h2>
                        <p class="section-intro">AI builds systems that can sense, decide, and improve with data.</p>
                        <div class="ai-definition">
                            <p><strong>Artificial Intelligence (AI)</strong> is the field of creating systems that perceive their world, reason or learn from data, and choose actions to reach goals.</p>
                        </div>
                        <div class="ai-intuition">
                            <article class="ai-intuition-card">
                                <h3>Intuition: a curious student</h3>
                                <p>AI studies examples, forms internal rules, then gets feedback to refine them.</p>
                            </article>
                            <article class="ai-intuition-card">
                                <h3>Intuition: a navigator</h3>
                                <p>AI observes a map, plans a route, acts, then updates the plan after each step.</p>
                            </article>
                        </div>
                    </div>
                    <div class="ai-hero-visual" aria-hidden="true">
                        <div class="ai-loop">
                            <span class="ai-loop-step">Perceive</span>
                            <span class="ai-loop-arrow">&rarr;</span>
                            <span class="ai-loop-step">Represent</span>
                            <span class="ai-loop-arrow">&rarr;</span>
                            <span class="ai-loop-step">Learn/Plan</span>
                            <span class="ai-loop-arrow">&rarr;</span>
                            <span class="ai-loop-step">Act</span>
                            <span class="ai-loop-arrow">&rarr;</span>
                            <span class="ai-loop-step">Feedback</span>
                        </div>
                        <div class="ai-goal">Goal: reduce error or maximize reward</div>
                        <div class="ai-signal-grid">
                            <span class="ai-signal">Data</span>
                            <span class="ai-signal">Model</span>
                            <span class="ai-signal">Action</span>
                        </div>
                        <div class="math-formula math-mini ai-math-flow">
                            \[
                            \mathbf{x} \xrightarrow{f_\theta} \hat{\mathbf{y}}
                            \quad L(\hat{\mathbf{y}}, \mathbf{y})
                            \quad \theta \leftarrow \theta - \eta \nabla_\theta L
                            \]
                        </div>
                    </div>
                </div>
                <div class="ai-categories">
                    <h3>AI categories in practice</h3>
                    <p class="section-intro">Different AI families focus on different parts of the loop, but they often work together.</p>
                    <div class="ai-category-grid">
                        <article class="ai-category-card">
                            <h4>Symbolic & search</h4>
                            <p>Rules, logic, planning, and graph search to make decisions.</p>
                        </article>
                        <article class="ai-category-card">
                            <h4>Machine learning</h4>
                            <p>Models that learn patterns from labeled or unlabeled data.</p>
                        </article>
                        <article class="ai-category-card">
                            <h4>Deep learning</h4>
                            <p>Neural networks for vision, speech, language, and high-dimensional signals.</p>
                        </article>
                        <article class="ai-category-card">
                            <h4>Reinforcement learning</h4>
                            <p>Agents learn policies through interaction and rewards.</p>
                        </article>
                        <article class="ai-category-card">
                            <h4>Generative AI</h4>
                            <p>Models that create text, images, or audio from learned distributions.</p>
                        </article>
                        <article class="ai-category-card">
                            <h4>Embodied & robotics</h4>
                            <p>Perception plus control to act in the physical world.</p>
                        </article>
                    </div>
                    <p class="ai-category-note">Most real systems blend categories, such as robots that plan with search and see with deep learning.</p>
                </div>
            </section>

            <!-- Foundations Section -->
            <section id="fundamentals" class="example-section fundamentals-section">
                <h2>Foundations: Core Math Roadmap</h2>
                <p class="section-intro">A compact roadmap of the math that powers modern AI. Switch tabs to see each idea in action.</p>
                <div class="learning-path">
                    <div class="path-card">
                        <span class="path-step">Step 1</span>
                        <h4>Linear Algebra: Space Benders</h4>
                        <p>Learn how vectors and matrices stretch, rotate, and move space.</p>
                        <span class="path-goal">Goal: read \( \mathbf{h} = W\mathbf{x} + \mathbf{b} \).</span>
                    </div>
                    <div class="path-card">
                        <span class="path-step">Step 2</span>
                        <h4>Calculus: Change Detective</h4>
                        <p>Understand slopes, tiny nudges, and the chain rule.</p>
                        <span class="path-goal">Goal: follow gradients through a network.</span>
                    </div>
                    <div class="path-card">
                        <span class="path-step">Step 3</span>
                        <h4>Optimization: Mountain Hikes</h4>
                        <p>Use gradients to walk downhill and find the best answers.</p>
                        <span class="path-goal">Goal: tune the learning rate \( \eta \).</span>
                    </div>
                    <div class="path-card">
                        <span class="path-step">Step 4</span>
                        <h4>Probability: Confidence Radar</h4>
                        <p>Turn scores into probabilities and measure mistakes.</p>
                        <span class="path-goal">Goal: use softmax and cross-entropy.</span>
                    </div>
                    <div class="path-card">
                        <span class="path-step">Step 5</span>
                        <h4>Matrix Calculus: Fast Backprop</h4>
                        <p>Compute gradients for whole batches at once.</p>
                        <span class="path-goal">Goal: track shapes and vectorized rules.</span>
                    </div>
                </div>
                <div class="content-grid fundamentals-grid">
                    <div class="explanation">
                    <p class="foundation-lead">Neural networks are a stack of math ideas. Each tab below zooms in on one layer of that stack.</p>
                    <div class="concept-tabs" role="tablist">
                        <button class="concept-tab is-active" data-topic="linear" role="tab" aria-controls="concept-linear" aria-selected="true">Linear Algebra</button>
                        <button class="concept-tab" data-topic="calculus" role="tab" aria-controls="concept-calculus" aria-selected="false">Calculus</button>
                        <button class="concept-tab" data-topic="optimization" role="tab" aria-controls="concept-optimization" aria-selected="false">Optimization</button>
                        <button class="concept-tab" data-topic="probability" role="tab" aria-controls="concept-probability" aria-selected="false">Probability</button>
                        <button class="concept-tab" data-topic="matrix" role="tab" aria-controls="concept-matrix" aria-selected="false">Matrix Calc</button>
                    </div>
                    <div class="concept-panels">
                        <div class="concept-panel is-active" id="concept-linear" data-topic="linear" role="tabpanel">
                            <h3>Linear algebra: what the network is</h3>
                            <p>Think of a matrix as a magic machine that bends space. Each layer takes a vector and transforms it.</p>
                            <div class="math-formula">
                                \[
                                \mathbf{h} = W\mathbf{x} + \mathbf{b}
                                \]
                                \[
                                \mathbf{a} = \mathrm{ReLU}(\mathbf{h})
                                \]
                            </div>
                            <p>Imagine a grid of points being stretched and tilted. That is what \(W\) does.</p>
                            <ul class="concept-bullets">
                                <li>Vectors are arrows (direction + length).</li>
                                <li>Matrices are transformations (stretch, rotate, shear).</li>
                                <li>Layers stack these transformations with a nonlinearity.</li>
                            </ul>
                            <div class="mini-mission">Mini mission: pick a vector and predict where the grid sends it.</div>
                        </div>
                        <div class="concept-panel" id="concept-calculus" data-topic="calculus" role="tabpanel">
                            <h3>Calculus: how learning works</h3>
                            <p>Derivatives tell us how fast things change. If the loss is a hill, the derivative tells the slope.</p>
                            <div class="math-formula">
                                \[
                                \frac{d}{dx}f(g(x)) = f'(g(x)) \cdot g'(x)
                                \]
                            </div>
                            <p>Backprop is the chain rule applied again and again through the whole network.</p>
                            <ul class="concept-bullets">
                                <li>Local slope \(\times\) upstream slope = new slope.</li>
                                <li>Think of it as water flowing through pipes.</li>
                            </ul>
                            <div class="mini-mission">Mini mission: point to where the slope is steepest.</div>
                        </div>
                        <div class="concept-panel" id="concept-optimization" data-topic="optimization" role="tabpanel">
                            <h3>Optimization: gradient descent and learning rate</h3>
                            <p>Once we know the slope, we take a step downhill to reduce the loss.</p>
                            <div class="math-formula">
                                \[
                                \theta \leftarrow \theta - \eta \nabla_\theta L
                                \]
                            </div>
                            <ul>
                                <li><strong>\(\eta\)</strong>: learning rate (step size)</li>
                                <li>Too big &rarr; unstable or diverges</li>
                                <li>Too small &rarr; slow progress</li>
                            </ul>
                            <div class="mini-mission">Mini mission: choose a step size that reaches the valley without bouncing.</div>
                        </div>
                        <div class="concept-panel" id="concept-probability" data-topic="probability" role="tabpanel">
                            <h3>Probability + information theory</h3>
                            <p>For classification, the network turns scores into probabilities and compares them to the truth.</p>
                            <div class="math-formula">
                                \[
                                \mathbf{z} = W\mathbf{x} + \mathbf{b}
                                \]
                                \[
                                \hat{y}_i = \frac{e^{z_i}}{\sum_k e^{z_k}}
                                \]
                                \[
                                L = -\sum_i y_i \log \hat{y}_i
                                \]
                            </div>
                            <p>Loss derivation: with \( \hat{\mathbf{y}} = \mathrm{softmax}(\mathbf{z}) \), the log-softmax derivative gives a simple gradient.</p>
                            <div class="math-formula">
                                \[
                                \frac{\partial L}{\partial z_j} = \sum_i y_i (\hat{y}_j - \delta_{ij}) = \hat{y}_j - y_j
                                \]
                            </div>
                            <p>Result: \( \nabla_{\mathbf{z}} L = \hat{\mathbf{y}} - \mathbf{y} \), the signal that drives backprop.</p>
                            <div class="mini-mission">Mini mission: spot the biggest probability bar.</div>
                        </div>
                        <div class="concept-panel" id="concept-matrix" data-topic="matrix" role="tabpanel">
                            <h3>Matrix calculus: the speed path</h3>
                            <p>To train fast, we compute gradients for a whole batch at once.</p>
                            <div class="math-formula">
                                \[
                                Y = XW
                                \]
                                \[
                                \frac{\partial L}{\partial X} = \frac{\partial L}{\partial Y} W^T
                                \]
                                \[
                                \frac{\partial L}{\partial W} = X^T \frac{\partial L}{\partial Y}
                                \]
                            </div>
                            <p>Shapes are your superpower: match the dimensions and the math works out.</p>
                            <div class="mini-mission">Mini mission: label the shapes of \(X\), \(W\), and \(Y\).</div>
                        </div>
                    </div>
                </div>
                    <div class="visualization">
                        <canvas id="fundamentalsCanvas" width="420" height="360"></canvas>
                        <div class="controls fundamentals-controls">
                            <button onclick="cycleFundamentals()">Next concept</button>
                            <p class="helper-text">Tap a tab to switch the picture.</p>
                        </div>
                    </div>
                </div>
            </section>

        <!-- Vectors Section -->
        <section id="vectors" class="example-section">
            <h2>Vectors: direction, magnitude, and meaning</h2>
            <p class="section-intro">Explore vectors as data points, similarity scores, and distances. Switch to Deep Dive for norms, projections, and basis intuition.</p>
            <div class="vector-mode-switcher" role="group" aria-label="Vector depth mode">
                <button class="toggle-btn is-active" type="button" data-vector-mode="basic">Basic playground</button>
                <button class="toggle-btn" type="button" data-vector-mode="deep">Deep dive</button>
            </div>
            <div class="vector-mode-panel is-active" data-vector-mode="basic">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Vector playground</h3>
                        <p>Think of vector A as a data point \(x\) and vector B as model weights \(w\). Use the buttons to see how scores and distances behave.</p>
                        <ul class="concept-bullets">
                            <li>Data point: the arrow from the origin to \(x\).</li>
                            <li>Dot product: the shadow of \(x\) on \(w\).</li>
                            <li>Cosine: angle-only similarity.</li>
                            <li>Distance: how far two points are apart.</li>
                        </ul>
                        <div class="math-formula" id="vectorOperationFormula">\[
                        x = [x_1, x_2], \quad w = [w_1, w_2]
                        \]</div>
                        <div class="vector-metrics">
                            <div class="metric" data-vector-metric="sum">
                                <span class="metric-label">x + w</span>
                                <span class="metric-value" id="vectorSum">[0, 0]</span>
                            </div>
                            <div class="metric" data-vector-metric="dot">
                                <span class="metric-label">Dot</span>
                                <span class="metric-value" id="vectorDot">0</span>
                            </div>
                            <div class="metric" data-vector-metric="cosine">
                                <span class="metric-label">Cosine</span>
                                <span class="metric-value" id="vectorCosine">0</span>
                            </div>
                            <div class="metric" data-vector-metric="angle">
                                <span class="metric-label">Angle</span>
                                <span class="metric-value" id="vectorAngle">0¬∞</span>
                            </div>
                            <div class="metric" data-vector-metric="distance">
                                <span class="metric-label">Distance</span>
                                <span class="metric-value" id="vectorDistance">0</span>
                            </div>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="vectorCanvas" width="400" height="400"></canvas>
                        <div class="controls vector-controls">
                            <div class="toggle-group" role="group" aria-label="Vector operation">
                                <button class="toggle-btn is-active" type="button" data-vector-op="data">Data point</button>
                                <button class="toggle-btn" type="button" data-vector-op="addition">Addition</button>
                                <button class="toggle-btn" type="button" data-vector-op="dot">Dot product</button>
                                <button class="toggle-btn" type="button" data-vector-op="cosine">Cosine</button>
                                <button class="toggle-btn" type="button" data-vector-op="distance">Distance</button>
                            </div>
                            <div class="slider-group">
                                <span class="slider-title">Vector A (x)</span>
                                <label>A.x <span id="vecAxVal">2.0</span></label>
                                <input type="range" id="vecAx" min="-4" max="4" step="0.1" value="2">
                                <label>A.y <span id="vecAyVal">3.0</span></label>
                                <input type="range" id="vecAy" min="-4" max="4" step="0.1" value="3">
                            </div>
                            <div class="slider-group">
                                <span class="slider-title">Vector B (w)</span>
                                <label>B.x <span id="vecBxVal">1.0</span></label>
                                <input type="range" id="vecBx" min="-4" max="4" step="0.1" value="1">
                                <label>B.y <span id="vecByVal">4.0</span></label>
                                <input type="range" id="vecBy" min="-4" max="4" step="0.1" value="4">
                            </div>
                            <div class="slider-group">
                                <span class="slider-title">Zoom</span>
                                <label>Zoom <span id="vecScaleVal">1.0</span></label>
                                <input type="range" id="vecScale" min="0.5" max="2" step="0.1" value="1">
                            </div>
                            <button type="button" id="vectorAnimateButton" onclick="animateVectorAddition()">Animate Addition</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="vector-mode-panel" data-vector-mode="deep">
                <div class="content-grid vector-scenes">
                    <div class="explanation">
                        <h3>Deep dive: advanced geometry</h3>
                        <p>Step through projections, norms, subspaces, gradients, vector stats, regularization, and attention with visual intuition.</p>
                        <div class="math-formula">
                            \[
                            \lVert x \rVert = \sqrt{x_1^2 + x_2^2}, \quad x \cdot w = \sum_i x_i w_i, \quad x = \sum_i \alpha_i b_i
                            \]
                        </div>
                        <div class="scene-panel" id="vectorScenePanel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="vectorSceneBadge">Scene 1 of 7</span>
                                <h4 id="vectorSceneTitle">Scene 1: Projections and orthogonality</h4>
                            </div>
                            <div class="scene-block">
                                <h5>Visual</h5>
                                <p id="vectorSceneVisual"></p>
                            </div>
                            <div class="scene-block">
                                <h5>Mini example</h5>
                                <p id="vectorSceneExample"></p>
                            </div>
                            <div class="scene-block">
                                <h5>ML intuition</h5>
                                <p id="vectorSceneIntuition"></p>
                            </div>
                            <div class="math-formula" id="vectorSceneMath"></div>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="vectorSceneCanvas" width="420" height="360"></canvas>
                        <div class="controls scene-controls">
                            <button type="button" id="vectorPrevScene">Previous scene</button>
                            <button type="button" id="vectorNextScene">Next scene</button>
                        </div>
                    </div>
                </div>
                <div class="vector-toolkit">
                    <h3>Deep dive concepts</h3>
                    <p class="section-intro">Advanced vector ideas that show up in PCA, optimization, and attention.</p>
                    <div class="vector-grid">
                        <article class="vector-card">
                            <span class="path-step">1</span>
                            <h4>Projections & orthogonality</h4>
                            <canvas class="card-canvas vector-card-canvas" id="vectorProjectionCanvas" data-vector-card="projection" width="240" height="130" aria-hidden="true"></canvas>
                            <ul>
                                <li>Projection onto \(u\): \( \mathrm{proj}_u(x) = \frac{x \cdot u}{u \cdot u} u \).</li>
                                <li>Orthogonal vectors give clean coordinate systems (PCA/SVD).</li>
                            </ul>
                        </article>
                        <article class="vector-card">
                            <span class="path-step">2</span>
                            <h4>Norms & normalization</h4>
                            <canvas class="card-canvas vector-card-canvas" id="vectorNormCanvas" data-vector-card="norm" width="240" height="130" aria-hidden="true"></canvas>
                            <ul>
                                <li>Length: \( \lVert x \rVert_2 = \sqrt{\sum_i x_i^2} \).</li>
                                <li>Normalize to compare directions independent of scale.</li>
                            </ul>
                        </article>
                        <article class="vector-card">
                            <span class="path-step">3</span>
                            <h4>Subspaces, basis, rank</h4>
                            <canvas class="card-canvas vector-card-canvas" id="vectorSubspaceCanvas" data-vector-card="subspace" width="240" height="130" aria-hidden="true"></canvas>
                            <ul>
                                <li>Span is the set of all linear combinations of vectors.</li>
                                <li>Rank is the dimension of that span (effective dimensionality).</li>
                            </ul>
                        </article>
                        <article class="vector-card">
                            <span class="path-step">4</span>
                            <h4>Gradients, Jacobians, Hessians</h4>
                            <canvas class="card-canvas vector-card-canvas" id="vectorGradientCanvas" data-vector-card="gradient" width="240" height="130" aria-hidden="true"></canvas>
                            <ul>
                                <li>\(\nabla_x L\) is the gradient of a scalar loss with respect to a vector.</li>
                                <li>Jacobian \(J\) stacks partials: \(J_{ij} = \partial f_i / \partial x_j\).</li>
                                <li>If \(f: \mathbb{R}^n \to \mathbb{R}^m\), then \(J\) is \(m \times n\) and \(f(x+\Delta x) \approx f(x) + J\Delta x\).</li>
                                <li>Hessian \(H = \nabla^2 L\) captures curvature; eigenvalues reveal minima vs saddles.</li>
                                <li>Second-order step: \(\Delta x = -H^{-1} \nabla L\) (Newton-style).</li>
                            </ul>
                        </article>
                        <article class="vector-card">
                            <span class="path-step">5</span>
                            <h4>Vector statistics</h4>
                            <canvas class="card-canvas vector-card-canvas" id="vectorStatsCanvas" data-vector-card="stats" width="240" height="130" aria-hidden="true"></canvas>
                            <ul>
                                <li>Mean vector and covariance describe feature distributions.</li>
                                <li>Centering and whitening stabilize training and PCA.</li>
                            </ul>
                        </article>
                        <article class="vector-card">
                            <span class="path-step">6</span>
                            <h4>Regularization geometry</h4>
                            <canvas class="card-canvas vector-card-canvas" id="vectorRegularizationCanvas" data-vector-card="regularization" width="240" height="130" aria-hidden="true"></canvas>
                            <ul>
                                <li>L2 prefers small norms; L1 encourages sparsity.</li>
                                <li>Constraint shapes explain why L1 yields zeros.</li>
                            </ul>
                        </article>
                        <article class="vector-card">
                            <span class="path-step">7</span>
                            <h4>Attention via dot products</h4>
                            <canvas class="card-canvas vector-card-canvas" id="vectorAttentionCanvas" data-vector-card="attention" width="240" height="130" aria-hidden="true"></canvas>
                            <ul>
                                <li>Similarity scores become weights after softmax.</li>
                                <li>Output is a weighted sum of value vectors.</li>
                            </ul>
                        </article>
                    </div>
                </div>
            </div>
        </section>

        <!-- Matrices Section -->
        <section id="matrices" class="example-section">
            <h2>Matrices: transforms, determinants, inverses</h2>
            <p class="section-intro">Matrices reshape space. Determinants measure area scaling, inverses undo transforms, and eigenvectors reveal stable directions.</p>
            <div class="matrix-mode-switcher" role="group" aria-label="Matrix depth mode">
                <button class="toggle-btn is-active" type="button" data-matrix-mode="basic">Basic playground</button>
                <button class="toggle-btn" type="button" data-matrix-mode="deep">Deep dive</button>
            </div>
            <div class="matrix-mode-panel is-active" data-matrix-mode="basic">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Matrix playground</h3>
                        <p>Focus on the three core moves: add, multiply, and reshape space with scaling + shear.</p>
                        <ul class="concept-bullets">
                            <li>Addition mixes layers in the same shape.</li>
                            <li>Multiplication blends rows and columns.</li>
                            <li>Scaling stretches; shear slants the grid.</li>
                        </ul>
                        <div class="math-formula" id="matrixOperationFormula">\[
                        C = AB
                        \]</div>
                        <p id="matrixOperationNote">Multiplication mixes rows and columns to transform vectors.</p>
                    </div>
                    <div class="visualization">
                        <canvas id="matrixCanvas" width="420" height="320"></canvas>
                        <div class="controls matrix-controls">
                            <div class="toggle-group" role="group" aria-label="Matrix basics">
                                <button class="toggle-btn is-active" type="button" data-matrix-op="add">Addition</button>
                                <button class="toggle-btn" type="button" data-matrix-op="multiply">Multiplication</button>
                                <button class="toggle-btn" type="button" data-matrix-op="scale">Scaling</button>
                                <button class="toggle-btn" type="button" data-matrix-op="shear">Shear</button>
                            </div>
                            <div class="matrix-transform-controls" id="matrixTransformControls" hidden>
                                <div class="slider-group" data-matrix-control="scale" hidden>
                                    <span class="slider-title">Scaling factors</span>
                                    <label>sx <span id="matrixScaleXVal">1.50</span></label>
                                    <input type="range" id="matrixScaleX" min="0.3" max="2.5" step="0.05" value="1.5">
                                    <label>sy <span id="matrixScaleYVal">0.70</span></label>
                                    <input type="range" id="matrixScaleY" min="0.3" max="2.5" step="0.05" value="0.7">
                                </div>
                                <div class="slider-group" data-matrix-control="shear" hidden>
                                    <span class="slider-title">Shear amount</span>
                                    <label>k (x-shear) <span id="matrixShearVal">0.80</span></label>
                                    <input type="range" id="matrixShear" min="-1.2" max="1.2" step="0.05" value="0.8">
                                </div>
                            </div>
                            <p class="helper-text" id="matrixTransformHint" hidden>Drag the sliders to stretch or slant the grid.</p>
                            <button type="button" id="matrixAnimateButton" onclick="animateMatrixBasicOperation()">Animate</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="matrix-mode-panel" data-matrix-mode="deep">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Matrix deep dive: advanced operators</h3>
                        <p>Explore determinants, inverses, identity, and eigenvectors with detailed formulas.</p>
                        <div class="math-formula" id="matrixDeepFormula">\[
                        \det(A) = ad - bc
                        \]</div>
                        <p id="matrixDeepNote">Determinant is the area scale factor; sign indicates a flip.</p>
                        <ul class="concept-bullets">
                            <li>Small determinants signal near-singular matrices.</li>
                            <li>Precision matrices reweight directions in space.</li>
                            <li>Eigenvectors preserve direction under \(A\).</li>
                        </ul>
                        <div class="mini-mission">Mini mission: spot the operation that flips the grid.</div>
                    </div>
                    <div class="visualization">
                        <canvas id="matrixDeepCanvas" width="420" height="320"></canvas>
                        <div class="controls matrix-controls">
                            <div class="toggle-group" role="group" aria-label="Matrix deep dive">
                                <button class="toggle-btn is-active" type="button" data-matrix-deep-op="determinant">Determinant</button>
                                <button class="toggle-btn" type="button" data-matrix-deep-op="inverse">Inverse</button>
                                <button class="toggle-btn" type="button" data-matrix-deep-op="covariance">Covariance + Precision</button>
                                <button class="toggle-btn" type="button" data-matrix-deep-op="identity">Identity</button>
                                <button class="toggle-btn" type="button" data-matrix-deep-op="onehot">One-hot</button>
                                <button class="toggle-btn" type="button" data-matrix-deep-op="eigen">Eigen</button>
                            </div>
                            <button type="button" id="matrixDeepAnimateButton" onclick="animateMatrixDeepOperation()">Animate</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Probability Section -->
        <section id="probability" class="example-section">
            <h2>Probability: uncertainty and confidence</h2>
            <p class="section-intro">Go from events to distributions, and see how probabilities become confidence bars.</p>
            <div class="probability-mode-switcher" role="group" aria-label="Probability depth mode">
                <button class="toggle-btn is-active" type="button" data-probability-depth="basic">Basic playground</button>
                <button class="toggle-btn" type="button" data-probability-depth="deep">Deep dive</button>
            </div>
            <div class="probability-mode-panel is-active" data-probability-depth="basic">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Events, distributions, Bayes</h3>
                        <ul class="concept-bullets">
                            <li>Probabilities sum to 1 across a full set of outcomes.</li>
                            <li>Conditional probability updates beliefs with new evidence.</li>
                            <li>Expectations summarize the average outcome.</li>
                        </ul>
                        <div class="math-formula">
                            \[
                            P(A \mid B) = \frac{P(B \mid A)P(A)}{P(B)}
                            \]
                            \[
                            \mathbb{E}[X] = \sum_x x \, P(X=x)
                            \]
                        </div>
                        <div class="toggle-group probability-controls" role="group" aria-label="Probability mode">
                            <button class="toggle-btn is-active" type="button" data-probability-mode="bernoulli">Bernoulli</button>
                            <button class="toggle-btn" type="button" data-probability-mode="categorical">Categorical</button>
                            <button class="toggle-btn" type="button" data-probability-mode="binomial">Binomial</button>
                            <button class="toggle-btn" type="button" data-probability-mode="normal">Normal</button>
                            <button class="toggle-btn" type="button" data-probability-mode="bayes">Bayes update</button>
                        </div>
                        <p class="example-note" id="probabilityNote"></p>
                    </div>
                    <div class="visualization">
                        <canvas id="probabilityCanvas" width="420" height="320"></canvas>
                        <p class="figure-note">Graph. Bars show probability mass per outcome; the curve shows probability density; Bayes view compares prior, likelihood, and posterior.</p>
                    </div>
                </div>
            </div>
            <div class="probability-mode-panel" data-probability-depth="deep">
                <div class="content-grid probability-review-grid">
                    <div class="explanation">
                        <h3>Probability review: events &amp; notation</h3>
                        <ul class="concept-bullets">
                            <li>\(P(A)\) is between 0 and 1.</li>
                            <li>Sample space \(S\) contains all outcomes; \(P(S)=1\).</li>
                            <li>Complement: \(P(\overline{A}) = 1 - P(A)\).</li>
                            <li>Union: \(P(A \cup B)\), Intersection: \(P(A \cap B)\).</li>
                            <li>Conditional: \(P(A \mid B) = \frac{P(A \cap B)}{P(B)}\).</li>
                            <li>Random variable \(X\) maps outcomes to numbers, with \(P(X=x)\).</li>
                        </ul>
                        <div class="math-formula">
                            \[
                            P(A \cup B) = P(A) + P(B) - P(A \cap B)
                            \]
                            \[
                            P(A \mid B) = \frac{P(B \mid A)P(A)}{P(B)}
                            \]
                        </div>
                        <div class="toggle-group probability-venn-controls" role="group" aria-label="Probability visual mode">
                            <button class="toggle-btn is-active" type="button" data-venn-mode="event">Event A</button>
                            <button class="toggle-btn" type="button" data-venn-mode="complement">Complement</button>
                            <button class="toggle-btn" type="button" data-venn-mode="union">Union</button>
                            <button class="toggle-btn" type="button" data-venn-mode="intersection">Intersection</button>
                            <button class="toggle-btn" type="button" data-venn-mode="conditional">Conditional</button>
                            <button class="toggle-btn" type="button" data-venn-mode="bayes">Bayes</button>
                        </div>
                        <p class="example-note" id="probabilityVennNote"></p>
                    </div>
                    <div class="visualization">
                        <canvas id="probabilityVennCanvas" width="420" height="320"></canvas>
                        <p class="helper-text">Venn diagram highlights the region tied to the formula.</p>
                    </div>
                </div>
                <div class="content-grid probability-spam-grid">
                    <div class="explanation">
                        <h3>Bayesian spam filter intuition</h3>
                        <p>Estimate the prior \(P(\text{spam})\) from training data, then combine it with word likelihoods.</p>
                        <div class="math-formula">
                            \[
                            P(\text{spam} \mid \text{message}) \propto P(\text{spam}) \prod_i P(\text{word}_i \mid \text{spam})
                            \]
                        </div>
                        <p class="example-note">Bag-of-words treats each word independently, so likelihoods multiply.</p>
                        <div class="math-formula math-mini">
                            \[
                            P(\text{message}) = P(\text{message} \mid \text{spam})P(\text{spam}) + P(\text{message} \mid \text{ham})P(\text{ham})
                            \]
                        </div>
                        <div class="spam-controls">
                            <div class="slider-group">
                                <span class="slider-title">Prior</span>
                                <label>\(P(\text{spam})\) <span id="spamPriorVal">0.30</span></label>
                                <input type="range" id="spamPrior" min="0.05" max="0.9" step="0.01" value="0.3">
                            </div>
                            <div class="word-chip-group" role="group" aria-label="Message words">
                                <button class="toggle-btn is-active" type="button" data-spam-word="free">free</button>
                                <button class="toggle-btn is-active" type="button" data-spam-word="win">win</button>
                                <button class="toggle-btn" type="button" data-spam-word="meeting">meeting</button>
                                <button class="toggle-btn" type="button" data-spam-word="project">project</button>
                                <button class="toggle-btn" type="button" data-spam-word="offer">offer</button>
                            </div>
                        </div>
                        <div class="neural-readout probability-readout">
                            <div class="readout-card">
                                <span class="readout-label">P(words|spam)</span>
                                <span class="readout-value" id="spamLikelihood">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">P(words|ham)</span>
                                <span class="readout-value" id="hamLikelihood">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Posterior spam</span>
                                <span class="readout-value" id="spamPosterior">-</span>
                            </div>
                        </div>
                        <p class="example-note" id="spamFilterNote"></p>
                    </div>
                    <div class="visualization">
                        <canvas id="spamFilterCanvas" width="420" height="320"></canvas>
                        <p class="helper-text">Prior √ó likelihoods ‚Üí posterior.</p>
                    </div>
                </div>
                <div class="content-grid probability-sample-grid">
                    <div class="explanation">
                        <h3>Sample space simulator</h3>
                        <p>Uniform dots are outcomes. A is the left slice, B is the top slice, and the overlap shows \(A \cap B\).</p>
                        <div class="math-formula">
                            \[
                            P(A)=\frac{|A|}{|S|},\quad P(A \mid B)=\frac{P(A \cap B)}{P(B)}
                            \]
                        </div>
                        <div class="sample-controls">
                            <div class="slider-group">
                                <span class="slider-title">Event A width</span>
                                <label>\(P(A)\) <span id="sampleAVal">0.60</span></label>
                                <input type="range" id="sampleA" min="0.1" max="0.9" step="0.01" value="0.6">
                            </div>
                            <div class="slider-group">
                                <span class="slider-title">Event B height</span>
                                <label>\(P(B)\) <span id="sampleBVal">0.50</span></label>
                                <input type="range" id="sampleB" min="0.1" max="0.9" step="0.01" value="0.5">
                            </div>
                            <button class="toggle-btn" type="button" id="sampleReseed">Resample points</button>
                        </div>
                        <div class="neural-readout probability-readout">
                            <div class="readout-card">
                                <span class="readout-label">P(A)</span>
                                <span class="readout-value" id="samplePA">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">P(B)</span>
                                <span class="readout-value" id="samplePB">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">P(A &cap; B)</span>
                                <span class="readout-value" id="samplePAB">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">P(A|B)</span>
                                <span class="readout-value" id="samplePAgivenB">-</span>
                            </div>
                        </div>
                        <p class="example-note" id="sampleSpaceNote"></p>
                    </div>
                    <div class="visualization">
                        <canvas id="sampleSpaceCanvas" width="420" height="320"></canvas>
                        <p class="helper-text">Counts update from simulated dots.</p>
                    </div>
                </div>
                <div class="content-grid probability-filter-grid">
                    <div class="explanation">
                        <h3>Hidden Markov Models &amp; filters</h3>
                        <h4>What is a Hidden Markov Model?</h4>
                        <p>A Hidden Markov Model (HMM) describes a system with hidden states that evolve over time and generate observable data.</p>
                        <ul class="concept-bullets">
                            <li>Hidden states transition via a Markov process.</li>
                            <li>Observations are emitted based on the current hidden state.</li>
                            <li>The task is to infer hidden states from observations.</li>
                        </ul>
                        <div class="math-formula">
                            \[
                            P(X_t \mid X_{t-1}) \quad \text{and} \quad P(E_t \mid X_t)
                            \]
                        </div>
                        <p class="example-note">Common uses: speech recognition, NLP, bioinformatics, and time-series analysis.</p>
                        <h4>What filters do</h4>
                        <p>Filters estimate hidden state as new, noisy observations arrive, updating beliefs step by step.</p>
                        <ul class="concept-bullets">
                            <li>Continuous states and observations.</li>
                            <li>Linear dynamics and observation models.</li>
                            <li>Gaussian noise assumptions.</li>
                        </ul>
                        <p>The Kalman filter provides an optimal recursive estimate under those conditions.</p>
                        <p class="example-note">Used in radar tracking, navigation, and robotics for position/velocity estimates.</p>
                    </div>
                    <div class="visualization card-column probability-filter-visuals">
                        <div class="guide-card">
                            <h4>Hidden Markov Model</h4>
                            <canvas id="probabilityHmmCanvas" width="420" height="220"></canvas>
                            <p class="helper-text">Hidden states (circles) emit observations (squares) over time.</p>
                        </div>
                        <div class="guide-card">
                            <h4>Kalman filter</h4>
                            <canvas id="probabilityKalmanCanvas" width="420" height="220"></canvas>
                            <p class="helper-text">Prediction (line) is corrected toward noisy measurements (dots).</p>
                        </div>
                    </div>
                </div>
                <div class="probability-grid">
                    <article class="probability-card">
                        <h4>Bernoulli</h4>
                        <canvas class="card-canvas probability-card-canvas" id="probabilityBernoulliCanvas" data-probability-card="bernoulli" width="220" height="120" aria-hidden="true"></canvas>
                        <p>Binary outcomes with parameter \(p\).</p>
                        <p class="example-note">Use for clicks, coins, yes/no labels.</p>
                        <div class="math-formula math-mini">
                            \[
                            P(X=1)=p,\quad P(X=0)=1-p
                            \]
                        </div>
                    </article>
                    <article class="probability-card">
                        <h4>Binomial</h4>
                        <canvas class="card-canvas probability-card-canvas" id="probabilityBinomialCanvas" data-probability-card="binomial" width="220" height="120" aria-hidden="true"></canvas>
                        <p>Counts successes in \(n\) trials.</p>
                        <p class="example-note">Use for pass/fail counts in batches.</p>
                        <div class="math-formula math-mini">
                            \[
                            P(X=k)=\binom{n}{k}p^k(1-p)^{n-k}
                            \]
                        </div>
                    </article>
                    <article class="probability-card">
                        <h4>Categorical</h4>
                        <canvas class="card-canvas probability-card-canvas" id="probabilityCategoricalCanvas" data-probability-card="categorical" width="220" height="120" aria-hidden="true"></canvas>
                        <p>Multiple discrete outcomes with probabilities.</p>
                        <p class="example-note">Use for class labels or choices.</p>
                        <div class="math-formula math-mini">
                            \[
                            P(X=i)=p_i,\quad \sum_i p_i = 1
                            \]
                        </div>
                    </article>
                    <article class="probability-card">
                        <h4>Normal</h4>
                        <canvas class="card-canvas probability-card-canvas" id="probabilityNormalCanvas" data-probability-card="normal" width="220" height="120" aria-hidden="true"></canvas>
                        <p>Continuous bell curve with \(\mu\) and \(\sigma\).</p>
                        <p class="example-note">Use for noise, heights, residuals.</p>
                        <div class="math-formula math-mini">
                            \[
                            X \sim \mathcal{N}(\mu,\sigma^2)
                            \]
                            \[
                            f(x)=\frac{1}{\sqrt{2\pi\sigma^2}}e^{-(x-\mu)^2/(2\sigma^2)}
                            \]
                        </div>
                    </article>
                </div>
            </div>
        </section>

        <!-- Gradient Descent Section -->
        <section id="gradient-descent" class="example-section">
            <h2>Gradient Descent</h2>
            <div class="content-grid">
                <div class="explanation">
                    <h3>Finding the Minimum</h3>
                    <p>Gradient descent is how neural networks learn. It's like walking downhill to find the lowest point:</p>
                    <div class="math-formula">
                        \[
                        \theta_{\text{new}} = \theta_{\text{old}} - \alpha \nabla J(\theta)
                        \]
                    </div>
                    <ul>
                        <li><strong>\(\theta\)</strong>: Parameter being optimized</li>
                        <li><strong>\(\alpha\)</strong>: Learning rate (step size)</li>
                        <li><strong>\(\nabla J(\theta)\)</strong>: Gradient (direction of steepest increase)</li>
                    </ul>
                </div>
                <div class="visualization">
                    <canvas id="gradientCanvas" width="400" height="400"></canvas>
                    <div class="controls">
                        <label>Learning Rate: <input type="range" id="learningRate" min="0.01" max="0.5" step="0.01" value="0.1"></label>
                        <button onclick="runGradientDescent()">Run Gradient Descent</button>
                        <button onclick="resetGradientDescent()">Reset</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Activation Functions Section -->
        <section id="activations" class="example-section">
            <h2>Activation Functions</h2>
            <div class="content-grid">
                <div class="explanation">
                    <h3>Non-Linear Transformations</h3>
                    <p>Activation functions add non-linearity to neural networks, enabling them to learn complex patterns:</p>
                    
                    <h4>Sigmoid: \( \sigma(x) = \frac{1}{1+e^{-x}} \)</h4>
                    <p>Squashes values to (0, 1). Used for binary classification.</p>
                    
                    <h4>ReLU: \( f(x) = \max(0, x) \)</h4>
                    <p>Most popular! Simple and effective. Returns x if positive, 0 otherwise.</p>
                    
                    <h4>Tanh: \( \tanh(x) = \frac{e^x - e^{-x}}{e^x + e^{-x}} \)</h4>
                    <p>Squashes values to (-1, 1). Zero-centered version of sigmoid.</p>
                </div>
                <div class="visualization">
                    <canvas id="activationCanvas" width="400" height="400"></canvas>
                    <div class="controls">
                        <label>
                            <input type="checkbox" id="showSigmoid" checked> Sigmoid
                        </label>
                        <label>
                            <input type="checkbox" id="showReLU" checked> ReLU
                        </label>
                        <label>
                            <input type="checkbox" id="showTanh" checked> Tanh
                        </label>
                    </div>
                </div>
            </div>
        </section>

        </section>

        <section class="chapter" data-chapter="ml">
            <nav class="chapter-nav" aria-label="Machine learning sections">
                <a href="#ml-intro">Definition</a>
                <a href="#ml-algorithms">Algorithms</a>
                <a href="#ml-walkthroughs">Algorithm Walkthroughs</a>
                <a href="#ml-lifecycle">Training &amp; Inference</a>
            </nav>

            <section id="ml-intro" class="example-section">
                <h2>What is Machine Learning?</h2>
                <p class="section-intro">Machine learning is the study of systems that learn patterns from data to make predictions or decisions without being explicitly programmed for each case.</p>
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Definition</h3>
                        <p>Given data \(x\) and outcomes \(y\), machine learning finds a function \(f_\theta\) that maps inputs to outputs by optimizing parameters \(\theta\) to reduce error.</p>
                        <div class="math-formula">
                            \[
                            \theta^* = \arg\min_\theta \frac{1}{n} \sum_{i=1}^{n} \mathcal{L}(f_\theta(x_i), y_i)
                            \]
                        </div>
                        <h3>How it works (intuitive)</h3>
                        <ul class="concept-bullets">
                            <li><strong>Observe</strong>: collect examples and features.</li>
                            <li><strong>Learn</strong>: fit a model that captures patterns.</li>
                            <li><strong>Evaluate</strong>: test on new data to check generalization.</li>
                            <li><strong>Use</strong>: deploy the model to make predictions.</li>
                        </ul>
                    </div>
                    <div class="visualization">
                        <div class="guide-stack">
                            <article class="guide-card">
                                <h4>Supervised learning</h4>
                                <p>Learn from labeled examples to predict targets or classes.</p>
                            </article>
                            <article class="guide-card">
                                <h4>Unsupervised learning</h4>
                                <p>Discover structure or clusters without labels.</p>
                            </article>
                            <article class="guide-card">
                                <h4>Self-supervised learning</h4>
                                <p>Generate labels from data itself to learn useful representations.</p>
                            </article>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Machine Learning Algorithms Section -->
            <section id="ml-algorithms" class="example-section">
                <h2>Machine Learning Algorithms</h2>
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Common algorithm families</h3>
                        <ul class="concept-bullets">
                            <li><strong>Supervised</strong>: learn from labeled examples to predict or classify.</li>
                            <li><strong>Unsupervised</strong>: discover structure without labels.</li>
                            <li><strong>Probabilistic</strong>: express uncertainty with likelihoods and priors.</li>
                            <li><strong>Ensembles</strong>: combine many models to reduce error.</li>
                        </ul>
                        <div class="math-formula">
                            \[
                            \theta^* = \arg\min_\theta \frac{1}{n} \sum_{i=1}^n \mathcal{L}(f_\theta(x_i), y_i) + \lambda \lVert \theta \rVert^2
                            \]
                        </div>
                        <p class="example-note">Use the cards as a quick baseline picker before tuning deeper models.</p>
                    </div>
                    <div class="visualization">
                        <div class="ml-grid">
                            <article class="ml-card">
                                <h4>Linear Regression</h4>
                                <p>Predict continuous targets with a weighted sum.</p>
                                <div class="ml-mini-vis" data-ml-toggle="true" data-ml-caption="Best-fit line follows the trend." data-ml-caption-alt="Line pivots when data shifts." data-ml-caption-hover="Hover to trace the fit, click to swap data." role="button" tabindex="0" aria-pressed="false">
                                    <svg class="ml-svg" viewBox="0 0 120 80" role="img" aria-label="Scatter with best-fit line">
                                        <g class="ml-state ml-state--a">
                                            <line class="ml-line" x1="10" y1="65" x2="110" y2="15" stroke="var(--accent-1)" stroke-width="3" />
                                            <circle class="ml-point" cx="18" cy="60" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="32" cy="55" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="50" cy="45" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="65" cy="38" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="82" cy="28" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="98" cy="20" r="3" fill="var(--accent-2)" />
                                        </g>
                                        <g class="ml-state ml-state--b">
                                            <line class="ml-line" x1="10" y1="70" x2="110" y2="30" stroke="var(--accent-1)" stroke-width="3" />
                                            <circle class="ml-point" cx="16" cy="66" r="3" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="30" cy="62" r="3" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="48" cy="54" r="3" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="64" cy="48" r="3" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="82" cy="40" r="3" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="98" cy="34" r="3" fill="var(--accent-3)" />
                                        </g>
                                    </svg>
                                </div>
                                <p class="ml-caption">Best-fit line follows the trend.</p>
                                <div class="math-formula math-mini">
                                    \[
                                    \hat{y} = \mathbf{w}^\top \mathbf{x} + b
                                    \]
                                </div>
                            </article>
                            <article class="ml-card">
                                <h4>Logistic Regression</h4>
                                <p>Binary classification with a sigmoid link.</p>
                                <div class="ml-mini-vis" data-ml-toggle="true" data-ml-caption="Sigmoid separates two classes." data-ml-caption-alt="Boundary shifts with new evidence." data-ml-caption-hover="Hover to draw the curve, click to shift it." role="button" tabindex="0" aria-pressed="false">
                                    <svg class="ml-svg" viewBox="0 0 120 80" role="img" aria-label="Sigmoid curve with two classes">
                                        <g class="ml-state ml-state--a">
                                            <path class="ml-line" d="M12 62 C30 62, 40 60, 50 48 C60 35, 70 20, 108 18" fill="none" stroke="var(--accent-1)" stroke-width="3" />
                                            <circle class="ml-point" cx="24" cy="62" r="3" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="38" cy="58" r="3" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="78" cy="26" r="3" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="92" cy="22" r="3" fill="var(--accent-3)" />
                                        </g>
                                        <g class="ml-state ml-state--b">
                                            <path class="ml-line" d="M12 68 C28 66, 36 60, 46 50 C60 34, 74 18, 108 14" fill="none" stroke="var(--accent-1)" stroke-width="3" />
                                            <circle class="ml-point" cx="20" cy="66" r="3" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="34" cy="62" r="3" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="70" cy="24" r="3" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="90" cy="18" r="3" fill="var(--accent-3)" />
                                        </g>
                                    </svg>
                                </div>
                                <p class="ml-caption">Sigmoid separates two classes.</p>
                                <div class="math-formula math-mini">
                                    \[
                                    P(y=1 \mid x) = \sigma(\mathbf{w}^\top \mathbf{x} + b)
                                    \]
                                </div>
                            </article>
                            <article class="ml-card">
                                <h4>k-NN</h4>
                                <p>Predict by voting among nearest neighbors.</p>
                                <div class="ml-mini-vis" data-ml-toggle="true" data-ml-caption="Nearest neighbors vote on the label." data-ml-caption-alt="Move the query, neighbors change." data-ml-caption-hover="Hover to pulse neighbors, click to move the query." role="button" tabindex="0" aria-pressed="false">
                                    <svg class="ml-svg" viewBox="0 0 120 80" role="img" aria-label="Neighbor points around a query">
                                        <g class="ml-state ml-state--a">
                                            <circle class="ml-point" cx="35" cy="25" r="4" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="50" cy="35" r="4" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="32" cy="48" r="4" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="75" cy="20" r="4" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="85" cy="34" r="4" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="72" cy="52" r="4" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="58" cy="45" r="5" fill="var(--accent-1)" />
                                            <circle class="ml-line" cx="58" cy="45" r="18" fill="none" stroke="var(--accent-1)" stroke-width="2" stroke-dasharray="4 4" />
                                        </g>
                                        <g class="ml-state ml-state--b">
                                            <circle class="ml-point" cx="30" cy="20" r="4" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="46" cy="28" r="4" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="38" cy="42" r="4" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="72" cy="28" r="4" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="84" cy="44" r="4" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="92" cy="30" r="4" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="78" cy="38" r="5" fill="var(--accent-1)" />
                                            <circle class="ml-line" cx="78" cy="38" r="18" fill="none" stroke="var(--accent-1)" stroke-width="2" stroke-dasharray="4 4" />
                                        </g>
                                    </svg>
                                </div>
                                <p class="ml-caption">Nearest neighbors vote on the label.</p>
                                <p class="example-note">Strong baseline for small data.</p>
                            </article>
                            <article class="ml-card">
                                <h4>Decision Trees</h4>
                                <p>Recursive if-then splits on features.</p>
                                <div class="ml-mini-vis" data-ml-toggle="true" data-ml-caption="Splits carve the data space." data-ml-caption-alt="Tree grows a different branch." data-ml-caption-hover="Hover to light the splits, click to grow another tree." role="button" tabindex="0" aria-pressed="false">
                                    <svg class="ml-svg" viewBox="0 0 120 80" role="img" aria-label="Decision tree split">
                                        <g class="ml-state ml-state--a">
                                            <circle class="ml-point" cx="60" cy="16" r="6" fill="var(--accent-1)" />
                                            <line class="ml-line" x1="60" y1="22" x2="35" y2="40" stroke="var(--ink-soft)" stroke-width="2" />
                                            <line class="ml-line" x1="60" y1="22" x2="85" y2="40" stroke="var(--ink-soft)" stroke-width="2" />
                                            <circle class="ml-point" cx="35" cy="44" r="5" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="85" cy="44" r="5" fill="var(--accent-3)" />
                                            <line class="ml-line" x1="35" y1="50" x2="25" y2="66" stroke="var(--ink-soft)" stroke-width="2" />
                                            <line class="ml-line" x1="35" y1="50" x2="45" y2="66" stroke="var(--ink-soft)" stroke-width="2" />
                                            <circle class="ml-point" cx="25" cy="70" r="4" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="45" cy="70" r="4" fill="var(--accent-4)" />
                                        </g>
                                        <g class="ml-state ml-state--b">
                                            <circle class="ml-point" cx="60" cy="14" r="6" fill="var(--accent-1)" />
                                            <line class="ml-line" x1="60" y1="20" x2="45" y2="38" stroke="var(--ink-soft)" stroke-width="2" />
                                            <line class="ml-line" x1="60" y1="20" x2="75" y2="38" stroke="var(--ink-soft)" stroke-width="2" />
                                            <circle class="ml-point" cx="45" cy="42" r="5" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="75" cy="42" r="5" fill="var(--accent-3)" />
                                            <line class="ml-line" x1="75" y1="48" x2="68" y2="66" stroke="var(--ink-soft)" stroke-width="2" />
                                            <line class="ml-line" x1="75" y1="48" x2="82" y2="66" stroke="var(--ink-soft)" stroke-width="2" />
                                            <circle class="ml-point" cx="68" cy="70" r="4" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="82" cy="70" r="4" fill="var(--accent-4)" />
                                        </g>
                                    </svg>
                                </div>
                                <p class="ml-caption">Splits carve the data space.</p>
                                <p class="example-note">Interpretable and fast.</p>
                            </article>
                            <article class="ml-card">
                                <h4>Random Forest</h4>
                                <p>Bagged trees reduce variance.</p>
                                <div class="ml-mini-vis" data-ml-toggle="true" data-ml-caption="Many trees vote together." data-ml-caption-alt="Different tree mix, same ensemble." data-ml-caption-hover="Hover to sketch the forest, click to reshuffle trees." role="button" tabindex="0" aria-pressed="false">
                                    <svg class="ml-svg" viewBox="0 0 120 80" role="img" aria-label="Multiple small trees">
                                        <g class="ml-state ml-state--a">
                                            <g stroke="var(--ink-soft)" stroke-width="1.6" fill="none">
                                                <line class="ml-line" x1="20" y1="20" x2="12" y2="40" />
                                                <line class="ml-line" x1="20" y1="20" x2="28" y2="40" />
                                                <line class="ml-line" x1="60" y1="20" x2="52" y2="40" />
                                                <line class="ml-line" x1="60" y1="20" x2="68" y2="40" />
                                                <line class="ml-line" x1="100" y1="20" x2="92" y2="40" />
                                                <line class="ml-line" x1="100" y1="20" x2="108" y2="40" />
                                            </g>
                                            <circle class="ml-point" cx="20" cy="16" r="4" fill="var(--accent-1)" />
                                            <circle class="ml-point" cx="60" cy="16" r="4" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="100" cy="16" r="4" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="12" cy="44" r="3.5" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="28" cy="44" r="3.5" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="52" cy="44" r="3.5" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="68" cy="44" r="3.5" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="92" cy="44" r="3.5" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="108" cy="44" r="3.5" fill="var(--accent-4)" />
                                        </g>
                                        <g class="ml-state ml-state--b">
                                            <g stroke="var(--ink-soft)" stroke-width="1.6" fill="none">
                                                <line class="ml-line" x1="28" y1="18" x2="18" y2="38" />
                                                <line class="ml-line" x1="28" y1="18" x2="38" y2="38" />
                                                <line class="ml-line" x1="70" y1="18" x2="62" y2="38" />
                                                <line class="ml-line" x1="70" y1="18" x2="78" y2="38" />
                                                <line class="ml-line" x1="100" y1="28" x2="92" y2="48" />
                                                <line class="ml-line" x1="100" y1="28" x2="108" y2="48" />
                                            </g>
                                            <circle class="ml-point" cx="28" cy="14" r="4" fill="var(--accent-1)" />
                                            <circle class="ml-point" cx="70" cy="14" r="4" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="100" cy="24" r="4" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="18" cy="42" r="3.5" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="38" cy="42" r="3.5" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="62" cy="42" r="3.5" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="78" cy="42" r="3.5" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="92" cy="52" r="3.5" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="108" cy="52" r="3.5" fill="var(--accent-4)" />
                                        </g>
                                    </svg>
                                </div>
                                <p class="ml-caption">Many trees vote together.</p>
                                <p class="example-note">Robust, less tuning.</p>
                            </article>
                            <article class="ml-card">
                                <h4>Support Vector Machine</h4>
                                <p>Max-margin boundary; kernels add nonlinearity.</p>
                                <div class="ml-mini-vis" data-ml-toggle="true" data-ml-caption="Max-margin boundary balances both classes." data-ml-caption-alt="Margin tilts when points move." data-ml-caption-hover="Hover to draw margins, click to tilt the boundary." role="button" tabindex="0" aria-pressed="false">
                                    <svg class="ml-svg" viewBox="0 0 120 80" role="img" aria-label="Margin with support vectors">
                                        <g class="ml-state ml-state--a">
                                            <line class="ml-line" x1="20" y1="65" x2="100" y2="15" stroke="var(--accent-1)" stroke-width="2.5" />
                                            <line class="ml-line" x1="30" y1="72" x2="110" y2="22" stroke="var(--accent-1)" stroke-width="1.5" stroke-dasharray="4 4" />
                                            <line class="ml-line" x1="10" y1="58" x2="90" y2="8" stroke="var(--accent-1)" stroke-width="1.5" stroke-dasharray="4 4" />
                                            <circle class="ml-point" cx="32" cy="60" r="4" fill="none" stroke="var(--accent-2)" stroke-width="2" />
                                            <circle class="ml-point" cx="52" cy="46" r="4" fill="none" stroke="var(--accent-2)" stroke-width="2" />
                                            <circle class="ml-point" cx="72" cy="32" r="4" fill="none" stroke="var(--accent-3)" stroke-width="2" />
                                            <circle class="ml-point" cx="90" cy="22" r="4" fill="none" stroke="var(--accent-3)" stroke-width="2" />
                                        </g>
                                        <g class="ml-state ml-state--b">
                                            <line class="ml-line" x1="18" y1="54" x2="108" y2="28" stroke="var(--accent-1)" stroke-width="2.5" />
                                            <line class="ml-line" x1="18" y1="66" x2="108" y2="40" stroke="var(--accent-1)" stroke-width="1.5" stroke-dasharray="4 4" />
                                            <line class="ml-line" x1="18" y1="42" x2="108" y2="16" stroke="var(--accent-1)" stroke-width="1.5" stroke-dasharray="4 4" />
                                            <circle class="ml-point" cx="28" cy="58" r="4" fill="none" stroke="var(--accent-2)" stroke-width="2" />
                                            <circle class="ml-point" cx="48" cy="50" r="4" fill="none" stroke="var(--accent-2)" stroke-width="2" />
                                            <circle class="ml-point" cx="78" cy="36" r="4" fill="none" stroke="var(--accent-3)" stroke-width="2" />
                                            <circle class="ml-point" cx="96" cy="30" r="4" fill="none" stroke="var(--accent-3)" stroke-width="2" />
                                        </g>
                                    </svg>
                                </div>
                                <p class="ml-caption">Max-margin boundary balances both classes.</p>
                                <p class="example-note">Great for medium-sized data.</p>
                            </article>
                            <article class="ml-card">
                                <h4>Naive Bayes</h4>
                                <p>Probabilistic classifier with conditional independence.</p>
                                <div class="ml-mini-vis" data-ml-toggle="true" data-ml-caption="Likelihoods overlap at the decision point." data-ml-caption-alt="Evidence shifts the overlap region." data-ml-caption-hover="Hover to emphasize overlap, click to shift it." role="button" tabindex="0" aria-pressed="false">
                                    <svg class="ml-svg" viewBox="0 0 120 80" role="img" aria-label="Overlapping class likelihoods">
                                        <g class="ml-state ml-state--a">
                                            <ellipse class="ml-point" cx="45" cy="40" rx="30" ry="18" fill="var(--accent-2)" opacity="0.35" />
                                            <ellipse class="ml-point" cx="75" cy="40" rx="30" ry="18" fill="var(--accent-3)" opacity="0.35" />
                                            <circle class="ml-point" cx="60" cy="40" r="4" fill="var(--accent-1)" />
                                        </g>
                                        <g class="ml-state ml-state--b">
                                            <ellipse class="ml-point" cx="40" cy="36" rx="28" ry="16" fill="var(--accent-2)" opacity="0.35" />
                                            <ellipse class="ml-point" cx="78" cy="44" rx="28" ry="16" fill="var(--accent-3)" opacity="0.35" />
                                            <circle class="ml-point" cx="58" cy="40" r="4" fill="var(--accent-1)" />
                                        </g>
                                    </svg>
                                </div>
                                <p class="ml-caption">Likelihoods overlap at the decision point.</p>
                                <p class="example-note">Fast for text and spam.</p>
                            </article>
                            <article class="ml-card">
                                <h4>k-Means</h4>
                                <p>Cluster points around K centroids.</p>
                                <div class="ml-mini-vis" data-ml-toggle="true" data-ml-caption="Centroids pull points into clusters." data-ml-caption-alt="Clusters drift to new centers." data-ml-caption-hover="Hover to pulse centroids, click to re-cluster." role="button" tabindex="0" aria-pressed="false">
                                    <svg class="ml-svg" viewBox="0 0 120 80" role="img" aria-label="Clustered points with centroids">
                                        <g class="ml-state ml-state--a">
                                            <circle class="ml-point" cx="28" cy="28" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="22" cy="38" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="35" cy="34" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="70" cy="26" r="3" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="80" cy="34" r="3" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="88" cy="26" r="3" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="64" cy="56" r="3" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="74" cy="60" r="3" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="84" cy="52" r="3" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="28" cy="32" r="5" fill="none" stroke="var(--accent-1)" stroke-width="2" />
                                            <circle class="ml-point" cx="80" cy="30" r="5" fill="none" stroke="var(--accent-1)" stroke-width="2" />
                                            <circle class="ml-point" cx="74" cy="56" r="5" fill="none" stroke="var(--accent-1)" stroke-width="2" />
                                        </g>
                                        <g class="ml-state ml-state--b">
                                            <circle class="ml-point" cx="24" cy="20" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="32" cy="30" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="40" cy="22" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="66" cy="34" r="3" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="78" cy="40" r="3" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="90" cy="34" r="3" fill="var(--accent-3)" />
                                            <circle class="ml-point" cx="52" cy="60" r="3" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="62" cy="64" r="3" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="70" cy="56" r="3" fill="var(--accent-4)" />
                                            <circle class="ml-point" cx="32" cy="24" r="5" fill="none" stroke="var(--accent-1)" stroke-width="2" />
                                            <circle class="ml-point" cx="78" cy="36" r="5" fill="none" stroke="var(--accent-1)" stroke-width="2" />
                                            <circle class="ml-point" cx="62" cy="60" r="5" fill="none" stroke="var(--accent-1)" stroke-width="2" />
                                        </g>
                                    </svg>
                                </div>
                                <p class="ml-caption">Centroids pull points into clusters.</p>
                                <p class="example-note">Simple unsupervised grouping.</p>
                            </article>
                            <article class="ml-card">
                                <h4>PCA</h4>
                                <p>Project data onto top-variance directions.</p>
                                <div class="ml-mini-vis" data-ml-toggle="true" data-ml-caption="Principal axis captures max variance." data-ml-caption-alt="Axis rotates with new variance." data-ml-caption-hover="Hover to trace the axis, click to rotate it." role="button" tabindex="0" aria-pressed="false">
                                    <svg class="ml-svg" viewBox="0 0 120 80" role="img" aria-label="Point cloud with principal axis">
                                        <g class="ml-state ml-state--a">
                                            <line class="ml-line" x1="20" y1="60" x2="100" y2="20" stroke="var(--accent-1)" stroke-width="3" />
                                            <line class="ml-line" x1="90" y1="18" x2="100" y2="20" stroke="var(--accent-1)" stroke-width="3" />
                                            <line class="ml-line" x1="100" y1="20" x2="96" y2="30" stroke="var(--accent-1)" stroke-width="3" />
                                            <circle class="ml-point" cx="30" cy="50" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="42" cy="44" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="55" cy="38" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="64" cy="32" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="72" cy="28" r="3" fill="var(--accent-2)" />
                                        </g>
                                        <g class="ml-state ml-state--b">
                                            <line class="ml-line" x1="18" y1="20" x2="98" y2="62" stroke="var(--accent-1)" stroke-width="3" />
                                            <line class="ml-line" x1="90" y1="60" x2="98" y2="62" stroke="var(--accent-1)" stroke-width="3" />
                                            <line class="ml-line" x1="98" y1="62" x2="94" y2="52" stroke="var(--accent-1)" stroke-width="3" />
                                            <circle class="ml-point" cx="28" cy="26" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="40" cy="32" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="54" cy="40" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="66" cy="48" r="3" fill="var(--accent-2)" />
                                            <circle class="ml-point" cx="78" cy="56" r="3" fill="var(--accent-2)" />
                                        </g>
                                    </svg>
                                </div>
                                <p class="ml-caption">Principal axis captures max variance.</p>
                                <p class="example-note">Dimensionality reduction.</p>
                            </article>
                        </div>
                    </div>
                </div>
                <div class="ml-derivations">
                    <h3>Formulas and derivations</h3>
                    <p class="section-intro">Short derivations that connect each algorithm to its core objective.</p>
                    <div class="ml-derivation-grid">
                        <article class="guide-card">
                            <h4>Linear Regression</h4>
                            <div class="math-formula math-mini">
                                \[
                                J(\mathbf{w}) = \frac{1}{n}\lVert X\mathbf{w} - \mathbf{y} \rVert^2
                                \]
                            </div>
                            <ol class="step-list">
                                <li>Take gradient: \( \nabla J = \frac{2}{n} X^T (X\mathbf{w} - \mathbf{y}) \).</li>
                                <li>Set to zero: \( X^T X \mathbf{w} = X^T \mathbf{y} \).</li>
                                <li>Solve for \( \mathbf{w} \) (normal equation) or use gradient descent.</li>
                            </ol>
                        </article>
                        <article class="guide-card">
                            <h4>Logistic Regression</h4>
                            <div class="math-formula math-mini">
                                \[
                                L = -\sum_i y_i \log \sigma(z_i) + (1-y_i)\log(1-\sigma(z_i))
                                \]
                            </div>
                            <ol class="step-list">
                                <li>Let \( z_i = \mathbf{w}^T \mathbf{x}_i + b \), \( p_i = \sigma(z_i) \).</li>
                                <li>Derivative: \( \partial L / \partial z_i = p_i - y_i \).</li>
                                <li>Gradient: \( \nabla_{\mathbf{w}} L = X^T(\mathbf{p} - \mathbf{y}) \).</li>
                            </ol>
                        </article>
                        <article class="guide-card">
                            <h4>k-NN</h4>
                            <div class="math-formula math-mini">
                                \[
                                \hat{y} = \text{mode}\{y_i : i \in \mathcal{N}_k(x)\}
                                \]
                            </div>
                            <ol class="step-list">
                                <li>No training objective; store all labeled points.</li>
                                <li>Compute distances \( d(x, x_i) \) to all points.</li>
                                <li>Pick the k closest neighbors and vote (or average for regression).</li>
                            </ol>
                        </article>
                        <article class="guide-card">
                            <h4>Decision Trees</h4>
                            <div class="math-formula math-mini">
                                \[
                                \text{Gain} = H(\text{parent}) - \sum_k p_k H(\text{child}_k)
                                \]
                            </div>
                            <ol class="step-list">
                                <li>Compute impurity (entropy or Gini) at the parent node.</li>
                                <li>Evaluate candidate splits and compute weighted child impurity.</li>
                                <li>Choose the split with the largest information gain.</li>
                            </ol>
                        </article>
                        <article class="guide-card">
                            <h4>Random Forest</h4>
                            <div class="math-formula math-mini">
                                \[
                                \hat{y} = \frac{1}{T} \sum_{t=1}^T h_t(x)
                                \]
                            </div>
                            <ol class="step-list">
                                <li>Train many trees on bootstrapped samples with random feature subsets.</li>
                                <li>Aggregate predictions by averaging or voting.</li>
                                <li>Averaging reduces variance when trees are diverse.</li>
                            </ol>
                        </article>
                        <article class="guide-card">
                            <h4>Support Vector Machine</h4>
                            <div class="math-formula math-mini">
                                \[
                                \min_{\mathbf{w}} \; \frac{1}{2}\lVert \mathbf{w} \rVert^2 + C \sum_i \max(0, 1 - y_i \mathbf{w}^T \mathbf{x}_i)
                                \]
                            </div>
                            <ol class="step-list">
                                <li>Maximize margin by minimizing \( \lVert \mathbf{w} \rVert^2 \).</li>
                                <li>Hinge loss penalizes points inside the margin or misclassified.</li>
                                <li>Only support vectors affect the optimal boundary.</li>
                            </ol>
                        </article>
                        <article class="guide-card">
                            <h4>Naive Bayes</h4>
                            <div class="math-formula math-mini">
                                \[
                                P(y \mid x) \propto P(y)\prod_i P(x_i \mid y)
                                \]
                            </div>
                            <ol class="step-list">
                                <li>Start from Bayes: \( P(y \mid x) = P(x \mid y)P(y)/P(x) \).</li>
                                <li>Assume conditional independence: \( P(x \mid y) = \prod_i P(x_i \mid y) \).</li>
                                <li>Choose the class with the largest posterior.</li>
                            </ol>
                        </article>
                        <article class="guide-card">
                            <h4>k-Means</h4>
                            <div class="math-formula math-mini">
                                \[
                                \min_{\{\mu_k\}} \sum_i \lVert x_i - \mu_{c_i} \rVert^2
                                \]
                            </div>
                            <ol class="step-list">
                                <li>Assign each point to the nearest centroid.</li>
                                <li>Update centroids by setting \( \partial J / \partial \mu_k = 0 \Rightarrow \mu_k = \text{mean} \).</li>
                                <li>Repeat until assignments stabilize.</li>
                            </ol>
                        </article>
                        <article class="guide-card">
                            <h4>PCA</h4>
                            <div class="math-formula math-mini">
                                \[
                                \max_{\lVert \mathbf{w} \rVert = 1} \mathbf{w}^T \Sigma \mathbf{w}
                                \]
                            </div>
                            <ol class="step-list">
                                <li>Use Lagrange multiplier: \( \Sigma \mathbf{w} = \lambda \mathbf{w} \).</li>
                                <li>The top eigenvector gives the max-variance direction.</li>
                                <li>Project data onto the leading eigenvectors.</li>
                            </ol>
                        </article>
                    </div>
                </div>
            </section>

            <section id="ml-walkthroughs" class="example-section">
                <h2>Algorithm Walkthroughs</h2>
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Step-by-step algorithm views</h3>
                        <p>Select an algorithm to see the key steps and a matching visualization.</p>
                        <div class="toggle-group ml-algo-toggle" role="group" aria-label="Machine learning algorithms">
                            <button class="toggle-btn is-active" type="button" data-ml-algo="linear">Linear Regression</button>
                            <button class="toggle-btn" type="button" data-ml-algo="logistic">Logistic Regression</button>
                            <button class="toggle-btn" type="button" data-ml-algo="knn">k-NN</button>
                            <button class="toggle-btn" type="button" data-ml-algo="tree">Decision Trees</button>
                            <button class="toggle-btn" type="button" data-ml-algo="forest">Random Forest</button>
                            <button class="toggle-btn" type="button" data-ml-algo="svm">SVM</button>
                            <button class="toggle-btn" type="button" data-ml-algo="bayes">Naive Bayes</button>
                            <button class="toggle-btn" type="button" data-ml-algo="kmeans">k-Means</button>
                            <button class="toggle-btn" type="button" data-ml-algo="pca">PCA</button>
                        </div>
                        <ol class="step-list ml-step-list" id="mlAlgoStepList"></ol>
                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="mlAlgoStepBadge">Step 1 of 3</span>
                                <h4 id="mlAlgoStepTitle">Load data</h4>
                            </div>
                            <p id="mlAlgoStepText"></p>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="mlAlgoCanvas" width="420" height="320"></canvas>
                        <div class="controls">
                            <button type="button" id="mlAlgoPrev">Previous step</button>
                            <button type="button" id="mlAlgoNext">Next step</button>
                            <button type="button" id="mlAlgoPlay">Play steps</button>
                            <button type="button" id="mlAlgoReset">Reset</button>
                        </div>
                    </div>
                </div>
            </section>

            <section id="ml-lifecycle" class="example-section">
                <h2>Training vs Inference</h2>
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Step-by-step ML lifecycle</h3>
                        <p>Training tunes the weights with data and gradients. Inference freezes the weights and just predicts.</p>
                        <div class="toggle-group ml-phase-toggle" role="group" aria-label="ML phase">
                            <button class="toggle-btn is-active" type="button" data-ml-phase="training">Training</button>
                            <button class="toggle-btn" type="button" data-ml-phase="inference">Inference</button>
                        </div>
                        <ol class="step-list ml-step-list" id="mlStepList"></ol>
                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="mlStepBadge">Step 1 of 5</span>
                                <h4 id="mlStepTitle">Load data batch</h4>
                            </div>
                            <p id="mlStepText"></p>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="mlLifecycleCanvas" width="420" height="320"></canvas>
                        <div class="controls">
                            <button type="button" id="mlPrevStep">Previous step</button>
                            <button type="button" id="mlNextStep">Next step</button>
                            <button type="button" id="mlPlaySteps">Play steps</button>
                            <button type="button" id="mlReset">Reset</button>
                        </div>
                    </div>
                </div>
            </section>
        </section>

        <section class="chapter" data-chapter="neural">
            <nav class="chapter-nav" aria-label="Neural network sections">
                <a href="#neural-network">Overview</a>
                <a href="#backprop">Backpropagation</a>
                <a href="#transformer-advanced">Transformer Deep Dive</a>
            </nav>

            <!-- Neural Network Section -->
            <section id="neural-network" class="example-section">
                <h2>Neural Networks: From Neurons to Transformers</h2>
            <p class="section-intro">Zoom in from a single neuron all the way up to deep networks, CNNs, RNNs, LSTMs, and transformers. Each module walks step-by-step and animates the flow.</p>

            <div class="neural-module">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Forward propagation refresher</h3>
                        <p>A network is stacked math. Inputs become features, hidden layers reshape them, and the output layer turns them into predictions.</p>
                        <ol class="step-list">
                            <li><strong>Input layer</strong>: normalized features (pixels, embeddings, sensor readings).</li>
                            <li><strong>Hidden layers</strong>: weighted sums + activations build new features.</li>
                            <li><strong>Output layer</strong>: scores or probabilities for each class.</li>
                        </ol>
                        <div class="math-formula">
                            \[
                            \text{hidden} = \text{activation}(\text{input} \times W_1 + b_1)
                            \]
                            \[
                            \text{output} = \text{activation}(\text{hidden} \times W_2 + b_2)
                            \]
                        </div>
                        <p class="example-note">Inference stops here. Training continues with loss, backprop, and weight updates.</p>
                    </div>
                    <div class="visualization">
                        <canvas id="neuralNetCanvas" width="400" height="400"></canvas>
                        <div class="controls">
                            <button onclick="runForwardProp()">Run Forward Propagation</button>
                            <button onclick="resetNetwork()">Reset</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module">
                <div class="explanation">
                    <h3>Neural network architectures at a glance</h3>
                    <p>Different architectures specialize in different kinds of data: images, sequences, or long-range context.</p>
                    <ul class="concept-bullets">
                        <li>Feedforward nets handle tabular features and classic classification.</li>
                        <li>CNNs are spatial pattern detectors for images and video.</li>
                        <li>RNNs and LSTMs handle sequences over time.</li>
                        <li>Transformers scale to long context across domains.</li>
                    </ul>
                </div>
                <div class="architecture-grid">
                    <article class="architecture-card" style="--arch-accent: var(--accent-1);">
                        <h4>Feedforward (MLP)</h4>
                        <svg class="arch-diagram" viewBox="0 0 180 120" role="img" aria-label="Feedforward network architecture">
                            <line class="arch-stroke" x1="30" y1="20" x2="90" y2="35"></line>
                            <line class="arch-stroke" x1="30" y1="20" x2="90" y2="60"></line>
                            <line class="arch-stroke" x1="30" y1="50" x2="90" y2="35"></line>
                            <line class="arch-stroke" x1="30" y1="50" x2="90" y2="60"></line>
                            <line class="arch-stroke" x1="90" y1="35" x2="150" y2="50"></line>
                            <line class="arch-stroke" x1="90" y1="60" x2="150" y2="50"></line>
                            <circle class="arch-node" cx="30" cy="20" r="6"></circle>
                            <circle class="arch-node" cx="30" cy="50" r="6"></circle>
                            <circle class="arch-node" cx="90" cy="35" r="6"></circle>
                            <circle class="arch-node" cx="90" cy="60" r="6"></circle>
                            <circle class="arch-node" cx="150" cy="50" r="6"></circle>
                        </svg>
                        <p class="example-note">Classic dense layers for structured data.</p>
                    </article>
                    <article class="architecture-card" style="--arch-accent: var(--accent-2);">
                        <h4>Deep Neural Network</h4>
                        <svg class="arch-diagram" viewBox="0 0 180 120" role="img" aria-label="Deep neural network architecture">
                            <line class="arch-stroke" x1="20" y1="25" x2="60" y2="25"></line>
                            <line class="arch-stroke" x1="60" y1="25" x2="100" y2="25"></line>
                            <line class="arch-stroke" x1="100" y1="25" x2="140" y2="25"></line>
                            <line class="arch-stroke" x1="140" y1="25" x2="170" y2="25"></line>
                            <circle class="arch-node" cx="20" cy="25" r="6"></circle>
                            <circle class="arch-node" cx="60" cy="25" r="6"></circle>
                            <circle class="arch-node" cx="100" cy="25" r="6"></circle>
                            <circle class="arch-node" cx="140" cy="25" r="6"></circle>
                            <circle class="arch-node" cx="170" cy="25" r="6"></circle>
                            <line class="arch-stroke" x1="20" y1="65" x2="60" y2="65"></line>
                            <line class="arch-stroke" x1="60" y1="65" x2="100" y2="65"></line>
                            <line class="arch-stroke" x1="100" y1="65" x2="140" y2="65"></line>
                            <line class="arch-stroke" x1="140" y1="65" x2="170" y2="65"></line>
                            <circle class="arch-node" cx="20" cy="65" r="6"></circle>
                            <circle class="arch-node" cx="60" cy="65" r="6"></circle>
                            <circle class="arch-node" cx="100" cy="65" r="6"></circle>
                            <circle class="arch-node" cx="140" cy="65" r="6"></circle>
                            <circle class="arch-node" cx="170" cy="65" r="6"></circle>
                        </svg>
                        <p class="example-note">Stacks many layers to build feature hierarchies.</p>
                    </article>
                    <article class="architecture-card" style="--arch-accent: var(--accent-3);">
                        <h4>Convolutional Network</h4>
                        <svg class="arch-diagram" viewBox="0 0 180 120" role="img" aria-label="Convolutional neural network architecture">
                            <rect class="arch-box" x="20" y="20" width="40" height="40"></rect>
                            <rect class="arch-box" x="70" y="30" width="24" height="24"></rect>
                            <rect class="arch-box" x="110" y="26" width="40" height="40"></rect>
                            <line class="arch-stroke" x1="60" y1="40" x2="70" y2="40"></line>
                            <line class="arch-stroke" x1="94" y1="40" x2="110" y2="40"></line>
                            <rect class="arch-box" x="20" y="70" width="40" height="30"></rect>
                            <rect class="arch-box" x="70" y="78" width="24" height="20"></rect>
                            <rect class="arch-box" x="110" y="72" width="40" height="30"></rect>
                        </svg>
                        <p class="example-note">Filters slide across images to find patterns.</p>
                    </article>
                    <article class="architecture-card" style="--arch-accent: var(--accent-4);">
                        <h4>Recurrent Network</h4>
                        <svg class="arch-diagram" viewBox="0 0 180 120" role="img" aria-label="Recurrent neural network architecture">
                            <rect class="arch-box" x="20" y="45" width="32" height="32"></rect>
                            <rect class="arch-box" x="74" y="45" width="32" height="32"></rect>
                            <rect class="arch-box" x="128" y="45" width="32" height="32"></rect>
                            <line class="arch-stroke" x1="52" y1="61" x2="74" y2="61"></line>
                            <line class="arch-stroke" x1="106" y1="61" x2="128" y2="61"></line>
                            <path class="arch-stroke" d="M36 45 C36 25, 60 25, 60 45"></path>
                            <path class="arch-stroke" d="M36 45 L36 35"></path>
                        </svg>
                        <p class="example-note">State flows through time for sequences.</p>
                    </article>
                    <article class="architecture-card" style="--arch-accent: var(--accent-1);">
                        <h4>LSTM</h4>
                        <svg class="arch-diagram" viewBox="0 0 180 120" role="img" aria-label="LSTM architecture">
                            <rect class="arch-box" x="20" y="40" width="60" height="40"></rect>
                            <circle class="arch-node" cx="110" cy="50" r="8"></circle>
                            <circle class="arch-node" cx="140" cy="50" r="8"></circle>
                            <circle class="arch-node" cx="125" cy="80" r="8"></circle>
                            <line class="arch-stroke" x1="80" y1="60" x2="102" y2="54"></line>
                            <line class="arch-stroke" x1="80" y1="60" x2="130" y2="54"></line>
                            <line class="arch-stroke" x1="80" y1="60" x2="118" y2="76"></line>
                        </svg>
                        <p class="example-note">Gated memory handles long-range signals.</p>
                    </article>
                    <article class="architecture-card" style="--arch-accent: var(--accent-2);">
                        <h4>Transformer</h4>
                        <svg class="arch-diagram" viewBox="0 0 180 120" role="img" aria-label="Transformer architecture">
                            <rect class="arch-box" x="25" y="20" width="130" height="20"></rect>
                            <rect class="arch-box" x="25" y="45" width="130" height="20"></rect>
                            <rect class="arch-box" x="25" y="70" width="130" height="20"></rect>
                            <line class="arch-stroke" x1="90" y1="10" x2="90" y2="100"></line>
                        </svg>
                        <p class="example-note">Self-attention mixes all tokens at once.</p>
                    </article>
                </div>
            </div>

            <div class="neural-module">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Neuron basics: weighted sum -&gt; activation</h3>
                        <p>Each neuron multiplies inputs by weights, adds a bias, then runs an activation function.</p>
                        <ol class="step-list">
                            <li>Inputs arrive as numbers.</li>
                            <li>Weights scale each input.</li>
                            <li>Bias shifts the total.</li>
                            <li>Activation decides the output.</li>
                        </ol>
                        <div class="math-formula">
                            \[
                            z = \sum_i x_i w_i + b, \quad a = f(z)
                            \]
                        </div>
                        <div class="example-chips" role="group" aria-label="Neuron examples">
                            <button class="toggle-btn is-active" type="button" data-neuron-example="stroke">Stroke detector</button>
                            <button class="toggle-btn" type="button" data-neuron-example="curve">Curve detector</button>
                            <button class="toggle-btn" type="button" data-neuron-example="noise">Noise filter</button>
                        </div>
                        <p class="example-note" id="neuronExampleNote"></p>
                        <div class="neural-readout">
                            <div class="readout-card">
                                <span class="readout-label">Inputs x</span>
                                <span class="readout-value" id="neuronInputs">[0, 0, 0]</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Weights w</span>
                                <span class="readout-value" id="neuronWeights">[0, 0, 0]</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Weighted sum z</span>
                                <span class="readout-value" id="neuronWeightedSum">0</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Bias b</span>
                                <span class="readout-value" id="neuronBias">0</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Activation a</span>
                                <span class="readout-value" id="neuronActivation">0</span>
                            </div>
                        </div>
                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="neuronStepBadge">Step 1 of 4</span>
                                <h4 id="neuronStepTitle">Inputs arrive</h4>
                            </div>
                            <p id="neuronStepText"></p>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="neuronCanvas" width="420" height="320"></canvas>
                        <div class="controls">
                            <button type="button" id="neuronPrevStep">Previous step</button>
                            <button type="button" id="neuronNextStep">Next step</button>
                            <button type="button" id="neuronPlay">Play loop</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Digit recognition: inference vs training</h3>
                        <p>Simple digit recognition starts from pixels, transforms them into hidden features, and predicts a digit.</p>
                        <div class="step-grid">
                            <div class="step-card">
                                <h4>Inference (predict)</h4>
                                <ol>
                                    <li>Read the image.</li>
                                    <li>Flatten + normalize.</li>
                                    <li>Hidden activations.</li>
                                    <li>Output probabilities.</li>
                                </ol>
                            </div>
                            <div class="step-card">
                                <h4>Training (learn)</h4>
                                <ol>
                                    <li>Forward pass (same as inference).</li>
                                    <li>Compute loss vs label.</li>
                                    <li>Backpropagate gradients.</li>
                                    <li>Update weights.</li>
                                </ol>
                            </div>
                        </div>
                        <div class="example-chips" role="group" aria-label="Digit examples">
                            <button class="toggle-btn is-active" type="button" data-digit-example="zero">Digit 0</button>
                            <button class="toggle-btn" type="button" data-digit-example="three">Digit 3</button>
                            <button class="toggle-btn" type="button" data-digit-example="seven">Digit 7</button>
                        </div>
                        <p class="example-note" id="digitExampleNote"></p>
                        <div class="toggle-group" role="group" aria-label="Digit mode">
                            <button class="toggle-btn is-active" type="button" data-digit-mode="inference">Inference</button>
                            <button class="toggle-btn" type="button" data-digit-mode="training">Training</button>
                        </div>
                        <div class="neural-readout">
                            <div class="readout-card">
                                <span class="readout-label">Target</span>
                                <span class="readout-value" id="digitTarget">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Prediction</span>
                                <span class="readout-value" id="digitPrediction">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Loss</span>
                                <span class="readout-value" id="digitLoss">-</span>
                            </div>
                        </div>
                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="digitStepBadge">Step 1 of 4</span>
                                <h4 id="digitStepTitle">Image input</h4>
                            </div>
                            <p id="digitStepText"></p>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="digitLabCanvas" width="420" height="340"></canvas>
                        <div class="controls">
                            <button type="button" id="digitPrevStep">Previous step</button>
                            <button type="button" id="digitNextStep">Next step</button>
                            <button type="button" id="digitPlay">Play loop</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module" id="backprop">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Backpropagation: step-by-step</h3>
                        <p>Backpropagation computes how each weight should change to reduce the loss.</p>
                        <ol class="step-list">
                            <li><strong>Forward pass</strong>: compute predictions.</li>
                            <li><strong>Loss</strong>: compare prediction to target.</li>
                            <li><strong>Backward pass</strong>: send gradients backward.</li>
                            <li><strong>Update</strong>: adjust weights with the learning rate.</li>
                        </ol>
                        <div class="math-formula">
                            \[
                            \frac{\partial L}{\partial w} = \frac{\partial L}{\partial \text{output}} \cdot \frac{\partial \text{output}}{\partial w}
                            \]
                        </div>
                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="backpropStepBadge">Step 1 of 4</span>
                                <h4 id="backpropStepTitle">Forward pass</h4>
                            </div>
                            <p id="backpropStepText"></p>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="backpropCanvas" width="400" height="400"></canvas>
                        <div class="controls">
                            <button type="button" id="backpropPrevStep">Previous step</button>
                            <button type="button" id="backpropNextStep">Next step</button>
                            <button type="button" id="backpropPlay">Play steps</button>
                            <button type="button" id="backpropReset">Reset</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Deep neural networks: stacking layers</h3>
                        <p>More layers let the model build a hierarchy of features.</p>
                        <ul class="concept-bullets">
                            <li>Early layers: edges and simple shapes.</li>
                            <li>Middle layers: textures and parts.</li>
                            <li>Late layers: whole objects or concepts.</li>
                        </ul>
                        <p class="example-note">Examples: face recognition, speech-to-text, medical scans.</p>
                    </div>
                    <div class="visualization">
                        <canvas id="deepNetCanvas" width="420" height="320"></canvas>
                        <div class="controls">
                            <div class="slider-group">
                                <span class="slider-title">Depth</span>
                                <label>Layers <span id="deepDepthVal">5</span></label>
                                <input type="range" id="deepDepth" min="3" max="7" step="1" value="5">
                            </div>
                            <button type="button" id="deepRun">Run signal</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>CNNs: slide a filter across the image</h3>
                        <p>Convolutions scan a small filter across pixels to detect patterns like edges or corners.</p>
                        <ul class="concept-bullets">
                            <li>Shared weights detect the same pattern anywhere.</li>
                            <li>Each output cell is a dot product of patch and kernel.</li>
                            <li>Pooling summarizes nearby activations.</li>
                            <li>Stacked filters build complex features.</li>
                        </ul>
                        <div class="math-formula">
                            \[
                            Y_{i,j} = \sum_{u=0}^{k-1}\sum_{v=0}^{k-1} X_{i+u, j+v} K_{u,v} + b
                            \]
                            \[
                            H_{out} = H - k + 1
                            \]
                        </div>
                        <p class="example-note" id="cnnMathNote"></p>
                        <div class="example-chips" role="group" aria-label="CNN examples">
                            <button class="toggle-btn is-active" type="button" data-cnn-example="edge">Edge detector</button>
                            <button class="toggle-btn" type="button" data-cnn-example="corner">Corner detector</button>
                            <button class="toggle-btn" type="button" data-cnn-example="diagonal">Diagonal stroke</button>
                        </div>
                        <p class="example-note" id="cnnExampleNote"></p>
                        <div class="neural-readout">
                            <div class="readout-card">
                                <span class="readout-label">Patch</span>
                                <span class="readout-value" id="cnnPatch">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Conv sum</span>
                                <span class="readout-value" id="cnnOutputValue">-</span>
                            </div>
                        </div>
                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="cnnStepBadge">Step 1 of 16</span>
                                <h4 id="cnnStepTitle">Filter sweep</h4>
                            </div>
                            <p id="cnnStepText"></p>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="cnnCanvas" width="420" height="320"></canvas>
                        <div class="controls">
                            <button type="button" id="cnnPrevStep">Previous patch</button>
                            <button type="button" id="cnnNextStep">Next patch</button>
                            <button type="button" id="cnnPlay">Play sweep</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>RNNs: memory over time</h3>
                        <p>Recurrent networks reuse the same weights at every time step, passing a hidden state forward.</p>
                        <ul class="concept-bullets">
                            <li>Hidden state stores short-term memory.</li>
                            <li>Same matrices \(W_x, W_h\) are reused at each step.</li>
                            <li>Great for sequences like text or sensor data.</li>
                            <li>Outputs can appear at every step.</li>
                        </ul>
                        <div class="math-formula">
                            \[
                            h_t = \tanh(W_x x_t + W_h h_{t-1} + b), \quad y_t = \mathrm{softmax}(W_y h_t)
                            \]
                        </div>
                        <p class="example-note" id="rnnMathNote"></p>
                        <div class="example-chips" role="group" aria-label="RNN examples">
                            <button class="toggle-btn is-active" type="button" data-rnn-example="sentence">Next word</button>
                            <button class="toggle-btn" type="button" data-rnn-example="weather">Forecast</button>
                            <button class="toggle-btn" type="button" data-rnn-example="music">Music pattern</button>
                        </div>
                        <p class="example-note" id="rnnExampleNote"></p>
                        <div class="neural-readout">
                            <div class="readout-card">
                                <span class="readout-label">Token</span>
                                <span class="readout-value" id="rnnToken">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Input x_t</span>
                                <span class="readout-value" id="rnnInputValue">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Prev hidden h_{t-1}</span>
                                <span class="readout-value" id="rnnPrevHidden">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Hidden h_t</span>
                                <span class="readout-value" id="rnnHidden">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Next output</span>
                                <span class="readout-value" id="rnnOutput">-</span>
                            </div>
                        </div>
                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="rnnStepBadge">Step 1 of 4</span>
                                <h4 id="rnnStepTitle">Time step 1</h4>
                            </div>
                            <p id="rnnStepText"></p>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="rnnCanvas" width="420" height="320"></canvas>
                        <div class="controls">
                            <button type="button" id="rnnPrevStep">Previous step</button>
                            <button type="button" id="rnnNextStep">Next step</button>
                            <button type="button" id="rnnPlay">Play sequence</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>LSTM: long-short term memory</h3>
                        <p>LSTMs add gates that decide what to forget, what to write, and what to output.</p>
                        <ul class="concept-bullets">
                            <li>Forget gate keeps or drops old memory.</li>
                            <li>Cell state carries long-range info additively.</li>
                            <li>Input gate writes new information.</li>
                            <li>Output gate reveals the right part.</li>
                        </ul>
                        <div class="math-formula">
                            \[
                            f_t = \sigma(W_f [h_{t-1}, x_t] + b_f)
                            \]
                            \[
                            i_t = \sigma(W_i [h_{t-1}, x_t] + b_i), \quad \tilde{c}_t = \tanh(W_c [h_{t-1}, x_t] + b_c)
                            \]
                            \[
                            c_t = f_t \odot c_{t-1} + i_t \odot \tilde{c}_t, \quad h_t = o_t \odot \tanh(c_t)
                            \]
                        </div>
                        <p class="example-note" id="lstmMathNote"></p>
                        <div class="example-chips" role="group" aria-label="LSTM examples">
                            <button class="toggle-btn is-active" type="button" data-lstm-example="story">Story clue</button>
                            <button class="toggle-btn" type="button" data-lstm-example="quotes">Quote tracking</button>
                            <button class="toggle-btn" type="button" data-lstm-example="sensor">Sensor drift</button>
                        </div>
                        <p class="example-note" id="lstmExampleNote"></p>
                        <div class="neural-readout">
                            <div class="readout-card">
                                <span class="readout-label">Memory before</span>
                                <span class="readout-value" id="lstmMemoryBefore">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Forget gate</span>
                                <span class="readout-value" id="lstmForgetGate">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Input gate</span>
                                <span class="readout-value" id="lstmInputGate">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Candidate \(\tilde{c}_t\)</span>
                                <span class="readout-value" id="lstmCandidate">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Memory after</span>
                                <span class="readout-value" id="lstmMemoryAfter">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Output gate</span>
                                <span class="readout-value" id="lstmOutputGate">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Hidden h_t</span>
                                <span class="readout-value" id="lstmHiddenOutput">-</span>
                            </div>
                        </div>
                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="lstmStepBadge">Step 1 of 4</span>
                                <h4 id="lstmStepTitle">Forget gate</h4>
                            </div>
                            <p id="lstmStepText"></p>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="lstmCanvas" width="420" height="320"></canvas>
                        <div class="controls">
                            <button type="button" id="lstmPrevStep">Previous gate</button>
                            <button type="button" id="lstmNextStep">Next gate</button>
                            <button type="button" id="lstmPlay">Play gates</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Transformers: staged pipeline</h3>
                        <p>Transformers process all tokens at once, then use attention to mix information.</p>
                        <ol class="step-list">
                            <li>Tokenize and embed.</li>
                            <li>Add positional encoding.</li>
                            <li>Self-attention mixes context.</li>
                            <li>Feedforward + residual.</li>
                            <li>Output probabilities.</li>
                        </ol>
                        <div class="example-chips" role="group" aria-label="Transformer examples">
                            <button class="toggle-btn is-active" type="button" data-transformer-example="translate">Translation</button>
                            <button class="toggle-btn" type="button" data-transformer-example="summary">Summarization</button>
                            <button class="toggle-btn" type="button" data-transformer-example="code">Code completion</button>
                        </div>
                        <p class="example-note" id="transformerExampleNote"></p>
                        <div class="example-chips" role="group" aria-label="Transformer stages">
                            <button class="toggle-btn is-active" type="button" data-transformer-stage="0">Embed</button>
                            <button class="toggle-btn" type="button" data-transformer-stage="1">Positions</button>
                            <button class="toggle-btn" type="button" data-transformer-stage="2">Attention</button>
                            <button class="toggle-btn" type="button" data-transformer-stage="3">Feedforward</button>
                            <button class="toggle-btn" type="button" data-transformer-stage="4">Output</button>
                        </div>
                        <div class="neural-readout">
                            <div class="readout-card">
                                <span class="readout-label">Tokens</span>
                                <span class="readout-value" id="transformerTokenCount">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Focus token</span>
                                <span class="readout-value" id="transformerFocusToken">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Stage</span>
                                <span class="readout-value" id="transformerStageLabel">-</span>
                            </div>
                        </div>
                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="transformerStageBadge">Stage 1 of 5</span>
                                <h4 id="transformerStageTitle">Tokenize + embed</h4>
                            </div>
                            <p id="transformerStageText"></p>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="transformerCanvas" width="420" height="340"></canvas>
                        <div class="controls">
                            <button type="button" id="transformerPrevStage">Previous stage</button>
                            <button type="button" id="transformerNextStage">Next stage</button>
                            <button type="button" id="transformerPlay">Play stages</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module transformer-advanced" id="transformer-advanced">
                <div class="content-grid transformer-advanced-grid">
                    <div class="explanation">
                        <h3>Advanced Transformer Model: step-by-step visualization</h3>
                        <p class="section-intro">Use the stepper to follow the full Transformer pipeline without leaving the visuals.</p>

                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="transformerAdvancedBadge">Step 1 of 15</span>
                                <h4 id="transformerAdvancedTitle">Tokenization</h4>
                            </div>
                            <p id="transformerAdvancedText"></p>
                            <ul class="step-points" id="transformerAdvancedPoints"></ul>
                            <div class="math-formula" id="transformerAdvancedMath"></div>
                        </div>

                        <div class="example-chips transformer-advanced-steps" role="group" aria-label="Transformer advanced steps">
                            <button class="toggle-btn is-active" type="button" data-transformer-advanced-step="0">Tokenize</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="1">Token embed</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="2">Position</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="3">Final embed</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="4">QKV</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="5">Split heads</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="6">QK^T</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="7">Mask</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="8">Softmax</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="9">Concat</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="10">MLP expand</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="11">MLP project</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="12">Logits</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="13">Sampling</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="14">Aux</button>
                        </div>

                        <div class="neural-readout">
                            <div class="readout-card">
                                <span class="readout-label">Model</span>
                                <span class="readout-value">GPT-2 (small)</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Embedding dim</span>
                                <span class="readout-value">768</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Heads</span>
                                <span class="readout-value">12</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Blocks</span>
                                <span class="readout-value">12</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Vocabulary</span>
                                <span class="readout-value">50,257</span>
                            </div>
                        </div>

                        <details class="reference-drawer">
                            <summary>Reference narrative (full explanation)</summary>
                            <div class="guide-stack">
                                <article class="guide-card">
                                    <h4>What is a Transformer?</h4>
                                    <p>Transformer is a neural network architecture that has fundamentally changed the approach to artificial intelligence. It was introduced in the 2017 paper "Attention is All You Need" and now powers models like OpenAI GPT, Meta Llama, and Google Gemini.</p>
                                    <p>Transformers are not limited to text. They also drive audio generation, image recognition, protein structure prediction, and game playing, showing how broadly the architecture applies across domains.</p>
                                    <p>Text-generative Transformers operate on next-token prediction: given a prompt, the model estimates the most probable next token. The core innovation is self-attention, which lets all tokens communicate and capture long-range dependencies.</p>
                                    <p>Transformer Explainer is powered by GPT-2 (small) with 124 million parameters. While it is not the largest model, its components match the structure of more recent systems.</p>
                                </article>

                                <article class="guide-card">
                                    <h4>Transformer architecture</h4>
                                    <p>Every text-generative Transformer consists of three components:</p>
                                    <ul class="concept-bullets">
                                        <li><strong>Embedding</strong>: tokens become vectors and receive positional signals.</li>
                                        <li><strong>Transformer block</strong>: multi-head attention routes context; an MLP refines each token.</li>
                                        <li><strong>Output probabilities</strong>: logits are turned into a probability distribution for the next token.</li>
                                    </ul>
                                </article>

                                <article class="guide-card">
                                    <h4>Embedding pipeline</h4>
                                    <p>Suppose the prompt is: "Data visualization empowers users to". Embedding converts this text into a numerical representation in four steps:</p>
                                    <ol class="step-list">
                                        <li><strong>Tokenization</strong>: split into word or subword tokens.</li>
                                        <li><strong>Token embedding</strong>: map tokens to a vector space.</li>
                                        <li><strong>Positional encoding</strong>: add position information.</li>
                                        <li><strong>Final embedding</strong>: sum token and positional vectors.</li>
                                    </ol>
                                    <p class="figure-note">Figure 1. Expanding the embedding view: tokenization, token embedding, positional encoding, and final embedding.</p>
                                    <p>GPT-2 (small) uses 768-dimensional embeddings and a vocabulary of 50,257 tokens. The embedding matrix has shape (50,257, 768) with about 39 million parameters.</p>
                                </article>

                                <article class="guide-card">
                                    <h4>Transformer block</h4>
                                    <p>The block combines multi-head self-attention and an MLP. GPT-2 (small) stacks 12 blocks, allowing token representations to evolve into higher-level meanings over depth.</p>
                                    <p>Multi-head attention captures context across tokens. The MLP processes each token independently to refine its representation.</p>
                                </article>

                                <article class="guide-card">
                                    <h4>Multi-head self-attention</h4>
                                    <p>Each token is transformed into Query (Q), Key (K), and Value (V) vectors:</p>
                                    <div class="math-formula">
                                        \[
                                        QKV_{ij} = \left( \sum_{d=1}^{768} \text{Embedding}_{i,d} \cdot \text{Weights}_{d,j} \right) + \text{Bias}_j
                                        \]
                                    </div>
                                    <p>Query is like the search text, Key is the result title, and Value is the page content. This analogy helps explain why attention scores route information from relevant tokens.</p>
                                    <p class="figure-note">Figure 2. Computing Q, K, and V from the embedding.</p>
                                    <ul class="concept-bullets">
                                        <li><strong>Split into heads</strong>: GPT-2 uses 12 attention heads.</li>
                                        <li><strong>Masked attention</strong>: prevents peeking at future tokens.</li>
                                        <li><strong>Concat + projection</strong>: heads are merged for the next stage.</li>
                                    </ul>
                                    <p>Scaling and masking set future positions to negative infinity so each token predicts without looking ahead.</p>
                                    <p class="figure-note">Figure 3. Masked self-attention: dot product, scale + mask, softmax + dropout.</p>
                                </article>

                                <article class="guide-card">
                                    <h4>MLP: multi-layer perceptron</h4>
                                    <p>The MLP expands each token from 768 to 3072 dimensions with a GELU activation, then compresses back to 768. This enriches the representation independently per token.</p>
                                    <p class="figure-note">Figure 4. The MLP expands then compresses each token representation.</p>
                                </article>

                                <article class="guide-card">
                                    <h4>Output probabilities and sampling</h4>
                                    <p>The final linear layer maps to 50,257 logits, one for each token in the vocabulary. Softmax turns logits into probabilities for the next token.</p>
                                    <p class="figure-note">Figure 5. Each token receives a probability from the output logits.</p>
                                    <p>Temperature controls sharpness: T=1 keeps logits unchanged, T&lt;1 makes outputs more deterministic, and T&gt;1 increases randomness.</p>
                                    <div class="info-grid">
                                        <div class="info-card">
                                            <h5>Temperature</h5>
                                            <p>Lower values make outputs more deterministic; higher values add creativity.</p>
                                        </div>
                                        <div class="info-card">
                                            <h5>Top-k</h5>
                                            <p>Restrict sampling to the top k highest-probability tokens.</p>
                                        </div>
                                        <div class="info-card">
                                            <h5>Top-p</h5>
                                            <p>Sample from the smallest set whose cumulative probability exceeds p.</p>
                                        </div>
                                    </div>
                                </article>

                                <article class="guide-card">
                                    <h4>Auxiliary architectural features</h4>
                                    <p>Layer normalization stabilizes training and is applied twice per block. Dropout regularizes by randomly deactivating units during training and is disabled during inference. Residual connections add skip paths twice per block, helping gradients flow and preventing vanishing gradients.</p>
                                </article>
                            </div>
                        </details>
                    </div>
                    <div class="visualization transformer-advanced-visuals">
                        <div class="transformer-advanced-canvas-grid">
                            <canvas id="transformerAdvancedOverviewCanvas" width="420" height="200"></canvas>
                            <canvas id="transformerAdvancedCanvas" width="420" height="320"></canvas>
                        </div>
                        <p class="figure-note">The overview highlights where you are in the stack; the detail panel shows the math.</p>
                        <div class="controls">
                            <button type="button" id="transformerAdvancedPrev">Previous step</button>
                            <button type="button" id="transformerAdvancedNext">Next step</button>
                            <button type="button" id="transformerAdvancedPlay">Play steps</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        </section>

        <section class="chapter" data-chapter="llm-foundations">
            <nav class="chapter-nav" aria-label="Large language models sections">
                <a href="#llm-tutorial">Tutorial</a>
                <a href="#transformer-map">Transformer Depth Map</a>
                <a href="#prompt-engineering">Prompt Engineering</a>
                <a href="#llm-fundamentals">LLM Fundamentals</a>
                <a href="#vector-databases">Vector Databases</a>
                <a href="#sutskever-list">Sutskever's List</a>
                <a href="#ai-agents">AI Agents</a>
            </nav>

            <!-- LLM Tutorial Section -->
            <section id="llm-tutorial" class="example-section">
                <h2>Large Language Models: Guided Tutorial</h2>
                <p class="section-intro">A hands-on path that ties prompting, model behavior, and agent building into one workflow.</p>
                <div class="learning-path">
                    <div class="path-card">
                        <span class="path-step">Step 1</span>
                        <h4>Frame the task</h4>
                        <p>Define the role, goal, and success criteria before you write prompts.</p>
                        <span class="path-goal">Goal: a clear, testable objective.</span>
                    </div>
                    <div class="path-card">
                        <span class="path-step">Step 2</span>
                        <h4>Structure the prompt</h4>
                        <p>Use context blocks, constraints, and a target format.</p>
                        <span class="path-goal">Goal: predictable, repeatable outputs.</span>
                    </div>
                    <div class="path-card">
                        <span class="path-step">Step 3</span>
                        <h4>Inspect model behavior</h4>
                        <p>Adjust temperature, context, and stop rules to stabilize responses.</p>
                        <span class="path-goal">Goal: reduce variance and hallucinations.</span>
                    </div>
                    <div class="path-card">
                        <span class="path-step">Step 4</span>
                        <h4>Add tools</h4>
                        <p>Introduce tool calling for data access or automation.</p>
                        <span class="path-goal">Goal: verified outputs with traceability.</span>
                    </div>
                    <div class="path-card">
                        <span class="path-step">Step 5</span>
                        <h4>Evaluate and iterate</h4>
                        <p>Write evals, measure regressions, and refine.</p>
                        <span class="path-goal">Goal: steady improvements with evidence.</span>
                    </div>
                </div>
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Quick tutorial checklist</h3>
                        <ol class="step-list">
                            <li>Collect 5 real inputs and draft a baseline prompt.</li>
                            <li>Define the output format and failure cases.</li>
                            <li>Create a tool schema for any external data.</li>
                            <li>Write 5 evals with expected results.</li>
                            <li>Iterate until the eval pass rate stabilizes.</li>
                        </ol>
                        <div class="mini-mission">Mini mission: run a 5-example eval before you ship.</div>
                    </div>
                    <div class="visualization card-column">
                        <div class="prompt-template">
                            <h4>Tutorial starter prompt</h4>
                            <pre>ROLE: You are an AI PM.
TASK: Draft a 1-page feature brief.
CONTEXT:
"""
Include 5 user notes, metrics, and constraints.
"""
CONSTRAINTS: 250 words max. Bullet format.
OUTPUT FORMAT:
- Problem
- Users
- Constraints
- Proposal
- Risks
CHECKS: List missing inputs.</pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Transformer Depth Map Section -->
            <section id="transformer-map" class="example-section">
                <h2>Transformer Depth Map: From Mechanics to Reasoning Models</h2>
                <p class="section-intro">Use this depth indicator to move from core mechanics to training signals and reasoning behaviors. Each tier adds a new layer of capability.</p>
                <div class="depth-map">
                    <div class="depth-tier" style="--depth-accent: var(--accent-1);">
                        <div class="depth-marker">
                            <span class="depth-badge">Depth 1</span>
                            <h3>Transformer fundamentals</h3>
                            <p>Mechanics and intuition.</p>
                        </div>
                        <div class="depth-content">
                            <div class="depth-visual">
                                <svg class="depth-diagram depth-diagram--fundamentals" viewBox="0 0 420 120" role="img" aria-label="Tokens flow through Q K V, attention, feedforward, and residual normalization">
                                    <defs>
                                        <marker id="depth-arrow-1" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                            <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                        </marker>
                                    </defs>
                                    <rect class="depth-box" x="15" y="30" width="70" height="50" rx="12"></rect>
                                    <rect class="depth-token" x="26" y="46" width="10" height="18" rx="3"></rect>
                                    <rect class="depth-token" x="40" y="46" width="10" height="18" rx="3"></rect>
                                    <rect class="depth-token" x="54" y="46" width="10" height="18" rx="3"></rect>
                                    <rect class="depth-token" x="68" y="46" width="10" height="18" rx="3"></rect>
                                    <text x="50" y="92" text-anchor="middle">Tokens</text>

                                    <rect class="depth-box" x="95" y="30" width="70" height="50" rx="12"></rect>
                                    <rect class="depth-chip" x="104" y="40" width="14" height="12" rx="3"></rect>
                                    <rect class="depth-chip" x="124" y="40" width="14" height="12" rx="3"></rect>
                                    <rect class="depth-chip" x="144" y="40" width="14" height="12" rx="3"></rect>
                                    <text x="111" y="49" text-anchor="middle">Q</text>
                                    <text x="131" y="49" text-anchor="middle">K</text>
                                    <text x="151" y="49" text-anchor="middle">V</text>

                                    <rect class="depth-box" x="175" y="30" width="70" height="50" rx="12"></rect>
                                    <text x="210" y="60" text-anchor="middle">Attention</text>

                                    <rect class="depth-box" x="255" y="30" width="60" height="50" rx="12"></rect>
                                    <text x="285" y="60" text-anchor="middle">FFN</text>

                                    <rect class="depth-box" x="325" y="30" width="70" height="50" rx="12"></rect>
                                    <text x="360" y="60" text-anchor="middle">Residual</text>
                                    <text x="360" y="72" text-anchor="middle">+ Norm</text>

                                    <line class="depth-arrow" x1="85" y1="55" x2="95" y2="55" marker-end="url(#depth-arrow-1)"></line>
                                    <line class="depth-arrow" x1="165" y1="55" x2="175" y2="55" marker-end="url(#depth-arrow-1)"></line>
                                    <line class="depth-arrow" x1="245" y1="55" x2="255" y2="55" marker-end="url(#depth-arrow-1)"></line>
                                    <line class="depth-arrow" x1="315" y1="55" x2="325" y2="55" marker-end="url(#depth-arrow-1)"></line>
                                </svg>
                                <p class="depth-visual-note">Tokens turn into Q/K/V, attention mixes them, FFN refines, residual + norm stabilize.</p>
                            </div>
                            <div class="depth-grid">
                                <article class="depth-card">
                                    <h4>The big picture</h4>
                                    <div class="depth-card-body">
                                        <div class="depth-mini">
                                            <svg viewBox="0 0 160 90" role="img" aria-label="Encoder-decoder and decoder-only overview">
                                                <defs>
                                                    <marker id="depth-mini-arrow-1a" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                                        <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                                    </marker>
                                                </defs>
                                                <rect class="depth-box" x="6" y="16" width="36" height="20" rx="6"></rect>
                                                <rect class="depth-token" x="10" y="20" width="6" height="12" rx="2"></rect>
                                                <rect class="depth-token" x="18" y="20" width="6" height="12" rx="2"></rect>
                                                <rect class="depth-token" x="26" y="20" width="6" height="12" rx="2"></rect>
                                                <text x="24" y="46" text-anchor="middle">Input</text>

                                                <rect class="depth-box" x="52" y="10" width="26" height="16" rx="4"></rect>
                                                <rect class="depth-box" x="52" y="30" width="26" height="16" rx="4"></rect>
                                                <rect class="depth-box" x="52" y="50" width="26" height="16" rx="4"></rect>
                                                <text x="65" y="76" text-anchor="middle">Enc</text>

                                                <rect class="depth-box" x="92" y="10" width="26" height="16" rx="4"></rect>
                                                <rect class="depth-box" x="92" y="30" width="26" height="16" rx="4"></rect>
                                                <rect class="depth-box" x="92" y="50" width="26" height="16" rx="4"></rect>
                                                <text x="105" y="76" text-anchor="middle">Dec</text>

                                                <circle class="depth-node" cx="140" cy="40" r="7"></circle>
                                                <text x="140" y="56" text-anchor="middle">Out</text>

                                                <line class="depth-arrow" x1="42" y1="26" x2="52" y2="26" marker-end="url(#depth-mini-arrow-1a)"></line>
                                                <line class="depth-arrow" x1="78" y1="36" x2="92" y2="36" marker-end="url(#depth-mini-arrow-1a)"></line>
                                                <line class="depth-arrow" x1="118" y1="40" x2="133" y2="40" marker-end="url(#depth-mini-arrow-1a)"></line>
                                            </svg>
                                        </div>
                                        <div class="depth-copy">
                                            <p>Transformers model sequences by letting every token attend to every other token in one step, so computation is parallel instead of strictly sequential.</p>
                                            <p>Encoder-decoder stacks build a memory from the input, while decoder-only stacks generate the next token with a causal mask.</p>
                                        </div>
                                    </div>
                                </article>
                                <article class="depth-card">
                                    <h4>Scaled dot-product attention</h4>
                                    <div class="depth-card-body">
                                        <div class="depth-mini">
                                            <svg viewBox="0 0 160 90" role="img" aria-label="Queries and keys score similarity, softmax weights mix values">
                                                <defs>
                                                    <marker id="depth-mini-arrow-1b" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                                        <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                                    </marker>
                                                </defs>
                                                <rect class="depth-box" x="6" y="10" width="28" height="14" rx="4"></rect>
                                                <text x="20" y="20" text-anchor="middle">Q</text>
                                                <rect class="depth-box" x="6" y="34" width="28" height="14" rx="4"></rect>
                                                <text x="20" y="44" text-anchor="middle">K</text>
                                                <rect class="depth-box" x="6" y="58" width="28" height="14" rx="4"></rect>
                                                <text x="20" y="68" text-anchor="middle">V</text>

                                                <rect class="depth-box" x="48" y="26" width="36" height="18" rx="5"></rect>
                                                <text x="66" y="38" text-anchor="middle">QK^T</text>
                                                <rect class="depth-box" x="92" y="26" width="40" height="18" rx="5"></rect>
                                                <text x="112" y="38" text-anchor="middle">Softmax</text>
                                                <rect class="depth-box" x="92" y="56" width="40" height="18" rx="5"></rect>
                                                <text x="112" y="68" text-anchor="middle">Sum</text>
                                                <circle class="depth-node" cx="145" cy="66" r="7"></circle>
                                                <text x="145" y="82" text-anchor="middle">Out</text>

                                                <line class="depth-arrow" x1="34" y1="18" x2="48" y2="31" marker-end="url(#depth-mini-arrow-1b)"></line>
                                                <line class="depth-arrow" x1="34" y1="40" x2="48" y2="35" marker-end="url(#depth-mini-arrow-1b)"></line>
                                                <line class="depth-arrow" x1="84" y1="35" x2="92" y2="35" marker-end="url(#depth-mini-arrow-1b)"></line>
                                                <line class="depth-arrow" x1="112" y1="44" x2="112" y2="56" marker-end="url(#depth-mini-arrow-1b)"></line>
                                                <line class="depth-arrow" x1="34" y1="66" x2="92" y2="66" marker-end="url(#depth-mini-arrow-1b)"></line>
                                                <line class="depth-arrow" x1="132" y1="66" x2="138" y2="66" marker-end="url(#depth-mini-arrow-1b)"></line>
                                            </svg>
                                        </div>
                                        <div class="depth-copy">
                                            <p>Queries and keys produce similarity scores, softmax turns scores into weights, and values are mixed by a weighted sum.</p>
                                            <p>Scaling by sqrt(d) keeps logits in a stable range so softmax does not saturate too early.</p>
                                        </div>
                                    </div>
                                </article>
                                <article class="depth-card">
                                    <h4>Multi-head + residuals + layer norm</h4>
                                    <div class="depth-card-body">
                                        <div class="depth-mini">
                                            <svg viewBox="0 0 160 90" role="img" aria-label="Multiple attention heads merge with residual and normalization">
                                                <defs>
                                                    <marker id="depth-mini-arrow-1c" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                                        <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                                    </marker>
                                                </defs>
                                                <rect class="depth-box" x="6" y="36" width="24" height="16" rx="4"></rect>
                                                <text x="18" y="48" text-anchor="middle">In</text>

                                                <rect class="depth-box" x="44" y="10" width="28" height="16" rx="4"></rect>
                                                <text x="58" y="22" text-anchor="middle">H1</text>
                                                <rect class="depth-box" x="44" y="34" width="28" height="16" rx="4"></rect>
                                                <text x="58" y="46" text-anchor="middle">H2</text>
                                                <rect class="depth-box" x="44" y="58" width="28" height="16" rx="4"></rect>
                                                <text x="58" y="70" text-anchor="middle">H3</text>

                                                <rect class="depth-box" x="84" y="36" width="34" height="16" rx="4"></rect>
                                                <text x="101" y="48" text-anchor="middle">Concat</text>
                                                <rect class="depth-box" x="126" y="36" width="24" height="16" rx="4"></rect>
                                                <text x="138" y="48" text-anchor="middle">LN</text>

                                                <line class="depth-arrow" x1="30" y1="44" x2="44" y2="18" marker-end="url(#depth-mini-arrow-1c)"></line>
                                                <line class="depth-arrow" x1="30" y1="44" x2="44" y2="42" marker-end="url(#depth-mini-arrow-1c)"></line>
                                                <line class="depth-arrow" x1="30" y1="44" x2="44" y2="66" marker-end="url(#depth-mini-arrow-1c)"></line>
                                                <line class="depth-arrow" x1="72" y1="18" x2="84" y2="44" marker-end="url(#depth-mini-arrow-1c)"></line>
                                                <line class="depth-arrow" x1="72" y1="42" x2="84" y2="44" marker-end="url(#depth-mini-arrow-1c)"></line>
                                                <line class="depth-arrow" x1="72" y1="66" x2="84" y2="44" marker-end="url(#depth-mini-arrow-1c)"></line>
                                                <line class="depth-arrow" x1="118" y1="44" x2="126" y2="44" marker-end="url(#depth-mini-arrow-1c)"></line>
                                                <line class="depth-skip" x1="30" y1="52" x2="126" y2="52"></line>
                                            </svg>
                                        </div>
                                        <div class="depth-copy">
                                            <p>Each head attends in its own subspace, the heads are concatenated, and a projection mixes them back together.</p>
                                            <p>Residual paths keep the original signal available, while layer norm stabilizes scale across the block.</p>
                                        </div>
                                    </div>
                                </article>
                                <article class="depth-card">
                                    <h4>Positional encoding</h4>
                                    <div class="depth-card-body">
                                        <div class="depth-mini">
                                            <svg viewBox="0 0 160 90" role="img" aria-label="Positional encodings add waves to token embeddings">
                                                <defs>
                                                    <marker id="depth-mini-arrow-1d" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                                        <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                                    </marker>
                                                </defs>
                                                <rect class="depth-box" x="12" y="14" width="26" height="18" rx="4"></rect>
                                                <rect class="depth-box" x="44" y="14" width="26" height="18" rx="4"></rect>
                                                <rect class="depth-box" x="76" y="14" width="26" height="18" rx="4"></rect>
                                                <rect class="depth-box" x="108" y="14" width="26" height="18" rx="4"></rect>
                                                <text x="25" y="26" text-anchor="middle">t1</text>
                                                <text x="57" y="26" text-anchor="middle">t2</text>
                                                <text x="89" y="26" text-anchor="middle">t3</text>
                                                <text x="121" y="26" text-anchor="middle">t4</text>

                                                <path class="depth-wave" d="M10 62 C20 50, 30 74, 40 62 C50 50, 60 74, 70 62 C80 50, 90 74, 100 62 C110 50, 120 74, 130 62"></path>
                                                <text x="80" y="80" text-anchor="middle">PE</text>

                                                <line class="depth-arrow" x1="25" y1="32" x2="25" y2="54" marker-end="url(#depth-mini-arrow-1d)"></line>
                                                <line class="depth-arrow" x1="57" y1="32" x2="57" y2="54" marker-end="url(#depth-mini-arrow-1d)"></line>
                                                <line class="depth-arrow" x1="89" y1="32" x2="89" y2="54" marker-end="url(#depth-mini-arrow-1d)"></line>
                                                <line class="depth-arrow" x1="121" y1="32" x2="121" y2="54" marker-end="url(#depth-mini-arrow-1d)"></line>
                                            </svg>
                                        </div>
                                        <div class="depth-copy">
                                            <p>Attention is permutation-invariant, so we add position signals to token embeddings before attention.</p>
                                            <p>Sinusoidal encodings give each position a unique mix of frequencies; learned or relative schemes encode distance directly.</p>
                                        </div>
                                    </div>
                                </article>
                            </div>
                        </div>
                    </div>

                    <div class="depth-tier" style="--depth-accent: var(--accent-2);">
                        <div class="depth-marker">
                            <span class="depth-badge">Depth 2</span>
                            <h3>Transformer into an LLM</h3>
                            <p>Training objectives and variants.</p>
                        </div>
                        <div class="depth-content">
                            <div class="depth-visual">
                                <svg class="depth-diagram depth-diagram--llm" viewBox="0 0 420 140" role="img" aria-label="Decoder only and encoder only paths with masking and objectives">
                                    <defs>
                                        <marker id="depth-arrow-2" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                            <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                        </marker>
                                    </defs>
                                    <rect class="depth-box" x="20" y="16" width="160" height="40" rx="12"></rect>
                                    <text x="100" y="40" text-anchor="middle">Decoder-only</text>
                                    <line class="depth-soft" x1="40" y1="24" x2="80" y2="52"></line>
                                    <line class="depth-soft" x1="60" y1="24" x2="100" y2="52"></line>
                                    <line class="depth-soft" x1="80" y1="24" x2="120" y2="52"></line>

                                    <rect class="depth-box" x="240" y="16" width="160" height="40" rx="12"></rect>
                                    <text x="320" y="40" text-anchor="middle">Encoder-only</text>
                                    <line class="depth-soft" x1="270" y1="38" x2="370" y2="38"></line>
                                    <polygon class="depth-arrowhead" points="270 38, 278 34, 278 42"></polygon>
                                    <polygon class="depth-arrowhead" points="370 38, 362 34, 362 42"></polygon>

                                    <rect class="depth-box depth-box-muted" x="35" y="78" width="130" height="34" rx="10"></rect>
                                    <text x="100" y="99" text-anchor="middle">Next-token</text>

                                    <rect class="depth-box depth-box-muted" x="255" y="78" width="130" height="34" rx="10"></rect>
                                    <text x="320" y="99" text-anchor="middle">Masked LM</text>

                                    <line class="depth-arrow" x1="100" y1="56" x2="100" y2="78" marker-end="url(#depth-arrow-2)"></line>
                                    <line class="depth-arrow" x1="320" y1="56" x2="320" y2="78" marker-end="url(#depth-arrow-2)"></line>
                                </svg>
                                <p class="depth-visual-note">Decoder-only uses causal masks for next-token prediction; encoder-only sees both directions with masked tokens.</p>
                            </div>
                            <div class="depth-grid">
                                <article class="depth-card">
                                    <h4>Decoder-only transformers (GPT-style)</h4>
                                    <div class="depth-card-body">
                                        <div class="depth-mini">
                                            <svg viewBox="0 0 160 90" role="img" aria-label="Causal mask blocks attention to future tokens">
                                                <defs>
                                                    <marker id="depth-mini-arrow-2a" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                                        <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                                    </marker>
                                                </defs>
                                                <rect class="depth-cell" x="10" y="18" width="12" height="12"></rect>
                                                <rect class="depth-cell depth-cell--masked" x="26" y="18" width="12" height="12"></rect>
                                                <rect class="depth-cell depth-cell--masked" x="42" y="18" width="12" height="12"></rect>
                                                <rect class="depth-cell depth-cell--masked" x="58" y="18" width="12" height="12"></rect>

                                                <rect class="depth-cell" x="10" y="34" width="12" height="12"></rect>
                                                <rect class="depth-cell" x="26" y="34" width="12" height="12"></rect>
                                                <rect class="depth-cell depth-cell--masked" x="42" y="34" width="12" height="12"></rect>
                                                <rect class="depth-cell depth-cell--masked" x="58" y="34" width="12" height="12"></rect>

                                                <rect class="depth-cell" x="10" y="50" width="12" height="12"></rect>
                                                <rect class="depth-cell" x="26" y="50" width="12" height="12"></rect>
                                                <rect class="depth-cell" x="42" y="50" width="12" height="12"></rect>
                                                <rect class="depth-cell depth-cell--masked" x="58" y="50" width="12" height="12"></rect>

                                                <rect class="depth-cell" x="10" y="66" width="12" height="12"></rect>
                                                <rect class="depth-cell" x="26" y="66" width="12" height="12"></rect>
                                                <rect class="depth-cell" x="42" y="66" width="12" height="12"></rect>
                                                <rect class="depth-cell" x="58" y="66" width="12" height="12"></rect>

                                                <text x="110" y="36" text-anchor="middle">Causal</text>
                                                <text x="110" y="50" text-anchor="middle">mask</text>
                                                <line class="depth-arrow" x1="70" y1="46" x2="96" y2="46" marker-end="url(#depth-mini-arrow-2a)"></line>
                                            </svg>
                                        </div>
                                        <div class="depth-copy">
                                            <p>A causal mask blocks attention to future tokens, so each position can only use past context.</p>
                                            <p>Training uses teacher forcing: the model sees true previous tokens while learning to predict the next one.</p>
                                        </div>
                                    </div>
                                </article>
                                <article class="depth-card">
                                    <h4>Encoder-only transformers (BERT-style)</h4>
                                    <div class="depth-card-body">
                                        <div class="depth-mini">
                                            <svg viewBox="0 0 160 90" role="img" aria-label="Masked token uses bidirectional context">
                                                <defs>
                                                    <marker id="depth-mini-arrow-2b" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                                        <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                                    </marker>
                                                </defs>
                                                <rect class="depth-box" x="10" y="30" width="24" height="18" rx="4"></rect>
                                                <rect class="depth-box depth-box-muted" x="38" y="30" width="32" height="18" rx="4"></rect>
                                                <rect class="depth-box" x="74" y="30" width="24" height="18" rx="4"></rect>
                                                <rect class="depth-box" x="102" y="30" width="24" height="18" rx="4"></rect>
                                                <text x="22" y="42" text-anchor="middle">t1</text>
                                                <text x="54" y="42" text-anchor="middle">MASK</text>
                                                <text x="86" y="42" text-anchor="middle">t3</text>
                                                <text x="114" y="42" text-anchor="middle">t4</text>

                                                <line class="depth-arrow" x1="12" y1="56" x2="128" y2="56" marker-end="url(#depth-mini-arrow-2b)"></line>
                                                <line class="depth-arrow" x1="128" y1="22" x2="12" y2="22" marker-end="url(#depth-mini-arrow-2b)"></line>
                                                <text x="70" y="18" text-anchor="middle">Bidirectional</text>
                                            </svg>
                                        </div>
                                        <div class="depth-copy">
                                            <p>Masked language modeling hides tokens and uses both left and right context to reconstruct them.</p>
                                            <p>The result is a strong bidirectional representation that transfers well to classification and retrieval tasks.</p>
                                        </div>
                                    </div>
                                </article>
                                <article class="depth-card">
                                    <h4>Training + inference basics</h4>
                                    <div class="depth-card-body">
                                        <div class="depth-mini">
                                            <svg viewBox="0 0 160 90" role="img" aria-label="Softmax turns logits into probabilities for decoding">
                                                <defs>
                                                    <marker id="depth-mini-arrow-2c" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                                        <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                                    </marker>
                                                </defs>
                                                <rect class="depth-chip" x="10" y="46" width="8" height="18" rx="2"></rect>
                                                <rect class="depth-chip" x="24" y="38" width="8" height="26" rx="2"></rect>
                                                <rect class="depth-chip" x="38" y="52" width="8" height="12" rx="2"></rect>
                                                <text x="28" y="74" text-anchor="middle">logits</text>

                                                <rect class="depth-box" x="60" y="34" width="38" height="20" rx="5"></rect>
                                                <text x="79" y="47" text-anchor="middle">Softmax</text>
                                                <line class="depth-arrow" x1="46" y1="48" x2="60" y2="44" marker-end="url(#depth-mini-arrow-2c)"></line>

                                                <rect class="depth-box" x="110" y="20" width="36" height="16" rx="4"></rect>
                                                <rect class="depth-box" x="110" y="52" width="36" height="16" rx="4"></rect>
                                                <text x="128" y="32" text-anchor="middle">Greedy</text>
                                                <text x="128" y="64" text-anchor="middle">Sample</text>
                                                <line class="depth-arrow" x1="98" y1="44" x2="110" y2="28" marker-end="url(#depth-mini-arrow-2c)"></line>
                                                <line class="depth-arrow" x1="98" y1="44" x2="110" y2="60" marker-end="url(#depth-mini-arrow-2c)"></line>
                                            </svg>
                                        </div>
                                        <div class="depth-copy">
                                            <p>Logits become probabilities via softmax, then decoding picks the next token.</p>
                                            <p>Greedy decoding is stable, while temperature and top-p sampling trade determinism for diversity.</p>
                                        </div>
                                    </div>
                                </article>
                            </div>
                        </div>
                    </div>

                    <div class="depth-tier" style="--depth-accent: var(--accent-3);">
                        <div class="depth-marker">
                            <span class="depth-badge">Depth 3</span>
                            <h3>Reasoning with transformers</h3>
                            <p>Prompting and tool-use strategies.</p>
                        </div>
                        <div class="depth-content">
                            <div class="depth-visual">
                                <svg class="depth-diagram depth-diagram--reasoning" viewBox="0 0 420 140" role="img" aria-label="Reasoning techniques: chain of thought, self consistency, and ReAct">
                                    <defs>
                                        <marker id="depth-arrow-3" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                            <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                        </marker>
                                    </defs>
                                    <rect class="depth-box" x="20" y="24" width="110" height="80" rx="14"></rect>
                                    <rect class="depth-chip" x="32" y="44" width="18" height="14" rx="4"></rect>
                                    <rect class="depth-chip" x="58" y="44" width="18" height="14" rx="4"></rect>
                                    <rect class="depth-chip" x="84" y="44" width="18" height="14" rx="4"></rect>
                                    <line class="depth-arrow" x1="50" y1="51" x2="58" y2="51" marker-end="url(#depth-arrow-3)"></line>
                                    <line class="depth-arrow" x1="76" y1="51" x2="84" y2="51" marker-end="url(#depth-arrow-3)"></line>
                                    <text x="75" y="98" text-anchor="middle">CoT</text>

                                    <rect class="depth-box" x="155" y="24" width="110" height="80" rx="14"></rect>
                                    <circle class="depth-node" cx="210" cy="40" r="6"></circle>
                                    <circle class="depth-node" cx="185" cy="68" r="5"></circle>
                                    <circle class="depth-node" cx="210" cy="68" r="5"></circle>
                                    <circle class="depth-node" cx="235" cy="68" r="5"></circle>
                                    <line class="depth-soft" x1="210" y1="46" x2="185" y2="63"></line>
                                    <line class="depth-soft" x1="210" y1="46" x2="210" y2="62"></line>
                                    <line class="depth-soft" x1="210" y1="46" x2="235" y2="63"></line>
                                    <rect class="depth-chip" x="186" y="80" width="48" height="14" rx="4"></rect>
                                    <text x="210" y="98" text-anchor="middle">Vote</text>
                                    <text x="210" y="22" text-anchor="middle">Self-consistency</text>

                                    <rect class="depth-box" x="290" y="24" width="110" height="80" rx="14"></rect>
                                    <rect class="depth-chip" x="302" y="38" width="40" height="18" rx="4"></rect>
                                    <rect class="depth-chip" x="348" y="62" width="40" height="18" rx="4"></rect>
                                    <text x="322" y="51" text-anchor="middle">LLM</text>
                                    <text x="368" y="75" text-anchor="middle">Tool</text>
                                    <line class="depth-arrow" x1="342" y1="47" x2="348" y2="62" marker-end="url(#depth-arrow-3)"></line>
                                    <line class="depth-arrow" x1="352" y1="80" x2="334" y2="58" marker-end="url(#depth-arrow-3)"></line>
                                    <text x="345" y="98" text-anchor="middle">ReAct</text>
                                </svg>
                                <p class="depth-visual-note">CoT adds intermediate steps, self-consistency samples many paths, ReAct loops the model with tools.</p>
                            </div>
                            <div class="depth-grid">
                                <article class="depth-card">
                                    <h4>Chain-of-Thought (CoT)</h4>
                                    <div class="depth-card-body">
                                        <div class="depth-mini">
                                            <svg viewBox="0 0 160 90" role="img" aria-label="Chain of thought steps leading to an answer">
                                                <defs>
                                                    <marker id="depth-mini-arrow-3a" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                                        <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                                    </marker>
                                                </defs>
                                                <rect class="depth-box" x="10" y="36" width="30" height="18" rx="4"></rect>
                                                <rect class="depth-box" x="52" y="36" width="30" height="18" rx="4"></rect>
                                                <rect class="depth-box" x="94" y="36" width="30" height="18" rx="4"></rect>
                                                <rect class="depth-box" x="128" y="36" width="22" height="18" rx="4"></rect>
                                                <text x="25" y="48" text-anchor="middle">Step 1</text>
                                                <text x="67" y="48" text-anchor="middle">Step 2</text>
                                                <text x="109" y="48" text-anchor="middle">Step 3</text>
                                                <text x="139" y="48" text-anchor="middle">Ans</text>

                                                <line class="depth-arrow" x1="40" y1="45" x2="52" y2="45" marker-end="url(#depth-mini-arrow-3a)"></line>
                                                <line class="depth-arrow" x1="82" y1="45" x2="94" y2="45" marker-end="url(#depth-mini-arrow-3a)"></line>
                                                <line class="depth-arrow" x1="124" y1="45" x2="128" y2="45" marker-end="url(#depth-mini-arrow-3a)"></line>
                                            </svg>
                                        </div>
                                        <div class="depth-copy">
                                            <p>CoT encourages explicit intermediate steps, which can improve multi-step reasoning tasks.</p>
                                            <p>Use it when the reasoning path matters, but keep in mind verbosity does not guarantee correctness.</p>
                                        </div>
                                    </div>
                                </article>
                                <article class="depth-card">
                                    <h4>Self-consistency</h4>
                                    <div class="depth-card-body">
                                        <div class="depth-mini">
                                            <svg viewBox="0 0 160 90" role="img" aria-label="Multiple reasoning paths converge to a majority vote">
                                                <defs>
                                                    <marker id="depth-mini-arrow-3b" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                                        <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                                    </marker>
                                                </defs>
                                                <circle class="depth-node" cx="20" cy="20" r="5"></circle>
                                                <circle class="depth-node" cx="20" cy="45" r="5"></circle>
                                                <circle class="depth-node" cx="20" cy="70" r="5"></circle>
                                                <circle class="depth-node" cx="90" cy="45" r="7"></circle>
                                                <rect class="depth-box" x="110" y="36" width="36" height="18" rx="4"></rect>
                                                <text x="128" y="48" text-anchor="middle">Vote</text>

                                                <line class="depth-arrow" x1="26" y1="20" x2="82" y2="40" marker-end="url(#depth-mini-arrow-3b)"></line>
                                                <line class="depth-arrow" x1="26" y1="45" x2="82" y2="45" marker-end="url(#depth-mini-arrow-3b)"></line>
                                                <line class="depth-arrow" x1="26" y1="70" x2="82" y2="50" marker-end="url(#depth-mini-arrow-3b)"></line>
                                                <line class="depth-arrow" x1="98" y1="45" x2="110" y2="45" marker-end="url(#depth-mini-arrow-3b)"></line>
                                            </svg>
                                        </div>
                                        <div class="depth-copy">
                                            <p>Self-consistency samples multiple reasoning paths and aggregates the final answers.</p>
                                            <p>Majority voting reduces variance and often improves accuracy on reasoning benchmarks.</p>
                                        </div>
                                    </div>
                                </article>
                                <article class="depth-card">
                                    <h4>ReAct (reason + act)</h4>
                                    <div class="depth-card-body">
                                        <div class="depth-mini">
                                            <svg viewBox="0 0 160 90" role="img" aria-label="Model alternates between reasoning and tool calls">
                                                <defs>
                                                    <marker id="depth-mini-arrow-3c" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                                        <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                                    </marker>
                                                </defs>
                                                <rect class="depth-box" x="22" y="32" width="42" height="20" rx="5"></rect>
                                                <rect class="depth-box" x="94" y="32" width="42" height="20" rx="5"></rect>
                                                <text x="43" y="45" text-anchor="middle">LLM</text>
                                                <text x="115" y="45" text-anchor="middle">Tool</text>
                                                <line class="depth-arrow" x1="64" y1="42" x2="94" y2="42" marker-end="url(#depth-mini-arrow-3c)"></line>
                                                <line class="depth-arrow" x1="94" y1="54" x2="64" y2="54" marker-end="url(#depth-mini-arrow-3c)"></line>
                                                <text x="79" y="72" text-anchor="middle">loop</text>
                                            </svg>
                                        </div>
                                        <div class="depth-copy">
                                            <p>ReAct alternates reasoning steps with tool calls, grounding answers in external data.</p>
                                            <p>The loop keeps the model honest by injecting retrieved facts before the final response.</p>
                                        </div>
                                    </div>
                                </article>
                            </div>
                        </div>
                    </div>

                    <div class="depth-tier" style="--depth-accent: var(--accent-4);">
                        <div class="depth-marker">
                            <span class="depth-badge">Depth 4</span>
                            <h3>Reasoning models today</h3>
                            <p>Training signals and test-time search.</p>
                        </div>
                        <div class="depth-content">
                            <div class="depth-visual">
                                <svg class="depth-diagram depth-diagram--reasoning-models" viewBox="0 0 420 150" role="img" aria-label="Process supervision and tree search combine to shape reasoning behavior">
                                    <defs>
                                        <marker id="depth-arrow-4" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                            <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                        </marker>
                                    </defs>
                                    <text x="90" y="20" text-anchor="middle">Process supervision</text>
                                    <rect class="depth-chip" x="30" y="32" width="70" height="16" rx="4"></rect>
                                    <rect class="depth-chip" x="30" y="54" width="70" height="16" rx="4"></rect>
                                    <rect class="depth-chip" x="30" y="76" width="70" height="16" rx="4"></rect>
                                    <path class="depth-check" d="M36 40 L40 44 L48 34"></path>
                                    <path class="depth-check" d="M36 62 L40 66 L48 56"></path>
                                    <path class="depth-check" d="M36 84 L40 88 L48 78"></path>

                                    <text x="320" y="20" text-anchor="middle">Test-time search</text>
                                    <circle class="depth-node" cx="320" cy="38" r="6"></circle>
                                    <circle class="depth-node" cx="290" cy="68" r="5"></circle>
                                    <circle class="depth-node" cx="350" cy="68" r="5"></circle>
                                    <circle class="depth-node" cx="270" cy="98" r="4"></circle>
                                    <circle class="depth-node" cx="310" cy="98" r="4"></circle>
                                    <circle class="depth-node" cx="330" cy="98" r="4"></circle>
                                    <circle class="depth-node" cx="370" cy="98" r="4"></circle>
                                    <line class="depth-soft" x1="320" y1="44" x2="290" y2="63"></line>
                                    <line class="depth-soft" x1="320" y1="44" x2="350" y2="63"></line>
                                    <line class="depth-soft" x1="290" y1="73" x2="270" y2="93"></line>
                                    <line class="depth-soft" x1="290" y1="73" x2="310" y2="93"></line>
                                    <line class="depth-soft" x1="350" y1="73" x2="330" y2="93"></line>
                                    <line class="depth-soft" x1="350" y1="73" x2="370" y2="93"></line>

                                    <rect class="depth-box" x="140" y="112" width="140" height="28" rx="10"></rect>
                                    <text x="210" y="130" text-anchor="middle">Reasoning behavior</text>

                                    <line class="depth-arrow" x1="100" y1="84" x2="150" y2="112" marker-end="url(#depth-arrow-4)"></line>
                                    <line class="depth-arrow" x1="320" y1="104" x2="270" y2="112" marker-end="url(#depth-arrow-4)"></line>
                                </svg>
                                <p class="depth-visual-note">Step-level feedback and search trees both add compute that shapes reasoning at test time.</p>
                            </div>
                            <div class="depth-grid">
                                <article class="depth-card">
                                    <h4>Process vs outcome supervision</h4>
                                    <div class="depth-card-body">
                                        <div class="depth-mini">
                                            <svg viewBox="0 0 160 90" role="img" aria-label="Step-level checks flow into a reward signal">
                                                <defs>
                                                    <marker id="depth-mini-arrow-4a" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                                        <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                                    </marker>
                                                </defs>
                                                <rect class="depth-box" x="10" y="14" width="36" height="16" rx="4"></rect>
                                                <rect class="depth-box" x="10" y="36" width="36" height="16" rx="4"></rect>
                                                <rect class="depth-box" x="10" y="58" width="36" height="16" rx="4"></rect>
                                                <path class="depth-check" d="M16 22 L20 26 L26 18"></path>
                                                <path class="depth-check" d="M16 44 L20 48 L26 40"></path>
                                                <path class="depth-check" d="M16 66 L20 70 L26 62"></path>

                                                <rect class="depth-box" x="86" y="36" width="50" height="20" rx="5"></rect>
                                                <text x="111" y="49" text-anchor="middle">Reward</text>
                                                <line class="depth-arrow" x1="46" y1="44" x2="86" y2="44" marker-end="url(#depth-mini-arrow-4a)"></line>
                                            </svg>
                                        </div>
                                        <div class="depth-copy">
                                            <p>Process supervision scores intermediate steps, not just the final answer.</p>
                                            <p>Step-level signals make credit assignment clearer and improve reasoning stability.</p>
                                        </div>
                                    </div>
                                </article>
                                <article class="depth-card">
                                    <h4>Tree-of-Thoughts (ToT)</h4>
                                    <div class="depth-card-body">
                                        <div class="depth-mini">
                                            <svg viewBox="0 0 160 90" role="img" aria-label="Search tree expands and selects promising branches">
                                                <defs>
                                                    <marker id="depth-mini-arrow-4b" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                                        <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                                    </marker>
                                                </defs>
                                                <circle class="depth-node" cx="28" cy="18" r="5"></circle>
                                                <circle class="depth-node" cx="14" cy="46" r="4"></circle>
                                                <circle class="depth-node" cx="42" cy="46" r="4"></circle>
                                                <circle class="depth-node" cx="6" cy="70" r="3"></circle>
                                                <circle class="depth-node" cx="22" cy="70" r="3"></circle>
                                                <circle class="depth-node" cx="38" cy="70" r="3"></circle>
                                                <circle class="depth-node" cx="54" cy="70" r="3"></circle>
                                                <line class="depth-soft" x1="28" y1="22" x2="14" y2="42"></line>
                                                <line class="depth-soft" x1="28" y1="22" x2="42" y2="42"></line>
                                                <line class="depth-soft" x1="14" y1="50" x2="6" y2="66"></line>
                                                <line class="depth-soft" x1="14" y1="50" x2="22" y2="66"></line>
                                                <line class="depth-soft" x1="42" y1="50" x2="38" y2="66"></line>
                                                <line class="depth-soft" x1="42" y1="50" x2="54" y2="66"></line>

                                                <rect class="depth-box" x="86" y="32" width="52" height="20" rx="5"></rect>
                                                <text x="112" y="45" text-anchor="middle">Score</text>
                                                <line class="depth-arrow" x1="60" y1="46" x2="86" y2="42" marker-end="url(#depth-mini-arrow-4b)"></line>
                                            </svg>
                                        </div>
                                        <div class="depth-copy">
                                            <p>Tree-of-Thoughts explores multiple branches, scores them, and expands the best candidates.</p>
                                            <p>Search with backtracking can outperform a single forward pass on hard problems.</p>
                                        </div>
                                    </div>
                                </article>
                                <article class="depth-card">
                                    <h4>What "reasoning model" means today</h4>
                                    <div class="depth-card-body">
                                        <div class="depth-mini">
                                            <svg viewBox="0 0 160 90" role="img" aria-label="Reasoning emerges from prompting, search, and supervision">
                                                <defs>
                                                    <marker id="depth-mini-arrow-4c" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
                                                        <polygon class="depth-arrowhead" points="0 0, 8 4, 0 8"></polygon>
                                                    </marker>
                                                </defs>
                                                <circle class="depth-node" cx="22" cy="22" r="6"></circle>
                                                <circle class="depth-node" cx="78" cy="14" r="6"></circle>
                                                <circle class="depth-node" cx="50" cy="60" r="6"></circle>
                                                <text x="22" y="40" text-anchor="middle">Prompt</text>
                                                <text x="78" y="32" text-anchor="middle">Search</text>
                                                <text x="50" y="78" text-anchor="middle">Supervise</text>

                                                <rect class="depth-box" x="98" y="34" width="50" height="20" rx="5"></rect>
                                                <text x="123" y="47" text-anchor="middle">Behavior</text>

                                                <line class="depth-arrow" x1="28" y1="24" x2="98" y2="40" marker-end="url(#depth-mini-arrow-4c)"></line>
                                                <line class="depth-arrow" x1="78" y1="20" x2="98" y2="40" marker-end="url(#depth-mini-arrow-4c)"></line>
                                                <line class="depth-arrow" x1="50" y1="54" x2="98" y2="48" marker-end="url(#depth-mini-arrow-4c)"></line>
                                            </svg>
                                        </div>
                                        <div class="depth-copy">
                                            <p>Modern reasoning blends prompting patterns, test-time search, and step-aware supervision.</p>
                                            <p>The behavior you see is shaped by where extra compute or feedback is injected.</p>
                                        </div>
                                    </div>
                                </article>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Prompt Engineering Section -->
            <section id="prompt-engineering" class="example-section">
                <h2>Prompt Engineering: Crafting Clear Instructions</h2>
                <p class="section-intro">Design prompts that reduce ambiguity, keep responses grounded, and make iteration fast.</p>
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Prompt anatomy</h3>
                        <ul class="concept-bullets">
                            <li><strong>Role</strong>: who the model is acting as.</li>
                            <li><strong>Goal</strong>: the task and the success criteria.</li>
                            <li><strong>Context</strong>: background data, definitions, and scope.</li>
                            <li><strong>Constraints</strong>: length, tone, must include, must avoid.</li>
                            <li><strong>Output format</strong>: schema, bullets, JSON, table.</li>
                            <li><strong>Checks</strong>: ask for missing info or confidence notes.</li>
                        </ul>
                        <div class="mini-mission">Mini mission: rewrite a vague request into a 6-part prompt.</div>
                        <div class="guide-stack">
                            <article class="guide-card">
                                <h4>Pattern: Delimiters + grounding</h4>
                                <p>Use clear separators so the model knows what to quote, summarize, or transform.</p>
                            </article>
                            <article class="guide-card">
                                <h4>Pattern: Few-shot exemplars</h4>
                                <p>Add one or two examples that match the output style you want.</p>
                            </article>
                            <article class="guide-card">
                                <h4>Pattern: Self-checks</h4>
                                <p>Ask for a brief verification step or uncertainties before the final answer.</p>
                            </article>
                        </div>
                    </div>
                    <div class="visualization card-column">
                        <div class="prompt-template">
                            <h4>Prompt template</h4>
                            <pre>ROLE: You are a product analyst.
TASK: Summarize customer feedback into 3 themes.
CONTEXT:
"""
Paste notes here.
"""
CONSTRAINTS: Max 8 bullets. No speculation.
OUTPUT FORMAT:
- Theme:
- Evidence:
CHECKS: Flag missing data.</pre>
                        </div>
                        <div class="prompt-template">
                            <h4>Prompt technique examples</h4>
                            <pre>Technique: Role + constraints
ROLE: You are a support analyst.
TASK: Summarize the ticket in 3 bullets.
CONSTRAINTS: Neutral tone. No jargon.

Technique: Few-shot style match
TASK: Turn notes into a decision line.
EXAMPLE:
Input: "Latency 120ms, budget ok"
Output: "Decision: proceed with rollout"

Technique: Delimiters + extraction
Extract action items from &lt;notes&gt;...&lt;/notes&gt;.
Return JSON with owner, task, and due.</pre>
                        </div>
                        <div class="prompt-template">
                            <h4>Prompt refinement loop</h4>
                            <ol class="step-list">
                                <li>Draft the instruction and the output format.</li>
                                <li>Test with a real example and inspect the gaps.</li>
                                <li>Add constraints, examples, or definitions.</li>
                                <li>Repeat until outputs are stable and on-brand.</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </section>

            <!-- LLM Fundamentals Section -->
            <section id="llm-fundamentals" class="example-section">
                <h2>LLM Fundamentals: How Models Respond</h2>
                <p class="section-intro">Know the mechanics behind next-token prediction so your prompts behave consistently.</p>
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Core behaviors</h3>
                        <ul class="concept-bullets">
                            <li>LLMs predict the next token based on all prior context.</li>
                            <li>Context windows limit how much text the model can see at once.</li>
                            <li>Sampling settings trade off creativity vs stability.</li>
                            <li>System instructions set global rules; user prompts set tasks.</li>
                            <li>Hallucinations appear when the prompt is underspecified.</li>
                        </ul>
                        <div class="info-grid">
                            <div class="info-card">
                                <h5>Temperature</h5>
                                <p>Controls randomness; lower is more deterministic.</p>
                            </div>
                            <div class="info-card">
                                <h5>Top-p</h5>
                                <p>Limits choices to a probability mass.</p>
                            </div>
                            <div class="info-card">
                                <h5>Max tokens</h5>
                                <p>Budget for output length and cost.</p>
                            </div>
                            <div class="info-card">
                                <h5>Stop sequences</h5>
                                <p>End outputs at safe boundaries.</p>
                            </div>
                        </div>
                    </div>
                    <div class="visualization card-column">
                        <div class="guide-stack">
                            <article class="guide-card">
                                <h4>Prompting best practices</h4>
                                <p>See the full playbook at <a class="text-link" href="https://www.promptingguide.ai" target="_blank" rel="noopener">promptingguide.ai</a>.</p>
                                <ul class="concept-bullets">
                                    <li>Be explicit about the role, task, and constraints.</li>
                                    <li>Use delimiters to separate instructions from data.</li>
                                    <li>Provide a target format and a short example.</li>
                                    <li>Ask for assumptions, risks, or missing data.</li>
                                    <li>Iterate with real inputs, not toy prompts.</li>
                                </ul>
                            </article>
                            <article class="guide-card">
                                <h4>Context hygiene</h4>
                                <ul class="concept-bullets">
                                    <li>Keep only relevant context; remove stale instructions.</li>
                                    <li>Define terms once and reuse them consistently.</li>
                                    <li>Chunk long inputs and summarize key decisions.</li>
                                </ul>
                            </article>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Vector Databases Section -->
            <section id="vector-databases" class="example-section">
                <h2>Vector Databases: Indexing and Retrieval for LLMs</h2>
                <p class="section-intro">See how embeddings get indexed, how similarity search works, and how results return to the model.</p>
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Indexing views</h3>
                        <div class="toggle-group vector-db-tabs" role="tablist" aria-label="Vector database views">
                            <button class="toggle-btn is-active" type="button" role="tab" aria-selected="true" aria-controls="vector-db-pipeline" data-vector-db-mode="pipeline">Indexing pipeline</button>
                            <button class="toggle-btn" type="button" role="tab" aria-selected="false" aria-controls="vector-db-hnsw" data-vector-db-mode="hnsw">HNSW graph</button>
                            <button class="toggle-btn" type="button" role="tab" aria-selected="false" aria-controls="vector-db-ivf-pq" data-vector-db-mode="ivf-pq">IVF + PQ</button>
                            <button class="toggle-btn" type="button" role="tab" aria-selected="false" aria-controls="vector-db-retrieval" data-vector-db-mode="retrieval">Search + retrieval</button>
                        </div>
                        <div class="vector-db-panels">
                            <div class="vector-db-panel is-active" id="vector-db-pipeline" data-vector-db-mode="pipeline" role="tabpanel">
                                <h4>Indexing pipeline</h4>
                                <p>Chunk documents, embed each chunk, and store vectors with metadata for filtering.</p>
                                <ul class="step-points">
                                    <li>Split docs into overlapping chunks.</li>
                                    <li>Embed each chunk into a vector space.</li>
                                    <li>Write vectors and metadata to the index.</li>
                                </ul>
                                <div class="info-grid">
                                    <div class="info-card">
                                        <h5>Metadata filters</h5>
                                        <p>Tags, permissions, and timestamps narrow search.</p>
                                    </div>
                                    <div class="info-card">
                                        <h5>Chunk size</h5>
                                        <p>Balances recall with context length.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="vector-db-panel" id="vector-db-hnsw" data-vector-db-mode="hnsw" role="tabpanel">
                                <h4>ANN indexing with HNSW</h4>
                                <p>Hierarchical graph layers speed up nearest-neighbor search with high recall.</p>
                                <ul class="step-points">
                                    <li>Insert vectors into a multi-layer graph.</li>
                                    <li>Connect each node to its closest neighbors.</li>
                                    <li>Search from top layer to dense base layer.</li>
                                </ul>
                                <div class="info-grid">
                                    <div class="info-card">
                                        <h5>M parameter</h5>
                                        <p>Controls graph connectivity and recall.</p>
                                    </div>
                                    <div class="info-card">
                                        <h5>efSearch</h5>
                                        <p>Higher values improve recall at a latency cost.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="vector-db-panel" id="vector-db-ivf-pq" data-vector-db-mode="ivf-pq" role="tabpanel">
                                <h4>IVF + PQ compression</h4>
                                <p>Inverted file indexing narrows search to the closest centroids, then product quantization compresses vectors for fast distance estimates.</p>
                                <ul class="step-points">
                                    <li>Assign vectors to coarse centroids (IVF).</li>
                                    <li>Search only the nearest lists.</li>
                                    <li>Quantize subvectors into compact PQ codes.</li>
                                </ul>
                                <div class="info-grid">
                                    <div class="info-card">
                                        <h5>nlist</h5>
                                        <p>Number of coarse clusters to search.</p>
                                    </div>
                                    <div class="info-card">
                                        <h5>m * bits</h5>
                                        <p>Subvector count and code size per block.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="vector-db-panel" id="vector-db-retrieval" data-vector-db-mode="retrieval" role="tabpanel">
                                <h4>Search and retrieval for LLMs</h4>
                                <p>Blend lexical and vector results, then rerank and pack the best chunks into context.</p>
                                <ul class="step-points">
                                    <li>Embed the query and run ANN search.</li>
                                    <li>Merge lexical and vector candidates.</li>
                                    <li>Rerank and assemble a grounded context window.</li>
                                </ul>
                                <div class="info-grid">
                                    <div class="info-card">
                                        <h5>Reranking</h5>
                                        <p>Cross-encoders boost precision on top results.</p>
                                    </div>
                                    <div class="info-card">
                                        <h5>Citations</h5>
                                        <p>Keep track of sources for trust and audits.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mini-mission">Mini mission: trace where the top-k chunks enter the prompt.</div>
                    </div>
                    <div class="visualization">
                        <canvas id="vectorDbCanvas" width="420" height="320"></canvas>
                        <div class="controls vector-db-controls">
                            <button type="button" id="vectorDbNext">Next view</button>
                            <p class="helper-text">Switch tabs or cycle the diagram.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="sutskever-list" class="example-section">
                <h2>Sutskever's List: Core Readings</h2>
                <p class="section-intro">A curated reading list with the main themes and ideas captured for quick scanning.</p>
                <div class="reading-grid">
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Transformers</span>
                            <span class="reading-year">Year: 2017</span>
                        </div>
                        <h3><a href="https://github.com/harvardnlp/annotated-transformer" target="_blank" rel="noopener noreferrer">The Annotated Transformer</a></h3>
                        <p class="reading-summary">Annotated walkthrough of the Transformer model that uses self-attention for sequence tasks.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Attention-based encoder-decoder design.</li>
                            <li><strong>Main idea</strong>: Line-by-line implementation clarifies attention, masking, and positional encoding.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Theory</span>
                            <span class="reading-year">Year: n/a</span>
                        </div>
                        <h3><a href="https://scottaaronson.blog/?p=3718" target="_blank" rel="noopener noreferrer">The First Law of Complexodynamics</a></h3>
                        <p class="reading-summary">Blog essay connecting complexity, computation, and principles relevant to AI foundations.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Complexity growth in closed systems.</li>
                            <li><strong>Main idea</strong>: Links entropy, computation, and limits of organized structure.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Sequence Models</span>
                            <span class="reading-year">Year: n/a</span>
                        </div>
                        <h3><a href="https://karpathy.github.io/2015/05/21/rnn-effectiveness/" target="_blank" rel="noopener noreferrer">The Unreasonable Effectiveness of Recurrent Neural Networks</a></h3>
                        <p class="reading-summary">Karpathy's blog showing why RNNs are powerful for sequence tasks with intuitive examples.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Sequence modeling with RNNs.</li>
                            <li><strong>Main idea</strong>: Character-level RNNs learn structure and generate coherent sequences.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Sequence Models</span>
                            <span class="reading-year">Year: n/a</span>
                        </div>
                        <h3><a href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/" target="_blank" rel="noopener noreferrer">Understanding LSTM Networks</a></h3>
                        <p class="reading-summary">Christopher Olah's visual and intuitive explanation of LSTM mechanisms and gates.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Gating and long-term memory.</li>
                            <li><strong>Main idea</strong>: Input/forget/output gates control information flow and gradients.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Sequence Models</span>
                            <span class="reading-year">Year: 2014</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/1409.2329" target="_blank" rel="noopener noreferrer">Recurrent Neural Network Regularization</a></h3>
                        <p class="reading-summary">Shows how regularization like dropout improves recurrent architectures.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Regularization for recurrent nets.</li>
                            <li><strong>Main idea</strong>: Dropout-style methods improve generalization without breaking sequence learning.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Theory</span>
                            <span class="reading-year">Year: n/a</span>
                        </div>
                        <h3><a href="https://www.cs.toronto.edu/~hinton/absps/desc.pdf" target="_blank" rel="noopener noreferrer">Keeping Neural Networks Simple by Minimizing the Description Length of the Weights</a></h3>
                        <p class="reading-summary">Explores regularization and model simplicity through information theory principles.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Minimum description length (MDL).</li>
                            <li><strong>Main idea</strong>: Penalizing complexity encourages simpler, better-generalizing models.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Sequence Models</span>
                            <span class="reading-year">Year: 2015</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/1506.03134" target="_blank" rel="noopener noreferrer">Pointer Networks</a></h3>
                        <p class="reading-summary">Neural architecture for solving combinatorial problems by learning pointer outputs.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Attention as a pointer mechanism.</li>
                            <li><strong>Main idea</strong>: Output indices of input elements for variable-length solutions.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Vision</span>
                            <span class="reading-year">Year: 2012</span>
                        </div>
                        <h3><a href="https://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks" target="_blank" rel="noopener noreferrer">ImageNet Classification with Deep Convolutional Neural Networks</a></h3>
                        <p class="reading-summary">AlexNet paper that sparked the modern deep learning vision revolution.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Deep CNNs for large-scale vision.</li>
                            <li><strong>Main idea</strong>: ReLU, dropout, and GPU training drive major accuracy gains.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Sequence Models</span>
                            <span class="reading-year">Year: 2015</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/1511.06391" target="_blank" rel="noopener noreferrer">Order Matters: Sequence to Sequence for Sets</a></h3>
                        <p class="reading-summary">Explores how ordering impacts seq2seq model performance.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Set prediction with seq2seq.</li>
                            <li><strong>Main idea</strong>: Learning an output order improves performance on set tasks.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Systems</span>
                            <span class="reading-year">Year: 2018</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/1811.06965" target="_blank" rel="noopener noreferrer">GPipe: Easy Scaling with Micro-Batch Pipeline Parallelism</a></h3>
                        <p class="reading-summary">Describes pipeline parallelism for scaling large neural networks.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Model-parallel scaling.</li>
                            <li><strong>Main idea</strong>: Micro-batch pipeline parallelism trains very large networks efficiently.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Vision</span>
                            <span class="reading-year">Year: 2015</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/1512.03385" target="_blank" rel="noopener noreferrer">Deep Residual Learning for Image Recognition</a></h3>
                        <p class="reading-summary">ResNet paper that introduced residual connections to enable very deep models.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Residual learning.</li>
                            <li><strong>Main idea</strong>: Identity skip connections allow very deep CNNs to train.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Vision</span>
                            <span class="reading-year">Year: 2015</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/1511.07122" target="_blank" rel="noopener noreferrer">Multi-Scale Context Aggregation by Dilated Convolutions</a></h3>
                        <p class="reading-summary">Introduces dilated convolutions for large receptive fields without pooling.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Multi-scale context.</li>
                            <li><strong>Main idea</strong>: Dilated convolutions expand receptive fields while preserving resolution.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Graph Networks</span>
                            <span class="reading-year">Year: 2017</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/1704.01212" target="_blank" rel="noopener noreferrer">Neural Message Passing for Quantum Chemistry</a></h3>
                        <p class="reading-summary">Graph neural network model for learning on structured data.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Message-passing GNNs.</li>
                            <li><strong>Main idea</strong>: Iterative node updates capture molecular structure for property prediction.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Transformers</span>
                            <span class="reading-year">Year: 2017</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/1706.03762" target="_blank" rel="noopener noreferrer">Attention Is All You Need</a></h3>
                        <p class="reading-summary">Introduced the Transformer with self-attention, the foundation of modern NLP and LLMs.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Self-attention for sequence modeling.</li>
                            <li><strong>Main idea</strong>: Replace recurrence with attention for parallel training and long-range context.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Sequence Models</span>
                            <span class="reading-year">Year: 2014</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/1409.3215" target="_blank" rel="noopener noreferrer">Neural Machine Translation by Jointly Learning to Align and Translate</a></h3>
                        <p class="reading-summary">Shows how attention improves neural translation by aligning outputs with inputs.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Attention in seq2seq translation.</li>
                            <li><strong>Main idea</strong>: Alignment learns which source tokens to focus on for each output.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Vision</span>
                            <span class="reading-year">Year: 2016</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/1603.05027" target="_blank" rel="noopener noreferrer">Identity Mappings in Deep Residual Networks</a></h3>
                        <p class="reading-summary">Improves ResNet training using identity skip connections.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Optimization of deep residual networks.</li>
                            <li><strong>Main idea</strong>: Pre-activation and identity skips improve gradient flow.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Theory</span>
                            <span class="reading-year">Year: 2017</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/1706.01427" target="_blank" rel="noopener noreferrer">A Simple Neural Network Module for Relational Reasoning</a></h3>
                        <p class="reading-summary">Introduces a module for relational reasoning tasks.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Relational reasoning.</li>
                            <li><strong>Main idea</strong>: Explicit pairwise relations improve reasoning performance.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Generative Models</span>
                            <span class="reading-year">Year: 2015</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/1511.05644" target="_blank" rel="noopener noreferrer">Variational Lossy Autoencoder</a></h3>
                        <p class="reading-summary">Combines autoencoder with variational losses for generative modeling.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Lossy compression in generative models.</li>
                            <li><strong>Main idea</strong>: Balance reconstruction with latent codes that capture global structure.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Sequence Models</span>
                            <span class="reading-year">Year: 2018</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/1806.01822" target="_blank" rel="noopener noreferrer">Relational Recurrent Neural Networks</a></h3>
                        <p class="reading-summary">Combines relational reasoning with RNN mechanisms.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Memory + relational reasoning.</li>
                            <li><strong>Main idea</strong>: Memory slots interact through attention to improve sequence modeling.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Theory</span>
                            <span class="reading-year">Year: 2014</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/1407.5671" target="_blank" rel="noopener noreferrer">Quantifying the Rise and Fall of Complexity in Closed Systems: The Coffee Automaton</a></h3>
                        <p class="reading-summary">Examines complexity measures in closed computational systems.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Complexity dynamics.</li>
                            <li><strong>Main idea</strong>: Complexity can rise and fall as systems evolve over time.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Memory Networks</span>
                            <span class="reading-year">Year: 2014</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/1410.5401" target="_blank" rel="noopener noreferrer">Neural Turing Machines</a></h3>
                        <p class="reading-summary">Early memory-augmented neural network with external controller.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Differentiable external memory.</li>
                            <li><strong>Main idea</strong>: A controller learns to read and write memory for algorithmic tasks.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Speech</span>
                            <span class="reading-year">Year: 2015</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/1512.02595" target="_blank" rel="noopener noreferrer">Deep Speech 2: End-to-End Speech Recognition</a></h3>
                        <p class="reading-summary">End-to-end speech model demonstrating RNN and CNN integration.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: End-to-end speech recognition.</li>
                            <li><strong>Main idea</strong>: CNN + RNN stacks with CTC scale to large speech datasets.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Scaling</span>
                            <span class="reading-year">Year: 2020</span>
                        </div>
                        <h3><a href="https://arxiv.org/abs/2001.08361" target="_blank" rel="noopener noreferrer">Scaling Laws for Neural Language Models</a></h3>
                        <p class="reading-summary">Shows how model and data scaling improve language model performance.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Empirical scaling behavior.</li>
                            <li><strong>Main idea</strong>: Performance follows power laws in data, parameters, and compute.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Theory</span>
                            <span class="reading-year">Year: n/a</span>
                        </div>
                        <h3 class="reading-title">A Tutorial Introduction to the Minimum Description Length Principle</h3>
                        <p class="reading-summary">Introductory explanation of MDL principle connecting compression and learning.</p>
                        <p class="reading-link-note">Link unavailable.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Compression-based model selection.</li>
                            <li><strong>Main idea</strong>: Better compression implies better generalization.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Theory</span>
                            <span class="reading-year">Year: n/a</span>
                        </div>
                        <h3 class="reading-title">Machine Super Intelligence</h3>
                        <p class="reading-summary">Discusses theoretical aspects of AGI and intelligence measures.</p>
                        <p class="reading-link-note">Link unavailable.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Theoretical intelligence measures.</li>
                            <li><strong>Main idea</strong>: Frames limits and metrics for machine intelligence.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Theory</span>
                            <span class="reading-year">Year: n/a</span>
                        </div>
                        <h3 class="reading-title">Kolmogorov Complexity and Algorithmic Randomness</h3>
                        <p class="reading-summary">Foundations of algorithmic complexity and information theory.</p>
                        <p class="reading-link-note">Link unavailable.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Algorithmic information theory.</li>
                            <li><strong>Main idea</strong>: Randomness is defined by shortest program length.</li>
                        </ul>
                    </article>
                    <article class="reading-card">
                        <div class="reading-meta">
                            <span class="reading-category">Vision</span>
                            <span class="reading-year">Year: n/a</span>
                        </div>
                        <h3><a href="https://cs231n.github.io/" target="_blank" rel="noopener noreferrer">CS231n: Convolutional Neural Networks for Visual Recognition</a></h3>
                        <p class="reading-summary">Stanford course notes covering fundamentals of CNNs and vision models.</p>
                        <ul class="concept-bullets reading-bullets">
                            <li><strong>Theme</strong>: Practical CNN foundations.</li>
                            <li><strong>Main idea</strong>: Clear explanations of architectures, training, and regularization.</li>
                        </ul>
                    </article>
                </div>
            </section>

            <!-- AI Agents Section -->
            <section id="ai-agents" class="example-section">
                <h2>AI Agents: Tool-Using Systems</h2>
                <p class="section-intro">Agents combine planning, tools, memory, and evals to finish real tasks.</p>
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Agent loop</h3>
                        <ol class="step-list">
                            <li>Plan the task and choose a strategy.</li>
                            <li>Select tools and call them with structured inputs.</li>
                            <li>Observe results and update the plan.</li>
                            <li>Decide when to stop and respond.</li>
                        </ol>
                        <div class="step-grid">
                            <div class="step-card">
                                <h4>Planner</h4>
                                <p>Breaks the goal into steps and picks the next action.</p>
                            </div>
                            <div class="step-card">
                                <h4>Tool router</h4>
                                <p>Chooses APIs, search, or code execution based on the task.</p>
                            </div>
                            <div class="step-card">
                                <h4>Memory</h4>
                                <p>Stores notes, intermediate results, and long-term facts.</p>
                            </div>
                            <div class="step-card">
                                <h4>Critic</h4>
                                <p>Checks outputs, runs evals, and flags regressions.</p>
                            </div>
                        </div>
                        <h3>Tool calling basics</h3>
                        <ul class="concept-bullets">
                            <li>Define clear tool schemas with typed inputs and outputs.</li>
                            <li>Validate tool results and handle failures explicitly.</li>
                            <li>Constrain tool access with allowlists and budgets.</li>
                            <li>Log tool calls for tracing and debugging.</li>
                        </ul>
                    </div>
                    <div class="visualization card-column">
                        <div class="guide-stack">
                            <article class="guide-card">
                                <h4>How to write evals</h4>
                                <ol class="step-list">
                                    <li>Define a task set and success criteria.</li>
                                    <li>Collect examples with expected outputs.</li>
                                    <li>Use automatic checks plus human review when needed.</li>
                                    <li>Track regressions and edge cases over time.</li>
                                </ol>
                            </article>
                            <article class="guide-card">
                                <h4>Eval-driven development</h4>
                                <ol class="step-list">
                                    <li>Write evals before adding new agent logic.</li>
                                    <li>Run evals on every change to the prompt or tools.</li>
                                    <li>Promote only the changes that improve the score.</li>
                                    <li>Version datasets and prompts alongside code.</li>
                                </ol>
                            </article>
                        </div>
                        <div class="info-grid">
                            <div class="info-card">
                                <h5>Frameworks</h5>
                                <p>LangChain, LlamaIndex, and OpenAI or Anthropic SDKs.</p>
                            </div>
                            <div class="info-card">
                                <h5>Tracing</h5>
                                <p>Capture tool calls, prompts, and outputs for audits.</p>
                            </div>
                            <div class="info-card">
                                <h5>Evals</h5>
                                <p>Use unit tests, golden sets, and regression suites.</p>
                            </div>
                            <div class="info-card">
                                <h5>Safety</h5>
                                <p>Guardrails for tool use, data access, and output policy.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </section>

        <section class="chapter" data-chapter="reinforcement-learning">
            <nav class="chapter-nav" aria-label="Reinforcement learning sections">
                <a href="#rl-fundamentals">Fundamentals</a>
                <a href="#rl-bandits">Bandits</a>
                <a href="#rl-gridworld">MDP + Dynamic Programming</a>
                <a href="#rl-mc">Monte Carlo</a>
                <a href="#rl-td">Temporal Difference</a>
                <a href="#rl-control">Control</a>
                <a href="#rl-deep">Deep RL</a>
            </nav>

            <section id="rl-fundamentals" class="example-section">
                <h2>Reinforcement Learning Fundamentals</h2>
                <p class="section-intro">Agents learn by interacting with an environment, collecting rewards, and improving a policy.</p>
                <div class="rl-definition">
                    <p><strong>Reinforcement learning (RL)</strong> is a learning framework where an agent chooses actions in a state, receives rewards, and updates its policy to maximize long-term return.</p>
                    <div class="math-formula math-mini">
                        \[
                        \text{Goal: } \max_\pi \; \mathbb{E}_\pi \left[\sum_{t=0}^{\infty} \gamma^t r_t \right]
                        \]
                    </div>
                </div>
                <div class="content-grid rl-fundamentals-grid">
                    <div class="explanation">
                        <h3>Core concepts</h3>
                        <ul class="concept-bullets">
                            <li><strong>Agent & environment</strong>: the learner and the world it interacts with.</li>
                            <li><strong>Episode / trajectory</strong>: a sequence of states, actions, and rewards.</li>
                            <li><strong>Reward vs return</strong>: immediate feedback \(r_t\) vs discounted sum \(G_t\).</li>
                            <li><strong>Discount \(\gamma\)</strong>: weighs future rewards.</li>
                            <li><strong>Policy</strong> \( \pi(a|s) \): behavior rule.</li>
                            <li><strong>Value</strong> \( V^\pi(s) \), <strong>Action-value</strong> \( Q^\pi(s,a) \).</li>
                            <li><strong>Optimal</strong> \( V^*, Q^* \): best achievable values.</li>
                        </ul>
                        <div class="code-block">
                            <h4>Minimal environment interface</h4>
                            <pre><code>reset(seed?) -&gt; observation/state
step(action) -&gt; { nextState, reward, done, info }
actions(state) -&gt; action list
// render helpers stay separate from logic</code></pre>
                        </div>
                        <div class="rl-interface-explain">
                            <p><strong>reset(seed?)</strong> starts a new episode and returns the initial state (optionally deterministic with a seed).</p>
                            <p><strong>step(action)</strong> applies an action and returns the transition tuple: next state, reward, terminal flag, and any extra info.</p>
                            <p><strong>actions(state)</strong> exposes valid actions so the agent can plan or explore safely.</p>
                            <p><strong>Render helpers</strong> stay separate so learning logic is deterministic and testable.</p>
                        </div>
                        <div class="math-formula">
                            \[
                            V^\pi(s) = \mathbb{E}_\pi\left[\sum_{t=0}^{\infty} \gamma^t r_{t} \mid s_0 = s \right]
                            \]
                            \[
                            Q^\pi(s,a) = \mathbb{E}_\pi\left[\sum_{t=0}^{\infty} \gamma^t r_{t} \mid s_0 = s, a_0 = a \right]
                            \]
                        </div>
                    </div>
                    <div class="visualization rl-fundamentals-visuals">
                        <div class="rl-card">
                            <h3>Return calculator</h3>
                            <div class="rl-control-row">
                                <label for="rlGamma">Discount \(\gamma\)</label>
                                <input type="range" id="rlGamma" min="0" max="0.99" step="0.01" value="0.9">
                                <span id="rlGammaVal">0.90</span>
                            </div>
                            <div class="rl-reward-list" id="rlRewardList">
                                <label>r‚ÇÄ <input type="number" class="rl-reward-input" value="1"></label>
                                <label>r‚ÇÅ <input type="number" class="rl-reward-input" value="0"></label>
                                <label>r‚ÇÇ <input type="number" class="rl-reward-input" value="1"></label>
                                <label>r‚ÇÉ <input type="number" class="rl-reward-input" value="2"></label>
                                <label>r‚ÇÑ <input type="number" class="rl-reward-input" value="0"></label>
                            </div>
                            <div class="rl-return-output">Return \(G\) = <span id="rlReturnValue">0.00</span></div>
                            <div class="math-formula math-mini">
                                \[
                                G = r_0 + \gamma r_1 + \gamma^2 r_2 + \gamma^3 r_3 + \cdots
                                \]
                            </div>
                        </div>
                        <div class="rl-card">
                            <h3>Policy vs value (3-state chain)</h3>
                            <div class="rl-control-row">
                                <label for="rlPolicyBias">Policy \( \pi(\text{right} \mid s_1) \)</label>
                                <input type="range" id="rlPolicyBias" min="0" max="1" step="0.05" value="0.5">
                                <span id="rlPolicyBiasVal">0.50</span>
                            </div>
                            <canvas id="rlPolicyCanvas" width="360" height="140"></canvas>
                            <div class="rl-table" id="rlPolicyTable"></div>
                        </div>
                    </div>
                </div>
                <div class="rl-walkthrough">
                    <h3>Reinforcement Learning: a gentle mathematical walkthrough</h3>
                    <p class="section-intro">RL formalizes learning by experience: act, observe, update, repeat.</p>
                    <div class="guide-stack">
                        <article class="guide-card">
                            <h4>1. Interaction over time</h4>
                            <p>At each step the agent is in a state \(s\), takes an action \(a\), receives a reward \(r\), and lands in a new state \(s'\).</p>
                            <div class="math-formula math-mini">
                                \[
                                s_0 \rightarrow a_0 \rightarrow r_1 \rightarrow s_1 \rightarrow a_1 \rightarrow r_2 \rightarrow s_2 \rightarrow \cdots
                                \]
                            </div>
                            <p>This sequence is a trajectory (episode).</p>
                        </article>
                        <article class="guide-card">
                            <h4>2. Rewards vs return</h4>
                            <p>Rewards are immediate feedback. Returns add up future rewards with discounting.</p>
                            <div class="math-formula math-mini">
                                \[
                                G_t = r_t + \gamma r_{t+1} + \gamma^2 r_{t+2} + \cdots
                                \]
                            </div>
                            <ul class="concept-bullets">
                                <li>\(\gamma = 0\): only care about now.</li>
                                <li>\(\gamma \approx 1\): care about long-term outcomes.</li>
                            </ul>
                        </article>
                        <article class="guide-card">
                            <h4>3. Policy</h4>
                            <p>A policy tells the agent how to act:</p>
                            <div class="math-formula math-mini">
                                \[
                                \pi(a \mid s)
                                \]
                            </div>
                            <ul class="concept-bullets">
                                <li>Deterministic: always take the same action.</li>
                                <li>Stochastic: choose actions by probability.</li>
                            </ul>
                        </article>
                        <article class="guide-card">
                            <h4>4. Value functions</h4>
                            <p>Value functions measure how good states or actions are under a policy.</p>
                            <div class="math-formula math-mini">
                                \[
                                V^\pi(s) = \mathbb{E}_\pi\left[\sum_{t=0}^{\infty} \gamma^t r_t \mid s_0=s \right]
                                \]
                                \[
                                Q^\pi(s,a) = \mathbb{E}_\pi\left[\sum_{t=0}^{\infty} \gamma^t r_t \mid s_0=s, a_0=a \right]
                                \]
                            </div>
                            <p>V evaluates a state; Q evaluates a decision.</p>
                        </article>
                        <article class="guide-card">
                            <h4>5. Bellman equations</h4>
                            <p>Value is defined recursively: immediate reward plus discounted value of the next state.</p>
                            <div class="math-formula math-mini">
                                \[
                                V^\pi(s) = \sum_a \pi(a \mid s) \sum_{s'} P(s' \mid s,a)\left[R(s,a,s') + \gamma V^\pi(s')\right]
                                \]
                                \[
                                V^*(s) = \max_a \sum_{s'} P(s' \mid s,a)\left[R(s,a,s') + \gamma V^*(s')\right]
                                \]
                            </div>
                        </article>
                        <article class="guide-card">
                            <h4>6. Dynamic programming (model known)</h4>
                            <p>If transitions and rewards are known, compute values directly.</p>
                            <div class="math-formula math-mini">
                                \[
                                V_{k+1}(s) = \max_a \sum_{s'} P(s' \mid s,a)\left[R + \gamma V_k(s')\right]
                                \]
                            </div>
                            <p>Policy iteration alternates evaluation and greedy improvement.</p>
                        </article>
                        <article class="guide-card">
                            <h4>7. Monte Carlo methods</h4>
                            <p>Learn from complete episodes when the model is unknown.</p>
                            <ul class="concept-bullets">
                                <li>Generate an episode and compute the return.</li>
                                <li>Update the first visit of each state (or state-action).</li>
                                <li>Unbiased but high variance; must wait for episode end.</li>
                            </ul>
                        </article>
                        <article class="guide-card">
                            <h4>8. Temporal Difference (TD)</h4>
                            <p>Update values online using one-step bootstrapping.</p>
                            <div class="math-formula math-mini">
                                \[
                                V(s) \leftarrow V(s) + \alpha \left[r + \gamma V(s') - V(s)\right]
                                \]
                                \[
                                \delta = r + \gamma V(s') - V(s)
                                \]
                            </div>
                            <p>\(\delta\) is the TD error: how wrong the prediction was.</p>
                        </article>
                        <article class="guide-card">
                            <h4>9. Learning control</h4>
                            <p>Learn the best actions, not just values.</p>
                            <div class="math-formula math-mini">
                                \[
                                Q(s,a) \leftarrow Q(s,a) + \alpha\left[r + \gamma Q(s',a') - Q(s,a)\right]
                                \]
                                \[
                                Q(s,a) \leftarrow Q(s,a) + \alpha\left[r + \gamma \max_{a'} Q(s',a') - Q(s,a)\right]
                                \]
                            </div>
                            <p>SARSA uses the next action taken; Q-learning uses the best possible next action.</p>
                        </article>
                        <article class="guide-card">
                            <h4>10. Why deep RL exists</h4>
                            <p>Tables do not scale to high-dimensional states or continuous actions.</p>
                            <ul class="concept-bullets">
                                <li>Approximate \(Q(s,a)\) or \(\pi(a \mid s)\) with neural networks.</li>
                                <li>Use experience replay to break correlation.</li>
                                <li>Use target networks to stabilize learning.</li>
                                <li>Optimize parameters with gradient descent.</li>
                            </ul>
                        </article>
                    </div>
                    <h3>Big picture summary</h3>
                    <div class="info-grid">
                        <div class="info-card">
                            <h5>Reward</h5>
                            <p>Immediate feedback signal.</p>
                        </div>
                        <div class="info-card">
                            <h5>Return</h5>
                            <p>Discounted sum of future rewards.</p>
                        </div>
                        <div class="info-card">
                            <h5>Policy</h5>
                            <p>Behavior rule \(\pi(a \mid s)\).</p>
                        </div>
                        <div class="info-card">
                            <h5>Value</h5>
                            <p>How good a state or action is.</p>
                        </div>
                        <div class="info-card">
                            <h5>Bellman</h5>
                            <p>Recursive value definitions.</p>
                        </div>
                        <div class="info-card">
                            <h5>Monte Carlo</h5>
                            <p>Learn from full episodes.</p>
                        </div>
                        <div class="info-card">
                            <h5>TD learning</h5>
                            <p>Learn step-by-step with bootstrapping.</p>
                        </div>
                        <div class="info-card">
                            <h5>Q-learning</h5>
                            <p>Learn optimal behavior off-policy.</p>
                        </div>
                        <div class="info-card">
                            <h5>Deep RL</h5>
                            <p>Scale RL with neural networks.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="rl-bandits" class="example-section">
                <h2>Multi-Armed Bandits</h2>
                <p class="section-intro">Explore exploration strategies and track regret as the agent learns.</p>
                <div class="content-grid rl-bandits-grid">
                    <div class="explanation">
                        <h3>Algorithms</h3>
                        <ul class="concept-bullets">
                            <li><strong>\(\varepsilon\)-greedy</strong> with optional decay.</li>
                            <li><strong>UCB1</strong> balances optimism and uncertainty.</li>
                            <li><strong>Thompson Sampling</strong> for Bernoulli rewards.</li>
                        </ul>
                        <p><strong>What is a multi-armed bandit?</strong> An agent repeatedly chooses among \(K\) actions (arms) with unknown reward distributions. The goal is to maximize total reward by balancing exploration (learn the arms) and exploitation (use the best-known arm).</p>
                        <div class="rl-algo-steps">
                            <article class="rl-card">
                                <h4>\(\varepsilon\)-greedy</h4>
                                <ol class="step-list">
                                    <li>Initialize action-value estimates and counts.</li>
                                    <li>At each step, explore with probability \(\varepsilon\); otherwise exploit the best estimate.</li>
                                    <li>Pull the chosen arm and observe the reward.</li>
                                    <li>Update that arm‚Äôs estimate with an incremental mean.</li>
                                    <li>Optionally decay \(\varepsilon\) to reduce exploration over time.</li>
                                </ol>
                            </article>
                            <article class="rl-card">
                                <h4>UCB1</h4>
                                <ol class="step-list">
                                    <li>Initialize estimates and counts; try each arm at least once.</li>
                                    <li>Compute the UCB score: \( \hat{\mu}_a + c \sqrt{\log t / n_a} \).</li>
                                    <li>Select the arm with the highest UCB score.</li>
                                    <li>Observe the reward and update the estimate and count.</li>
                                    <li>Repeat to balance mean reward and uncertainty.</li>
                                </ol>
                            </article>
                            <article class="rl-card">
                                <h4>Thompson Sampling (Bernoulli)</h4>
                                <ol class="step-list">
                                    <li>Initialize Beta priors \(\alpha, \beta\) for each arm.</li>
                                    <li>Sample a success probability from each arm‚Äôs Beta distribution.</li>
                                    <li>Choose the arm with the highest sampled probability.</li>
                                    <li>Observe reward (success/failure) and update \(\alpha, \beta\).</li>
                                    <li>Repeat to naturally balance exploration and exploitation.</li>
                                </ol>
                            </article>
                        </div>
                        <div class="rl-control-panel">
                            <div class="rl-control-row">
                                <label for="banditSeed">Seed</label>
                                <input type="number" id="banditSeed" value="7">
                            </div>
                            <div class="rl-control-row">
                                <label for="banditArms"># Arms</label>
                                <input type="range" id="banditArms" min="2" max="8" value="5">
                                <span id="banditArmsVal">5</span>
                            </div>
                            <div class="rl-control-row">
                                <label for="banditHorizon">Horizon</label>
                                <input type="range" id="banditHorizon" min="50" max="500" step="10" value="200">
                                <span id="banditHorizonVal">200</span>
                            </div>
                            <div class="rl-control-row">
                                <label for="banditNoise">Noise</label>
                                <input type="range" id="banditNoise" min="0" max="1" step="0.05" value="0.2">
                                <span id="banditNoiseVal">0.20</span>
                            </div>
                            <div class="rl-control-row">
                                <label for="banditAlg">Algorithm</label>
                                <select id="banditAlg">
                                    <option value="epsilon">Œµ-greedy</option>
                                    <option value="ucb1">UCB1</option>
                                    <option value="thompson">Thompson Sampling</option>
                                </select>
                            </div>
                            <div class="rl-control-row">
                                <label for="banditEpsilon">Œµ</label>
                                <input type="range" id="banditEpsilon" min="0" max="1" step="0.05" value="0.2">
                                <span id="banditEpsilonVal">0.20</span>
                            </div>
                            <div class="rl-control-row">
                                <label for="banditDecay">Decay</label>
                                <input type="range" id="banditDecay" min="0" max="0.05" step="0.005" value="0">
                                <span id="banditDecayVal">0.000</span>
                            </div>
                            <div class="rl-control-row">
                                <label for="banditUcbC">UCB \(c\)</label>
                                <input type="range" id="banditUcbC" min="0" max="3" step="0.1" value="1.4">
                                <span id="banditUcbCVal">1.4</span>
                            </div>
                            <div class="rl-control-row">
                                <label for="banditPrior">Thompson prior</label>
                                <input type="number" id="banditPrior" value="1" min="0.1" step="0.1">
                            </div>
                            <div class="controls">
                                <button type="button" id="banditStep">Step</button>
                                <button type="button" id="banditPlay">Play</button>
                                <button type="button" id="banditReset">Reset</button>
                            </div>
                        </div>
                    </div>
                    <div class="visualization rl-bandits-visuals">
                        <canvas id="banditMeansCanvas" width="420" height="220"></canvas>
                        <p class="figure-note">Chart 1. True arm means (light) vs estimated means (dark).</p>
                        <canvas id="banditRegretCanvas" width="420" height="180"></canvas>
                        <p class="figure-note">Chart 2. Cumulative regret over time.</p>
                        <canvas id="banditActionsCanvas" width="420" height="180"></canvas>
                        <p class="figure-note">Chart 3. Action selection frequency by arm.</p>
                    </div>
                </div>
            </section>

            <section id="rl-gridworld" class="example-section">
                <h2>MDP + Dynamic Programming (Gridworld)</h2>
                <p class="section-intro">Solve a Markov Decision Process with Bellman updates and visualize value and policy.</p>
                <div class="content-grid rl-gridworld-grid">
                    <div class="explanation">
                        <h3>MDP setup</h3>
                        <ul class="concept-bullets">
                            <li>MDP \( (S, A, P, R, \gamma) \) defines dynamics and rewards.</li>
                            <li>Bellman expectation: \( V^\pi(s) = \sum_a \pi(a|s) \sum_{s'} P(s'|s,a) [R + \gamma V^\pi(s')] \).</li>
                            <li>Bellman optimality: \( V^*(s) = \max_a \sum_{s'} P(s'|s,a) [R + \gamma V^*(s')] \).</li>
                        </ul>
                        <p><strong>Deep dive: Markov Decision Process.</strong> An MDP assumes the future depends only on the current state and action (the Markov property). Transitions \(P(s'|s,a)\) and rewards \(R(s,a,s')\) define how the agent moves. Dynamic programming solves the MDP by repeatedly applying Bellman backups until values and policies converge.</p>
                        <div class="rl-control-panel">
                            <div class="rl-control-row">
                                <label for="gridGamma">Discount \(\gamma\)</label>
                                <input type="range" id="gridGamma" min="0" max="0.99" step="0.01" value="0.9">
                                <span id="gridGammaVal">0.90</span>
                            </div>
                            <div class="rl-control-row">
                                <label for="gridStepCost">Step cost</label>
                                <input type="range" id="gridStepCost" min="-0.2" max="0.1" step="0.01" value="-0.04">
                                <span id="gridStepCostVal">-0.04</span>
                            </div>
                            <div class="rl-control-row">
                                <label for="gridSlip">Slip probability</label>
                                <input type="range" id="gridSlip" min="0" max="0.4" step="0.05" value="0">
                                <span id="gridSlipVal">0.00</span>
                            </div>
                            <div class="rl-control-row">
                                <label for="gridPreset">Preset</label>
                                <select id="gridPreset">
                                    <option value="classic-5">Classic 5x5</option>
                                    <option value="open-7">Open 7x7</option>
                                    <option value="maze-8">Maze 8x8</option>
                                </select>
                            </div>
                            <div class="rl-control-row">
                                <label for="gridAlgo">Algorithm</label>
                                <select id="gridAlgo">
                                    <option value="value-iteration">Value iteration</option>
                                    <option value="policy-eval">Policy evaluation</option>
                                    <option value="policy-improve">Policy improvement</option>
                                    <option value="policy-iteration">Policy iteration</option>
                                </select>
                            </div>
                            <div class="rl-control-row">
                                <label for="gridIter">Iteration</label>
                                <input type="range" id="gridIter" min="0" max="0" step="1" value="0">
                                <span id="gridIterVal">0</span>
                            </div>
                            <div class="rl-toggle-row">
                                <label><input type="checkbox" id="gridShowValues" checked> Show V(s)</label>
                                <label><input type="checkbox" id="gridShowHeat" checked> Heatmap</label>
                                <label><input type="checkbox" id="gridShowPolicy" checked> Policy arrows</label>
                            </div>
                            <div class="controls">
                                <button type="button" id="gridIterate">Iterate</button>
                                <button type="button" id="gridPlay">Play</button>
                                <button type="button" id="gridRandomize">Randomize MDP</button>
                            </div>
                        </div>
                        <div class="rl-algo-steps">
                            <article class="rl-card">
                                <h4>Policy evaluation (iterative)</h4>
                                <ol class="step-list">
                                    <li>Initialize \(V(s)\) for all states.</li>
                                    <li>For each state, compute the Bellman expectation backup under \(\pi\).</li>
                                    <li>Update \(V(s)\) with the new estimate.</li>
                                    <li>Repeat until the max change \(\Delta V\) is below a threshold.</li>
                                </ol>
                            </article>
                            <article class="rl-card">
                                <h4>Policy improvement</h4>
                                <ol class="step-list">
                                    <li>Use the current \(V(s)\) to compute \(Q(s,a)\).</li>
                                    <li>For each state, choose the greedy action \( \arg\max_a Q(s,a) \).</li>
                                    <li>Update the policy to be greedy (or \(\varepsilon\)-greedy).</li>
                                    <li>Repeat after re-evaluating the policy.</li>
                                </ol>
                            </article>
                            <article class="rl-card">
                                <h4>Policy iteration</h4>
                                <ol class="step-list">
                                    <li>Initialize a policy \(\pi\).</li>
                                    <li>Evaluate \(\pi\) to compute \(V^\pi\).</li>
                                    <li>Improve \(\pi\) by acting greedy with respect to \(V^\pi\).</li>
                                    <li>Stop when the policy stops changing.</li>
                                </ol>
                            </article>
                            <article class="rl-card">
                                <h4>Value iteration</h4>
                                <ol class="step-list">
                                    <li>Initialize \(V(s)\) arbitrarily.</li>
                                    <li>Apply the optimality backup \( V(s) \leftarrow \max_a \sum_{s'} P [R + \gamma V(s')] \).</li>
                                    <li>Repeat until \(V\) converges.</li>
                                    <li>Extract the greedy policy from the converged values.</li>
                                </ol>
                            </article>
                        </div>
                        <div class="rl-inspect" id="gridInspect">
                            <h4>Inspect state</h4>
                            <p>Click a cell to see Q(s,¬∑).</p>
                            <div id="gridInspectValues"></div>
                        </div>
                    </div>
                    <div class="visualization rl-gridworld-visuals">
                        <canvas id="gridworldCanvas" width="420" height="420"></canvas>
                        <p class="figure-note">Grid. Values \(V(s)\), heatmap, and policy arrows per state.</p>
                        <canvas id="gridworldChart" width="420" height="180"></canvas>
                        <p class="figure-note">Chart. Max \(\Delta V\) and average \(V\) per iteration.</p>
                    </div>
                </div>
            </section>

            <section id="rl-mc" class="example-section">
                <h2>Monte Carlo Methods</h2>
                <p class="section-intro">Estimate values from complete episode returns.</p>
                <div class="content-grid rl-mc-grid">
                    <div class="explanation">
                        <h3>Algorithms</h3>
                        <ul class="concept-bullets">
                            <li>First-visit MC prediction for \(V^\pi\).</li>
                            <li>On-policy MC control with \(\varepsilon\)-soft policies.</li>
                        </ul>
                        <p><strong>Deep dive: Monte Carlo methods.</strong> MC methods wait until an episode ends, then use the realized return to update value estimates. They are unbiased but can have high variance, so averaging many episodes stabilizes learning.</p>
                        <div class="rl-algo-steps">
                            <article class="rl-card">
                                <h4>First-visit MC prediction</h4>
                                <ol class="step-list">
                                    <li>Generate a full episode using policy \(\pi\).</li>
                                    <li>For each state, find the first time it appears in the episode.</li>
                                    <li>Compute the return \(G_t\) from that first visit to the end.</li>
                                    <li>Update \(V(s)\) with the average of observed returns.</li>
                                    <li>Repeat with many episodes to reduce variance.</li>
                                </ol>
                            </article>
                            <article class="rl-card">
                                <h4>On-policy MC control (\(\varepsilon\)-soft)</h4>
                                <ol class="step-list">
                                    <li>Initialize \(Q(s,a)\) and a soft policy.</li>
                                    <li>Generate an episode following the current policy.</li>
                                    <li>Compute returns for each state-action first visit.</li>
                                    <li>Update \(Q(s,a)\) with averaged returns.</li>
                                    <li>Improve the policy to be \(\varepsilon\)-greedy w.r.t. \(Q\).</li>
                                </ol>
                            </article>
                        </div>
                        <div class="rl-control-panel">
                            <div class="rl-control-row">
                                <label for="mcEpisodes">Episodes</label>
                                <input type="number" id="mcEpisodes" value="1" min="1" max="500">
                            </div>
                            <div class="rl-control-row">
                                <label for="mcEpsilon">Œµ-soft</label>
                                <input type="range" id="mcEpsilon" min="0" max="1" step="0.05" value="0.2">
                                <span id="mcEpsilonVal">0.20</span>
                            </div>
                            <div class="controls">
                                <button type="button" id="mcRun">Run episode</button>
                                <button type="button" id="mcPlay">Play</button>
                                <button type="button" id="mcReset">Reset</button>
                            </div>
                        </div>
                    </div>
                    <div class="visualization rl-mc-visuals">
                        <canvas id="mcGridCanvas" width="420" height="320"></canvas>
                        <p class="figure-note">Grid. Episode rollout animation and evolving \(V(s)\) heatmap.</p>
                        <canvas id="mcReturnsCanvas" width="420" height="160"></canvas>
                        <p class="figure-note">Chart. Returns histogram (recent episodes).</p>
                        <canvas id="mcValueCanvas" width="420" height="160"></canvas>
                        <p class="figure-note">Chart. Value estimate of the start state over episodes.</p>
                    </div>
                </div>
            </section>

            <section id="rl-td" class="example-section">
                <h2>Temporal Difference Learning</h2>
                <p class="section-intro">Blend bootstrapping with sampling for faster learning.</p>
                <div class="content-grid rl-td-grid">
                    <div class="explanation">
                        <h3>TD(0) prediction</h3>
                        <ul class="concept-bullets">
                            <li>Update rule: \( V(s) \leftarrow V(s) + \alpha [r + \gamma V(s') - V(s)] \).</li>
                            <li>Random-walk demo with 5 states.</li>
                        </ul>
                        <div class="rl-algo-steps">
                            <article class="rl-card">
                                <h4>TD(0) prediction</h4>
                                <ol class="step-list">
                                    <li>Initialize \(V(s)\) for all states.</li>
                                    <li>Observe a transition \( (s, r, s') \).</li>
                                    <li>Compute the TD error \( \delta = r + \gamma V(s') - V(s) \).</li>
                                    <li>Update \(V(s) \leftarrow V(s) + \alpha \delta \).</li>
                                    <li>Repeat over many episodes to converge.</li>
                                </ol>
                            </article>
                        </div>
                        <div class="rl-control-panel">
                            <div class="rl-control-row">
                                <label for="tdAlpha">Œ±</label>
                                <input type="range" id="tdAlpha" min="0.01" max="1" step="0.01" value="0.1">
                                <span id="tdAlphaVal">0.10</span>
                            </div>
                            <div class="controls">
                                <button type="button" id="tdRun">Run episode</button>
                                <button type="button" id="tdPlay">Play</button>
                                <button type="button" id="tdReset">Reset</button>
                            </div>
                        </div>
                    </div>
                    <div class="visualization rl-td-visuals">
                        <canvas id="tdValueCanvas" width="420" height="180"></canvas>
                        <p class="figure-note">Chart. Current value estimates for the random-walk states.</p>
                        <canvas id="tdErrorCanvas" width="420" height="160"></canvas>
                        <p class="figure-note">Chart. TD error \(\delta_t\) over a single episode.</p>
                        <canvas id="tdEpisodeCanvas" width="420" height="160"></canvas>
                        <p class="figure-note">Chart. Value estimates per state across episodes.</p>
                    </div>
                </div>
            </section>

            <section id="rl-control" class="example-section">
                <h2>Model-Free Control</h2>
                <p class="section-intro">Learn optimal policies directly from experience.</p>
                <div class="content-grid rl-control-grid">
                    <div class="explanation">
                        <h3>Algorithms</h3>
                        <ul class="concept-bullets">
                            <li><strong>SARSA</strong>: on-policy TD control.</li>
                            <li><strong>Q-learning</strong>: off-policy TD control.</li>
                            <li><strong>Expected SARSA</strong>: expectation over policy.</li>
                        </ul>
                        <div class="rl-algo-steps">
                            <article class="rl-card">
                                <h4>SARSA</h4>
                                <ol class="step-list">
                                    <li>Initialize \(Q(s,a)\) and choose a behavior policy.</li>
                                    <li>Take action \(a\), observe \(r, s'\), and pick next action \(a'\) from the same policy.</li>
                                    <li>Update \( Q(s,a) \leftarrow Q(s,a) + \alpha [r + \gamma Q(s',a') - Q(s,a)] \).</li>
                                    <li>Set \(s \leftarrow s'\), \(a \leftarrow a'\) and repeat.</li>
                                </ol>
                            </article>
                            <article class="rl-card">
                                <h4>Q-learning</h4>
                                <ol class="step-list">
                                    <li>Initialize \(Q(s,a)\) and choose a behavior policy (e.g., \(\varepsilon\)-greedy).</li>
                                    <li>Take action \(a\), observe \(r, s'\).</li>
                                    <li>Update \( Q(s,a) \leftarrow Q(s,a) + \alpha [r + \gamma \max_{a'} Q(s',a') - Q(s,a)] \).</li>
                                    <li>Repeat until Q-values converge to \(Q^*\).</li>
                                </ol>
                            </article>
                            <article class="rl-card">
                                <h4>Expected SARSA</h4>
                                <ol class="step-list">
                                    <li>Initialize \(Q(s,a)\) and a stochastic policy.</li>
                                    <li>Observe \(r, s'\) after taking action \(a\).</li>
                                    <li>Compute expected next value \( \sum_{a'} \pi(a'|s') Q(s',a') \).</li>
                                    <li>Update \( Q(s,a) \leftarrow Q(s,a) + \alpha [r + \gamma \mathbb{E}_{a'}Q(s',a') - Q(s,a)] \).</li>
                                </ol>
                            </article>
                        </div>
                        <div class="rl-control-panel">
                            <div class="rl-control-row">
                                <label for="controlAlgo">Algorithm</label>
                                <select id="controlAlgo">
                                    <option value="sarsa">SARSA</option>
                                    <option value="qlearn">Q-learning</option>
                                    <option value="expected">Expected SARSA</option>
                                </select>
                            </div>
                            <div class="rl-control-row">
                                <label for="controlEpsilon">Œµ</label>
                                <input type="range" id="controlEpsilon" min="0" max="1" step="0.05" value="0.2">
                                <span id="controlEpsilonVal">0.20</span>
                            </div>
                            <div class="rl-control-row">
                                <label for="controlAlpha">Œ±</label>
                                <input type="range" id="controlAlpha" min="0.01" max="1" step="0.01" value="0.2">
                                <span id="controlAlphaVal">0.20</span>
                            </div>
                            <div class="controls">
                                <button type="button" id="controlRun">Run episode</button>
                                <button type="button" id="controlPlay">Play</button>
                                <button type="button" id="controlReset">Reset</button>
                            </div>
                        </div>
                    </div>
                    <div class="visualization rl-control-visuals">
                        <canvas id="controlGridCanvas" width="420" height="320"></canvas>
                        <p class="figure-note">Grid. Greedy policy arrows from the current Q-table.</p>
                        <canvas id="controlQCanvas" width="420" height="180"></canvas>
                        <p class="figure-note">Chart. Q-value heatmaps per action (Up/Right/Down/Left).</p>
                        <canvas id="controlEpsCanvas" width="420" height="160"></canvas>
                        <p class="figure-note">Chart. Exploration schedule \(\varepsilon\) over time.</p>
                        <canvas id="controlReturnCanvas" width="420" height="160"></canvas>
                        <p class="figure-note">Chart. Episode return over training.</p>
                    </div>
                </div>
            </section>

            <section id="rl-deep" class="example-section">
                <h2>Deep RL Concepts</h2>
                <p class="section-intro">When state spaces grow, deep networks approximate value functions or policies.</p>
                <div class="content-grid rl-deep-grid">
                    <div class="explanation">
                        <h3>Core ideas</h3>
                        <ul class="concept-bullets">
                            <li>Policy gradients optimize expected return directly.</li>
                            <li>Replay buffers stabilize off-policy learning.</li>
                            <li>Target networks reduce moving-target instability.</li>
                        </ul>
                        <div class="rl-algo-steps">
                            <article class="rl-card">
                                <h4>Policy gradient (REINFORCE-style)</h4>
                                <ol class="step-list">
                                    <li>Collect trajectories by sampling from \(\pi_\theta(a|s)\).</li>
                                    <li>Compute returns or advantages for each action.</li>
                                    <li>Estimate the gradient \( \nabla_\theta \log \pi_\theta(a|s) \hat{A} \).</li>
                                    <li>Update parameters \( \theta \leftarrow \theta + \alpha \nabla_\theta J(\theta) \).</li>
                                    <li>Repeat with variance reduction (baseline) for stability.</li>
                                </ol>
                            </article>
                            <article class="rl-card">
                                <h4>Deep Q-learning (conceptual)</h4>
                                <ol class="step-list">
                                    <li>Collect transitions into a replay buffer.</li>
                                    <li>Sample mini-batches uniformly from the buffer.</li>
                                    <li>Compute target \( r + \gamma \max_{a'} Q_{\text{target}}(s',a') \).</li>
                                    <li>Minimize the TD loss between \(Q_\theta\) and targets.</li>
                                    <li>Periodically sync the target network.</li>
                                </ol>
                            </article>
                        </div>
                        <div class="math-formula">
                            \[
                            \nabla_\theta J(\theta) = \mathbb{E}_\pi[\nabla_\theta \log \pi_\theta(a|s) \, \hat{A}(s,a)]
                            \]
                        </div>
                    </div>
                    <div class="visualization rl-deep-visuals">
                        <div class="rl-card">
                            <h3>Deep RL diagnostic loop</h3>
                            <ol class="step-list">
                                <li>Collect experience into a replay buffer.</li>
                                <li>Sample mini-batches for stable updates.</li>
                                <li>Sync target networks periodically.</li>
                                <li>Track reward curves and policy entropy.</li>
                            </ol>
                        </div>
                        <div class="rl-card">
                            <h3>Policy gradient intuition</h3>
                            <p>Increase the probability of actions that led to higher return and decrease others.</p>
                            <div class="math-formula math-mini">
                                \[
                                \theta \leftarrow \theta + \alpha \nabla_\theta \log \pi_\theta(a|s) \, \hat{A}
                                \]
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </section>

        <section class="chapter" data-chapter="notebook">
            <nav class="chapter-nav" aria-label="Notebook lab sections">
                <a href="#ipython-notebook">Math Notebook</a>
                <a href="#notebook-python">Python</a>
                <a href="#notebook-linear">Linear Algebra</a>
                <a href="#notebook-calculus">Calculus + Optimization</a>
                <a href="#notebook-probability">Probability + Activations</a>
                <a href="#notebook-matrix">Matrix Calculus</a>
            </nav>

            <section id="ipython-notebook" class="example-section notebook-section">
                <h2>Jupyter-Style Math Notebook</h2>
                <p class="section-intro">Work through the foundations topics in order. Each cell runs in a shared kernel for a practical hands-on workshop.</p>
                <div class="notebook-toolbar">
                    <div class="toolbar-left">
                        <span class="notebook-chip">Python kernel</span>
                        <span class="notebook-status" id="notebookStatus">Idle</span>
                    </div>
                    <div class="toolbar-actions">
                        <button class="notebook-btn" type="button" id="notebookRunAll">Run all</button>
                        <button class="notebook-btn secondary" type="button" id="notebookClearAll">Clear outputs</button>
                        <button class="notebook-btn secondary" type="button" id="notebookReset">Reset kernel</button>
                    </div>
                </div>

                <div class="notebook-workspace">
                    <article class="notebook-cell markdown-cell">
                        <h4>Notebook goal</h4>
                        <p>Cover the Foundations math with a practical hands-on workshop: linear algebra, calculus, optimization, probability, activations, and matrix calculus.</p>
                    </article>

                    <div class="notebook-group" id="notebook-python">
                        <h3>Section 1: Python for math</h3>
                        <p class="section-intro">Lists, loops, and functions to prep for vector math.</p>

                        <article class="notebook-cell code-cell">
                            <div class="cell-top">
                                <span class="cell-label">In [1]</span>
                                <span class="cell-title">Numbers, lists, and summaries</span>
                            </div>
                            <textarea class="cell-editor" rows="7" spellcheck="false">values = [2.0, -1.0, 3.5, 4.2]
mean = sum(values) / len(values)
centered = [v - mean for v in values]

print("mean =", round(mean, 3))
print("centered =", [round(v, 3) for v in centered])</textarea>
                            <div class="cell-actions">
                                <button class="notebook-btn cell-run" type="button">Run cell</button>
                            </div>
                            <div class="cell-output" aria-live="polite"></div>
                        </article>

                        <article class="notebook-cell code-cell">
                            <div class="cell-top">
                                <span class="cell-label">In [2]</span>
                                <span class="cell-title">Functions and list math</span>
                            </div>
                            <textarea class="cell-editor" rows="8" spellcheck="false">def scale(xs, factor):
    return [factor * x for x in xs]

def add(a, b):
    return [x + y for x, y in zip(a, b)]

v = [1.0, -2.0, 0.5]
w = [0.5, 1.5, -1.0]

print("2v =", scale(v, 2))
print("v + w =", add(v, w))</textarea>
                            <div class="cell-actions">
                                <button class="notebook-btn cell-run" type="button">Run cell</button>
                            </div>
                            <div class="cell-output" aria-live="polite"></div>
                        </article>
                    </div>

                    <div class="notebook-group" id="notebook-linear">
                        <h3>Section 2: Linear algebra (vectors + matrices)</h3>
                        <p class="section-intro">Dot products, norms, matrix-vector products, and matrix multiplication.</p>

                        <article class="notebook-cell code-cell">
                            <div class="cell-top">
                                <span class="cell-label">In [3]</span>
                                <span class="cell-title">Vector ops</span>
                            </div>
                            <textarea class="cell-editor" rows="9" spellcheck="false">def dot(a, b):
    return sum(x * y for x, y in zip(a, b))

def norm(a):
    return (sum(x * x for x in a)) ** 0.5

x = [2.0, -1.0, 0.5]
w = [1.5, 0.2, -3.0]

print("dot(x, w) =", round(dot(x, w), 3))
print("||x|| =", round(norm(x), 3))</textarea>
                            <div class="cell-actions">
                                <button class="notebook-btn cell-run" type="button">Run cell</button>
                            </div>
                            <div class="cell-output" aria-live="polite"></div>
                        </article>

                        <article class="notebook-cell code-cell">
                            <div class="cell-top">
                                <span class="cell-label">In [4]</span>
                                <span class="cell-title">Matrices: matvec + matmul</span>
                            </div>
                            <textarea class="cell-editor" rows="12" spellcheck="false">def matvec(M, v):
    return [dot(row, v) for row in M]

def matmul(A, B):
    cols = list(zip(*B))
    return [[dot(row, col) for col in cols] for row in A]

W = [
    [1.0, 2.0],
    [-1.0, 0.5],
    [0.3, -0.7]
]
v = [1.0, -2.0]
print("Wv =", matvec(W, v))

A = [[1, 2], [3, 4]]
B = [[2, 0], [1, 2]]
print("AB =", matmul(A, B))</textarea>
                            <div class="cell-actions">
                                <button class="notebook-btn cell-run" type="button">Run cell</button>
                            </div>
                            <div class="cell-output" aria-live="polite"></div>
                        </article>
                    </div>

                    <div class="notebook-group" id="notebook-calculus">
                        <h3>Section 3: Calculus + optimization</h3>
                        <p class="section-intro">Estimate derivatives and follow gradients downhill.</p>

                        <article class="notebook-cell code-cell">
                            <div class="cell-top">
                                <span class="cell-label">In [5]</span>
                                <span class="cell-title">Numerical derivative</span>
                            </div>
                            <textarea class="cell-editor" rows="9" spellcheck="false">def f(x):
    return x ** 3 - 2 * x + 1

def numerical_derivative(fn, x, eps=1e-5):
    return (fn(x + eps) - fn(x - eps)) / (2 * eps)

for x in [-1.0, 0.0, 2.0]:
    print("f'(", x, ") =", round(numerical_derivative(f, x), 4))</textarea>
                            <div class="cell-actions">
                                <button class="notebook-btn cell-run" type="button">Run cell</button>
                            </div>
                            <div class="cell-output" aria-live="polite"></div>
                        </article>

                        <article class="notebook-cell code-cell">
                            <div class="cell-top">
                                <span class="cell-label">In [6]</span>
                                <span class="cell-title">Gradient descent on a quadratic</span>
                            </div>
                            <textarea class="cell-editor" rows="10" spellcheck="false">def loss(x):
    return (x - 3) ** 2

x = 0.0
lr = 0.2
for step in range(6):
    grad = 2 * (x - 3)
    x -= lr * grad
    print("step", step, "x =", round(x, 4), "loss =", round(loss(x), 4))</textarea>
                            <div class="cell-actions">
                                <button class="notebook-btn cell-run" type="button">Run cell</button>
                            </div>
                            <div class="cell-output" aria-live="polite"></div>
                        </article>

                        <article class="notebook-cell code-cell">
                            <div class="cell-top">
                                <span class="cell-label">In [7]</span>
                                <span class="cell-title">Plot a curve</span>
                            </div>
                            <textarea class="cell-editor" rows="12" spellcheck="false">import matplotlib.pyplot as plt

xs = [x / 10 for x in range(-30, 31)]
ys = [x ** 2 - 2 * x + 1 for x in xs]

plt.figure(figsize=(5, 3))
plt.plot(xs, ys, label="f(x)=x^2-2x+1")
plt.axhline(0, color="gray", linewidth=0.8)
plt.scatter([1], [0], color="tomato", label="minimum")
plt.title("Quadratic curve")
plt.legend()
plt.tight_layout()</textarea>
                            <div class="cell-actions">
                                <button class="notebook-btn cell-run" type="button">Run cell</button>
                            </div>
                            <div class="cell-output" aria-live="polite"></div>
                        </article>
                    </div>

                    <div class="notebook-group" id="notebook-probability">
                        <h3>Section 4: Probability + activations</h3>
                        <p class="section-intro">Turn scores into probabilities and compare activation curves.</p>

                        <article class="notebook-cell code-cell">
                            <div class="cell-top">
                                <span class="cell-label">In [8]</span>
                                <span class="cell-title">Softmax + cross-entropy</span>
                            </div>
                            <textarea class="cell-editor" rows="10" spellcheck="false">import math

def softmax(xs):
    m = max(xs)
    exps = [math.exp(x - m) for x in xs]
    s = sum(exps)
    return [e / s for e in exps]

logits = [2.0, 0.5, -1.0]
probs = softmax(logits)
target = 0
loss = -math.log(probs[target])

print("probs =", [round(p, 3) for p in probs])
print("cross-entropy loss =", round(loss, 4))</textarea>
                            <div class="cell-actions">
                                <button class="notebook-btn cell-run" type="button">Run cell</button>
                            </div>
                            <div class="cell-output" aria-live="polite"></div>
                        </article>

                        <article class="notebook-cell code-cell">
                            <div class="cell-top">
                                <span class="cell-label">In [9]</span>
                                <span class="cell-title">Activation functions</span>
                            </div>
                            <textarea class="cell-editor" rows="11" spellcheck="false">import math

def sigmoid(x):
    return 1 / (1 + math.exp(-x))

def relu(x):
    return x if x > 0 else 0.0

def tanh(x):
    return math.tanh(x)

xs = [-2, -1, 0, 1, 2]
print("sigmoid =", [round(sigmoid(x), 3) for x in xs])
print("relu =", [round(relu(x), 3) for x in xs])
print("tanh =", [round(tanh(x), 3) for x in xs])</textarea>
                            <div class="cell-actions">
                                <button class="notebook-btn cell-run" type="button">Run cell</button>
                            </div>
                            <div class="cell-output" aria-live="polite"></div>
                        </article>

                        <article class="notebook-cell code-cell">
                            <div class="cell-top">
                                <span class="cell-label">In [10]</span>
                                <span class="cell-title">Plot activation curves</span>
                            </div>
                            <textarea class="cell-editor" rows="13" spellcheck="false">import math
import matplotlib.pyplot as plt

xs = [x / 10 for x in range(-50, 51)]
sig = [1 / (1 + math.exp(-x)) for x in xs]
rel = [x if x > 0 else 0 for x in xs]
th = [math.tanh(x) for x in xs]

plt.figure(figsize=(5, 3))
plt.plot(xs, sig, label="sigmoid")
plt.plot(xs, rel, label="relu")
plt.plot(xs, th, label="tanh")
plt.title("Activation curves")
plt.legend()
plt.tight_layout()</textarea>
                            <div class="cell-actions">
                                <button class="notebook-btn cell-run" type="button">Run cell</button>
                            </div>
                            <div class="cell-output" aria-live="polite"></div>
                        </article>
                    </div>

                    <div class="notebook-group" id="notebook-matrix">
                        <h3>Section 5: Matrix calculus (batch gradients)</h3>
                        <p class="section-intro">Compute a vectorized gradient for linear regression.</p>

                        <article class="notebook-cell code-cell">
                            <div class="cell-top">
                                <span class="cell-label">In [11]</span>
                                <span class="cell-title">Batch gradient for linear regression</span>
                            </div>
                            <textarea class="cell-editor" rows="18" spellcheck="false">def dot(a, b):
    return sum(x * y for x, y in zip(a, b))

def matvec(M, v):
    return [dot(row, v) for row in M]

def transpose(M):
    return list(map(list, zip(*M)))

X = [
    [1.0, 0.5],
    [1.0, -1.0],
    [1.0, 2.0]
]
y = [1.0, -1.0, 3.0]
w = [0.0, 0.0]

preds = matvec(X, w)
errors = [p - yi for p, yi in zip(preds, y)]
loss = sum(e * e for e in errors) / len(y)

Xt = transpose(X)
grad = [
    (2 / len(y)) * sum(xij * err for xij, err in zip(col, errors))
    for col in Xt
]

print("loss =", round(loss, 4))
print("grad =", [round(g, 4) for g in grad])</textarea>
                            <div class="cell-actions">
                                <button class="notebook-btn cell-run" type="button">Run cell</button>
                            </div>
                            <div class="cell-output" aria-live="polite"></div>
                        </article>
                    </div>
                </div>
            </section>
        </section>

    </main>

    <footer>
        <p>Built with ‚ù§Ô∏è for intuitive machine learning education</p>
        <p>All visualizations are interactive - click buttons to see animations!</p>
    </footer>

    <script src="script.js"></script>
</body>
</html>
