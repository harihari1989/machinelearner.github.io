<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Machine Learning Math - Visual Examples</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Comic+Neue:wght@400;700&family=Fredoka:wght@400;600;700&family=Nunito:wght@400;600;700&family=Playfair+Display:wght@500;700&family=Source+Sans+3:wght@400;600;700&display=swap" rel="stylesheet">
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)'], ['$', '$']],
                displayMath: [['\\[', '\\]'], ['$$', '$$']]
            },
            svg: { fontCache: 'global' }
        };
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>
<body data-theme="light">
    <header>
        <h1>ðŸ§  Machine Learning Math Adventure</h1>
        <p>Playful visuals and mini missions to explore the math behind neural networks</p>
        <div class="mode-switcher" role="group" aria-label="Theme mode">
            <span class="mode-label">Mode:</span>
            <button class="mode-btn is-active" data-theme="light" type="button">Light</button>
            <button class="mode-btn" data-theme="dark" type="button">Dark</button>
            <button class="mode-btn" data-theme="kid" type="button">Kid Comic</button>
            <button class="mode-btn" data-theme="holiday" type="button">Holiday Kids</button>
            <button class="mode-btn" data-theme="adult" type="button">Adult</button>
        </div>
    </header>

    <div class="chapter-switcher" role="tablist" aria-label="Learning chapters">
        <button class="chapter-btn is-active" type="button" role="tab" aria-selected="true" data-chapter="foundations">Foundations</button>
        <button class="chapter-btn" type="button" role="tab" aria-selected="false" data-chapter="neural">Neural Networks</button>
        <button class="chapter-btn" type="button" role="tab" aria-selected="false" data-chapter="llm-foundations">LLM Foundations</button>
    </div>

    <div class="holiday-parade" aria-hidden="true">
        <div class="holiday-character santa" aria-hidden="true">
            <span class="holiday-emoji" aria-hidden="true">ðŸŽ…</span>
            <span class="holiday-label">Santa</span>
        </div>
        <div class="holiday-character spidey" aria-hidden="true">
            <img class="holiday-image" src="assets/spiderman-mask.svg" alt="Spiderman mask">
            <span class="holiday-label">Spidey</span>
        </div>
    </div>

    <main>
        <section class="chapter is-active" data-chapter="foundations">
            <nav class="chapter-nav" aria-label="Foundations sections">
                <a href="#fundamentals">Foundations</a>
                <a href="#vectors">Vectors</a>
                <a href="#matrices">Matrices</a>
                <a href="#gradient-descent">Gradient Descent</a>
                <a href="#activations">Activation Functions</a>
            </nav>

            <!-- Foundations Section -->
            <section id="fundamentals" class="example-section fundamentals-section">
                <h2>Foundations: Your Self-Guided Math Path</h2>
            <p class="section-intro">Start here! Each step unlocks a superpower for understanding neural networks. Tap a tab to switch the graphic and see the idea in action.</p>
            <div class="learning-path">
                <div class="path-card">
                    <span class="path-step">Step 1</span>
                    <h4>Linear Algebra: Space Benders</h4>
                    <p>Learn how vectors and matrices stretch, rotate, and move space.</p>
                    <span class="path-goal">Goal: read \( \mathbf{h} = W\mathbf{x} + \mathbf{b} \).</span>
                </div>
                <div class="path-card">
                    <span class="path-step">Step 2</span>
                    <h4>Calculus: Change Detective</h4>
                    <p>Understand slopes, tiny nudges, and the chain rule.</p>
                    <span class="path-goal">Goal: follow gradients through a network.</span>
                </div>
                <div class="path-card">
                    <span class="path-step">Step 3</span>
                    <h4>Optimization: Mountain Hikes</h4>
                    <p>Use gradients to walk downhill and find the best answers.</p>
                    <span class="path-goal">Goal: tune the learning rate \( \eta \).</span>
                </div>
                <div class="path-card">
                    <span class="path-step">Step 4</span>
                    <h4>Probability: Confidence Radar</h4>
                    <p>Turn scores into probabilities and measure mistakes.</p>
                    <span class="path-goal">Goal: use softmax and cross-entropy.</span>
                </div>
                <div class="path-card">
                    <span class="path-step">Step 5</span>
                    <h4>Matrix Calculus: Fast Backprop</h4>
                    <p>Compute gradients for whole batches at once.</p>
                    <span class="path-goal">Goal: track shapes and vectorized rules.</span>
                </div>
            </div>
            <div class="content-grid fundamentals-grid">
                <div class="explanation">
                    <p class="foundation-lead">Neural networks are a stack of math ideas. Each tab below zooms in on one layer of that stack.</p>
                    <div class="concept-tabs" role="tablist">
                        <button class="concept-tab is-active" data-topic="linear" role="tab" aria-controls="concept-linear" aria-selected="true">Linear Algebra</button>
                        <button class="concept-tab" data-topic="calculus" role="tab" aria-controls="concept-calculus" aria-selected="false">Calculus</button>
                        <button class="concept-tab" data-topic="optimization" role="tab" aria-controls="concept-optimization" aria-selected="false">Optimization</button>
                        <button class="concept-tab" data-topic="probability" role="tab" aria-controls="concept-probability" aria-selected="false">Probability</button>
                        <button class="concept-tab" data-topic="matrix" role="tab" aria-controls="concept-matrix" aria-selected="false">Matrix Calc</button>
                    </div>
                    <div class="concept-panels">
                        <div class="concept-panel is-active" id="concept-linear" data-topic="linear" role="tabpanel">
                            <h3>Linear algebra: what the network is</h3>
                            <p>Think of a matrix as a magic machine that bends space. Each layer takes a vector and transforms it.</p>
                            <div class="math-formula">
                                \[
                                \mathbf{h} = W\mathbf{x} + \mathbf{b}
                                \]
                                \[
                                \mathbf{a} = \mathrm{ReLU}(\mathbf{h})
                                \]
                            </div>
                            <p>Imagine a grid of points being stretched and tilted. That is what \(W\) does.</p>
                            <ul class="concept-bullets">
                                <li>Vectors are arrows (direction + length).</li>
                                <li>Matrices are transformations (stretch, rotate, shear).</li>
                                <li>Layers stack these transformations with a nonlinearity.</li>
                            </ul>
                            <div class="mini-mission">Mini mission: pick a vector and predict where the grid sends it.</div>
                        </div>
                        <div class="concept-panel" id="concept-calculus" data-topic="calculus" role="tabpanel">
                            <h3>Calculus: how learning works</h3>
                            <p>Derivatives tell us how fast things change. If the loss is a hill, the derivative tells the slope.</p>
                            <div class="math-formula">
                                \[
                                \frac{d}{dx}f(g(x)) = f'(g(x)) \cdot g'(x)
                                \]
                            </div>
                            <p>Backprop is the chain rule applied again and again through the whole network.</p>
                            <ul class="concept-bullets">
                                <li>Local slope \(\times\) upstream slope = new slope.</li>
                                <li>Think of it as water flowing through pipes.</li>
                            </ul>
                            <div class="mini-mission">Mini mission: point to where the slope is steepest.</div>
                        </div>
                        <div class="concept-panel" id="concept-optimization" data-topic="optimization" role="tabpanel">
                            <h3>Optimization: gradient descent and learning rate</h3>
                            <p>Once we know the slope, we take a step downhill to reduce the loss.</p>
                            <div class="math-formula">
                                \[
                                \theta \leftarrow \theta - \eta \nabla_\theta L
                                \]
                            </div>
                            <ul>
                                <li><strong>\(\eta\)</strong>: learning rate (step size)</li>
                                <li>Too big &rarr; unstable or diverges</li>
                                <li>Too small &rarr; slow progress</li>
                            </ul>
                            <div class="mini-mission">Mini mission: choose a step size that reaches the valley without bouncing.</div>
                        </div>
                        <div class="concept-panel" id="concept-probability" data-topic="probability" role="tabpanel">
                            <h3>Probability + information theory</h3>
                            <p>For classification, the network turns scores into probabilities and compares them to the truth.</p>
                            <div class="math-formula">
                                \[
                                \mathbf{z} = W\mathbf{x} + \mathbf{b}
                                \]
                                \[
                                \hat{y}_i = \frac{e^{z_i}}{\sum_k e^{z_k}}
                                \]
                                \[
                                L = -\sum_i y_i \log \hat{y}_i
                                \]
                            </div>
                            <p>Key result (used constantly): \( \nabla_{\mathbf{z}} L = \hat{\mathbf{y}} - \mathbf{y} \).</p>
                            <div class="mini-mission">Mini mission: spot the biggest probability bar.</div>
                        </div>
                        <div class="concept-panel" id="concept-matrix" data-topic="matrix" role="tabpanel">
                            <h3>Matrix calculus: the speed path</h3>
                            <p>To train fast, we compute gradients for a whole batch at once.</p>
                            <div class="math-formula">
                                \[
                                Y = XW
                                \]
                                \[
                                \frac{\partial L}{\partial X} = \frac{\partial L}{\partial Y} W^T
                                \]
                                \[
                                \frac{\partial L}{\partial W} = X^T \frac{\partial L}{\partial Y}
                                \]
                            </div>
                            <p>Shapes are your superpower: match the dimensions and the math works out.</p>
                            <div class="mini-mission">Mini mission: label the shapes of \(X\), \(W\), and \(Y\).</div>
                        </div>
                    </div>
                </div>
                <div class="visualization">
                    <canvas id="fundamentalsCanvas" width="420" height="360"></canvas>
                    <div class="controls fundamentals-controls">
                        <button onclick="cycleFundamentals()">Next concept</button>
                        <p class="helper-text">Tap a tab to switch the picture.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Vectors Section -->
        <section id="vectors" class="example-section">
            <h2>Vectors & Vector Playground</h2>
            <p class="section-intro">Explore vectors as data points, similarity scores, and distances. Switch to Deep Dive when you want the advanced geometry.</p>
            <div class="vector-mode-switcher" role="group" aria-label="Vector depth mode">
                <button class="toggle-btn is-active" type="button" data-vector-mode="basic">Basic playground</button>
                <button class="toggle-btn" type="button" data-vector-mode="deep">Deep dive</button>
            </div>
            <div class="vector-mode-panel is-active" data-vector-mode="basic">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Vector playground</h3>
                        <p>Think of vector A as a data point \(x\) and vector B as model weights \(w\). Use the buttons to see how scores and distances behave.</p>
                        <ul class="concept-bullets">
                            <li>Data point: the arrow from the origin to \(x\).</li>
                            <li>Dot product: the shadow of \(x\) on \(w\).</li>
                            <li>Cosine: angle-only similarity.</li>
                            <li>Distance: how far two points are apart.</li>
                        </ul>
                        <div class="math-formula" id="vectorOperationFormula">\[
                        x = [x_1, x_2], \quad w = [w_1, w_2]
                        \]</div>
                        <div class="vector-metrics">
                            <div class="metric" data-vector-metric="sum">
                                <span class="metric-label">x + w</span>
                                <span class="metric-value" id="vectorSum">[0, 0]</span>
                            </div>
                            <div class="metric" data-vector-metric="dot">
                                <span class="metric-label">Dot</span>
                                <span class="metric-value" id="vectorDot">0</span>
                            </div>
                            <div class="metric" data-vector-metric="cosine">
                                <span class="metric-label">Cosine</span>
                                <span class="metric-value" id="vectorCosine">0</span>
                            </div>
                            <div class="metric" data-vector-metric="angle">
                                <span class="metric-label">Angle</span>
                                <span class="metric-value" id="vectorAngle">0Â°</span>
                            </div>
                            <div class="metric" data-vector-metric="distance">
                                <span class="metric-label">Distance</span>
                                <span class="metric-value" id="vectorDistance">0</span>
                            </div>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="vectorCanvas" width="400" height="400"></canvas>
                        <div class="controls vector-controls">
                            <div class="toggle-group" role="group" aria-label="Vector operation">
                                <button class="toggle-btn is-active" type="button" data-vector-op="data">Data point</button>
                                <button class="toggle-btn" type="button" data-vector-op="addition">Addition</button>
                                <button class="toggle-btn" type="button" data-vector-op="dot">Dot product</button>
                                <button class="toggle-btn" type="button" data-vector-op="cosine">Cosine</button>
                                <button class="toggle-btn" type="button" data-vector-op="distance">Distance</button>
                            </div>
                            <div class="slider-group">
                                <span class="slider-title">Vector A (x)</span>
                                <label>A.x <span id="vecAxVal">2.0</span></label>
                                <input type="range" id="vecAx" min="-4" max="4" step="0.1" value="2">
                                <label>A.y <span id="vecAyVal">3.0</span></label>
                                <input type="range" id="vecAy" min="-4" max="4" step="0.1" value="3">
                            </div>
                            <div class="slider-group">
                                <span class="slider-title">Vector B (w)</span>
                                <label>B.x <span id="vecBxVal">1.0</span></label>
                                <input type="range" id="vecBx" min="-4" max="4" step="0.1" value="1">
                                <label>B.y <span id="vecByVal">4.0</span></label>
                                <input type="range" id="vecBy" min="-4" max="4" step="0.1" value="4">
                            </div>
                            <div class="slider-group">
                                <span class="slider-title">Zoom</span>
                                <label>Zoom <span id="vecScaleVal">1.0</span></label>
                                <input type="range" id="vecScale" min="0.5" max="2" step="0.1" value="1">
                            </div>
                            <button type="button" id="vectorAnimateButton" onclick="animateVectorAddition()">Animate Addition</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="vector-mode-panel" data-vector-mode="deep">
                <div class="content-grid vector-scenes">
                    <div class="explanation">
                        <h3>Deep dive: advanced geometry</h3>
                        <p>Step through projections, gradients, regularization, and attention with visual intuition.</p>
                        <div class="scene-panel" id="vectorScenePanel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="vectorSceneBadge">Scene 1 of 4</span>
                                <h4 id="vectorSceneTitle">Scene 1: Projection as a shadow</h4>
                            </div>
                            <div class="scene-block">
                                <h5>Visual</h5>
                                <p id="vectorSceneVisual"></p>
                            </div>
                            <div class="scene-block">
                                <h5>Mini example</h5>
                                <p id="vectorSceneExample"></p>
                            </div>
                            <div class="scene-block">
                                <h5>ML intuition</h5>
                                <p id="vectorSceneIntuition"></p>
                            </div>
                            <div class="math-formula" id="vectorSceneMath"></div>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="vectorSceneCanvas" width="420" height="360"></canvas>
                        <div class="controls scene-controls">
                            <button type="button" id="vectorPrevScene">Previous scene</button>
                            <button type="button" id="vectorNextScene">Next scene</button>
                        </div>
                    </div>
                </div>
                <div class="vector-toolkit">
                    <h3>Deep dive concepts</h3>
                    <p class="section-intro">Advanced vector ideas that show up in PCA, optimization, and attention.</p>
                    <div class="vector-grid">
                        <article class="vector-card">
                            <span class="path-step">1</span>
                            <h4>Projections & orthogonality</h4>
                            <ul>
                                <li>Projection onto \(u\): \( \mathrm{proj}_u(x) = \frac{x \cdot u}{u \cdot u} u \).</li>
                                <li>Orthogonal vectors give clean coordinate systems (PCA/SVD).</li>
                            </ul>
                        </article>
                        <article class="vector-card">
                            <span class="path-step">2</span>
                            <h4>Subspaces, basis, rank</h4>
                            <ul>
                                <li>Span is the set of all linear combinations of vectors.</li>
                                <li>Rank is the dimension of that span (effective dimensionality).</li>
                            </ul>
                        </article>
                        <article class="vector-card">
                            <span class="path-step">3</span>
                            <h4>Gradients, Jacobians, Hessians</h4>
                            <ul>
                                <li>\(\nabla_\theta L\) points steepest uphill.</li>
                                <li>Jacobians handle vector outputs; Hessians capture curvature.</li>
                            </ul>
                        </article>
                        <article class="vector-card">
                            <span class="path-step">4</span>
                            <h4>Vector statistics</h4>
                            <ul>
                                <li>Mean vector and covariance describe feature distributions.</li>
                                <li>Centering and whitening stabilize training and PCA.</li>
                            </ul>
                        </article>
                        <article class="vector-card">
                            <span class="path-step">5</span>
                            <h4>Regularization geometry</h4>
                            <ul>
                                <li>L2 prefers small norms; L1 encourages sparsity.</li>
                                <li>Constraint shapes explain why L1 yields zeros.</li>
                            </ul>
                        </article>
                        <article class="vector-card">
                            <span class="path-step">6</span>
                            <h4>Attention via dot products</h4>
                            <ul>
                                <li>Similarity scores become weights after softmax.</li>
                                <li>Output is a weighted sum of value vectors.</li>
                            </ul>
                        </article>
                    </div>
                </div>
            </div>
        </section>

        <!-- Matrices Section -->
        <section id="matrices" class="example-section">
            <h2>Matrices: Addition & Multiplication</h2>
            <div class="content-grid">
                <div class="explanation">
                    <h3>Matrix playground</h3>
                    <p>Switch between addition and multiplication to see how matrices combine and transform data.</p>
                    <div class="math-formula" id="matrixOperationFormula">\[
                    C = AB
                    \]</div>
                    <p id="matrixOperationNote">Multiplication mixes rows and columns to transform vectors.</p>
                </div>
                <div class="visualization">
                    <canvas id="matrixCanvas" width="420" height="320"></canvas>
                    <div class="controls matrix-controls">
                        <div class="toggle-group" role="group" aria-label="Matrix concept">
                            <button class="toggle-btn is-active" type="button" data-matrix-op="multiply">Multiplication</button>
                            <button class="toggle-btn" type="button" data-matrix-op="add">Addition</button>
                            <button class="toggle-btn" type="button" data-matrix-op="step">Step-by-step</button>
                            <button class="toggle-btn" type="button" data-matrix-op="covariance">Covariance + Inverse</button>
                            <button class="toggle-btn" type="button" data-matrix-op="identity">Identity</button>
                            <button class="toggle-btn" type="button" data-matrix-op="onehot">One-hot</button>
                            <button class="toggle-btn" type="button" data-matrix-op="eigen">Eigen</button>
                        </div>
                        <button type="button" id="matrixAnimateButton" onclick="animateMatrixOperation()">Animate</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Gradient Descent Section -->
        <section id="gradient-descent" class="example-section">
            <h2>Gradient Descent</h2>
            <div class="content-grid">
                <div class="explanation">
                    <h3>Finding the Minimum</h3>
                    <p>Gradient descent is how neural networks learn. It's like walking downhill to find the lowest point:</p>
                    <div class="math-formula">
                        \[
                        \theta_{\text{new}} = \theta_{\text{old}} - \alpha \nabla J(\theta)
                        \]
                    </div>
                    <ul>
                        <li><strong>\(\theta\)</strong>: Parameter being optimized</li>
                        <li><strong>\(\alpha\)</strong>: Learning rate (step size)</li>
                        <li><strong>\(\nabla J(\theta)\)</strong>: Gradient (direction of steepest increase)</li>
                    </ul>
                </div>
                <div class="visualization">
                    <canvas id="gradientCanvas" width="400" height="400"></canvas>
                    <div class="controls">
                        <label>Learning Rate: <input type="range" id="learningRate" min="0.01" max="0.5" step="0.01" value="0.1"></label>
                        <button onclick="runGradientDescent()">Run Gradient Descent</button>
                        <button onclick="resetGradientDescent()">Reset</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Activation Functions Section -->
        <section id="activations" class="example-section">
            <h2>Activation Functions</h2>
            <div class="content-grid">
                <div class="explanation">
                    <h3>Non-Linear Transformations</h3>
                    <p>Activation functions add non-linearity to neural networks, enabling them to learn complex patterns:</p>
                    
                    <h4>Sigmoid: \( \sigma(x) = \frac{1}{1+e^{-x}} \)</h4>
                    <p>Squashes values to (0, 1). Used for binary classification.</p>
                    
                    <h4>ReLU: \( f(x) = \max(0, x) \)</h4>
                    <p>Most popular! Simple and effective. Returns x if positive, 0 otherwise.</p>
                    
                    <h4>Tanh: \( \tanh(x) = \frac{e^x - e^{-x}}{e^x + e^{-x}} \)</h4>
                    <p>Squashes values to (-1, 1). Zero-centered version of sigmoid.</p>
                </div>
                <div class="visualization">
                    <canvas id="activationCanvas" width="400" height="400"></canvas>
                    <div class="controls">
                        <label>
                            <input type="checkbox" id="showSigmoid" checked> Sigmoid
                        </label>
                        <label>
                            <input type="checkbox" id="showReLU" checked> ReLU
                        </label>
                        <label>
                            <input type="checkbox" id="showTanh" checked> Tanh
                        </label>
                    </div>
                </div>
            </div>
        </section>
        </section>

        <section class="chapter" data-chapter="neural">
            <nav class="chapter-nav" aria-label="Neural network sections">
                <a href="#neural-network">Overview</a>
                <a href="#backprop">Backpropagation</a>
                <a href="#transformer-advanced">Transformer Deep Dive</a>
            </nav>

            <!-- Neural Network Section -->
            <section id="neural-network" class="example-section">
                <h2>Neural Networks: From Neurons to Transformers</h2>
            <p class="section-intro">Zoom in from a single neuron all the way up to deep networks, CNNs, RNNs, LSTMs, and transformers. Each module walks step-by-step and animates the flow.</p>

            <div class="neural-module">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Forward propagation refresher</h3>
                        <p>A network is stacked math. Inputs become features, hidden layers reshape them, and the output layer turns them into predictions.</p>
                        <ol class="step-list">
                            <li><strong>Input layer</strong>: normalized features (pixels, embeddings, sensor readings).</li>
                            <li><strong>Hidden layers</strong>: weighted sums + activations build new features.</li>
                            <li><strong>Output layer</strong>: scores or probabilities for each class.</li>
                        </ol>
                        <div class="math-formula">
                            \[
                            \text{hidden} = \text{activation}(\text{input} \times W_1 + b_1)
                            \]
                            \[
                            \text{output} = \text{activation}(\text{hidden} \times W_2 + b_2)
                            \]
                        </div>
                        <p class="example-note">Inference stops here. Training continues with loss, backprop, and weight updates.</p>
                    </div>
                    <div class="visualization">
                        <canvas id="neuralNetCanvas" width="400" height="400"></canvas>
                        <div class="controls">
                            <button onclick="runForwardProp()">Run Forward Propagation</button>
                            <button onclick="resetNetwork()">Reset</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module">
                <div class="explanation">
                    <h3>Neural network architectures at a glance</h3>
                    <p>Different architectures specialize in different kinds of data: images, sequences, or long-range context.</p>
                    <ul class="concept-bullets">
                        <li>Feedforward nets handle tabular features and classic classification.</li>
                        <li>CNNs are spatial pattern detectors for images and video.</li>
                        <li>RNNs and LSTMs handle sequences over time.</li>
                        <li>Transformers scale to long context across domains.</li>
                    </ul>
                </div>
                <div class="architecture-grid">
                    <article class="architecture-card" style="--arch-accent: var(--accent-1);">
                        <h4>Feedforward (MLP)</h4>
                        <svg class="arch-diagram" viewBox="0 0 180 120" role="img" aria-label="Feedforward network architecture">
                            <line class="arch-stroke" x1="30" y1="20" x2="90" y2="35"></line>
                            <line class="arch-stroke" x1="30" y1="20" x2="90" y2="60"></line>
                            <line class="arch-stroke" x1="30" y1="50" x2="90" y2="35"></line>
                            <line class="arch-stroke" x1="30" y1="50" x2="90" y2="60"></line>
                            <line class="arch-stroke" x1="90" y1="35" x2="150" y2="50"></line>
                            <line class="arch-stroke" x1="90" y1="60" x2="150" y2="50"></line>
                            <circle class="arch-node" cx="30" cy="20" r="6"></circle>
                            <circle class="arch-node" cx="30" cy="50" r="6"></circle>
                            <circle class="arch-node" cx="90" cy="35" r="6"></circle>
                            <circle class="arch-node" cx="90" cy="60" r="6"></circle>
                            <circle class="arch-node" cx="150" cy="50" r="6"></circle>
                        </svg>
                        <p class="example-note">Classic dense layers for structured data.</p>
                    </article>
                    <article class="architecture-card" style="--arch-accent: var(--accent-2);">
                        <h4>Deep Neural Network</h4>
                        <svg class="arch-diagram" viewBox="0 0 180 120" role="img" aria-label="Deep neural network architecture">
                            <line class="arch-stroke" x1="20" y1="25" x2="60" y2="25"></line>
                            <line class="arch-stroke" x1="60" y1="25" x2="100" y2="25"></line>
                            <line class="arch-stroke" x1="100" y1="25" x2="140" y2="25"></line>
                            <line class="arch-stroke" x1="140" y1="25" x2="170" y2="25"></line>
                            <circle class="arch-node" cx="20" cy="25" r="6"></circle>
                            <circle class="arch-node" cx="60" cy="25" r="6"></circle>
                            <circle class="arch-node" cx="100" cy="25" r="6"></circle>
                            <circle class="arch-node" cx="140" cy="25" r="6"></circle>
                            <circle class="arch-node" cx="170" cy="25" r="6"></circle>
                            <line class="arch-stroke" x1="20" y1="65" x2="60" y2="65"></line>
                            <line class="arch-stroke" x1="60" y1="65" x2="100" y2="65"></line>
                            <line class="arch-stroke" x1="100" y1="65" x2="140" y2="65"></line>
                            <line class="arch-stroke" x1="140" y1="65" x2="170" y2="65"></line>
                            <circle class="arch-node" cx="20" cy="65" r="6"></circle>
                            <circle class="arch-node" cx="60" cy="65" r="6"></circle>
                            <circle class="arch-node" cx="100" cy="65" r="6"></circle>
                            <circle class="arch-node" cx="140" cy="65" r="6"></circle>
                            <circle class="arch-node" cx="170" cy="65" r="6"></circle>
                        </svg>
                        <p class="example-note">Stacks many layers to build feature hierarchies.</p>
                    </article>
                    <article class="architecture-card" style="--arch-accent: var(--accent-3);">
                        <h4>Convolutional Network</h4>
                        <svg class="arch-diagram" viewBox="0 0 180 120" role="img" aria-label="Convolutional neural network architecture">
                            <rect class="arch-box" x="20" y="20" width="40" height="40"></rect>
                            <rect class="arch-box" x="70" y="30" width="24" height="24"></rect>
                            <rect class="arch-box" x="110" y="26" width="40" height="40"></rect>
                            <line class="arch-stroke" x1="60" y1="40" x2="70" y2="40"></line>
                            <line class="arch-stroke" x1="94" y1="40" x2="110" y2="40"></line>
                            <rect class="arch-box" x="20" y="70" width="40" height="30"></rect>
                            <rect class="arch-box" x="70" y="78" width="24" height="20"></rect>
                            <rect class="arch-box" x="110" y="72" width="40" height="30"></rect>
                        </svg>
                        <p class="example-note">Filters slide across images to find patterns.</p>
                    </article>
                    <article class="architecture-card" style="--arch-accent: var(--accent-4);">
                        <h4>Recurrent Network</h4>
                        <svg class="arch-diagram" viewBox="0 0 180 120" role="img" aria-label="Recurrent neural network architecture">
                            <rect class="arch-box" x="20" y="45" width="32" height="32"></rect>
                            <rect class="arch-box" x="74" y="45" width="32" height="32"></rect>
                            <rect class="arch-box" x="128" y="45" width="32" height="32"></rect>
                            <line class="arch-stroke" x1="52" y1="61" x2="74" y2="61"></line>
                            <line class="arch-stroke" x1="106" y1="61" x2="128" y2="61"></line>
                            <path class="arch-stroke" d="M36 45 C36 25, 60 25, 60 45"></path>
                            <path class="arch-stroke" d="M36 45 L36 35"></path>
                        </svg>
                        <p class="example-note">State flows through time for sequences.</p>
                    </article>
                    <article class="architecture-card" style="--arch-accent: var(--accent-1);">
                        <h4>LSTM</h4>
                        <svg class="arch-diagram" viewBox="0 0 180 120" role="img" aria-label="LSTM architecture">
                            <rect class="arch-box" x="20" y="40" width="60" height="40"></rect>
                            <circle class="arch-node" cx="110" cy="50" r="8"></circle>
                            <circle class="arch-node" cx="140" cy="50" r="8"></circle>
                            <circle class="arch-node" cx="125" cy="80" r="8"></circle>
                            <line class="arch-stroke" x1="80" y1="60" x2="102" y2="54"></line>
                            <line class="arch-stroke" x1="80" y1="60" x2="130" y2="54"></line>
                            <line class="arch-stroke" x1="80" y1="60" x2="118" y2="76"></line>
                        </svg>
                        <p class="example-note">Gated memory handles long-range signals.</p>
                    </article>
                    <article class="architecture-card" style="--arch-accent: var(--accent-2);">
                        <h4>Transformer</h4>
                        <svg class="arch-diagram" viewBox="0 0 180 120" role="img" aria-label="Transformer architecture">
                            <rect class="arch-box" x="25" y="20" width="130" height="20"></rect>
                            <rect class="arch-box" x="25" y="45" width="130" height="20"></rect>
                            <rect class="arch-box" x="25" y="70" width="130" height="20"></rect>
                            <line class="arch-stroke" x1="90" y1="10" x2="90" y2="100"></line>
                        </svg>
                        <p class="example-note">Self-attention mixes all tokens at once.</p>
                    </article>
                </div>
            </div>

            <div class="neural-module">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Neuron basics: weighted sum -&gt; activation</h3>
                        <p>Each neuron multiplies inputs by weights, adds a bias, then runs an activation function.</p>
                        <ol class="step-list">
                            <li>Inputs arrive as numbers.</li>
                            <li>Weights scale each input.</li>
                            <li>Bias shifts the total.</li>
                            <li>Activation decides the output.</li>
                        </ol>
                        <div class="math-formula">
                            \[
                            z = \sum_i x_i w_i + b, \quad a = f(z)
                            \]
                        </div>
                        <div class="example-chips" role="group" aria-label="Neuron examples">
                            <button class="toggle-btn is-active" type="button" data-neuron-example="stroke">Stroke detector</button>
                            <button class="toggle-btn" type="button" data-neuron-example="curve">Curve detector</button>
                            <button class="toggle-btn" type="button" data-neuron-example="noise">Noise filter</button>
                        </div>
                        <p class="example-note" id="neuronExampleNote"></p>
                        <div class="neural-readout">
                            <div class="readout-card">
                                <span class="readout-label">Inputs x</span>
                                <span class="readout-value" id="neuronInputs">[0, 0, 0]</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Weights w</span>
                                <span class="readout-value" id="neuronWeights">[0, 0, 0]</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Weighted sum z</span>
                                <span class="readout-value" id="neuronWeightedSum">0</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Bias b</span>
                                <span class="readout-value" id="neuronBias">0</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Activation a</span>
                                <span class="readout-value" id="neuronActivation">0</span>
                            </div>
                        </div>
                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="neuronStepBadge">Step 1 of 4</span>
                                <h4 id="neuronStepTitle">Inputs arrive</h4>
                            </div>
                            <p id="neuronStepText"></p>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="neuronCanvas" width="420" height="320"></canvas>
                        <div class="controls">
                            <button type="button" id="neuronPrevStep">Previous step</button>
                            <button type="button" id="neuronNextStep">Next step</button>
                            <button type="button" id="neuronPlay">Play loop</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Digit recognition: inference vs training</h3>
                        <p>Simple digit recognition starts from pixels, transforms them into hidden features, and predicts a digit.</p>
                        <div class="step-grid">
                            <div class="step-card">
                                <h4>Inference (predict)</h4>
                                <ol>
                                    <li>Read the image.</li>
                                    <li>Flatten + normalize.</li>
                                    <li>Hidden activations.</li>
                                    <li>Output probabilities.</li>
                                </ol>
                            </div>
                            <div class="step-card">
                                <h4>Training (learn)</h4>
                                <ol>
                                    <li>Forward pass (same as inference).</li>
                                    <li>Compute loss vs label.</li>
                                    <li>Backpropagate gradients.</li>
                                    <li>Update weights.</li>
                                </ol>
                            </div>
                        </div>
                        <div class="example-chips" role="group" aria-label="Digit examples">
                            <button class="toggle-btn is-active" type="button" data-digit-example="zero">Digit 0</button>
                            <button class="toggle-btn" type="button" data-digit-example="three">Digit 3</button>
                            <button class="toggle-btn" type="button" data-digit-example="seven">Digit 7</button>
                        </div>
                        <p class="example-note" id="digitExampleNote"></p>
                        <div class="toggle-group" role="group" aria-label="Digit mode">
                            <button class="toggle-btn is-active" type="button" data-digit-mode="inference">Inference</button>
                            <button class="toggle-btn" type="button" data-digit-mode="training">Training</button>
                        </div>
                        <div class="neural-readout">
                            <div class="readout-card">
                                <span class="readout-label">Target</span>
                                <span class="readout-value" id="digitTarget">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Prediction</span>
                                <span class="readout-value" id="digitPrediction">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Loss</span>
                                <span class="readout-value" id="digitLoss">-</span>
                            </div>
                        </div>
                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="digitStepBadge">Step 1 of 4</span>
                                <h4 id="digitStepTitle">Image input</h4>
                            </div>
                            <p id="digitStepText"></p>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="digitLabCanvas" width="420" height="340"></canvas>
                        <div class="controls">
                            <button type="button" id="digitPrevStep">Previous step</button>
                            <button type="button" id="digitNextStep">Next step</button>
                            <button type="button" id="digitPlay">Play loop</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module" id="backprop">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Backpropagation: step-by-step</h3>
                        <p>Backpropagation computes how each weight should change to reduce the loss.</p>
                        <ol class="step-list">
                            <li><strong>Forward pass</strong>: compute predictions.</li>
                            <li><strong>Loss</strong>: compare prediction to target.</li>
                            <li><strong>Backward pass</strong>: send gradients backward.</li>
                            <li><strong>Update</strong>: adjust weights with the learning rate.</li>
                        </ol>
                        <div class="math-formula">
                            \[
                            \frac{\partial L}{\partial w} = \frac{\partial L}{\partial \text{output}} \cdot \frac{\partial \text{output}}{\partial w}
                            \]
                        </div>
                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="backpropStepBadge">Step 1 of 4</span>
                                <h4 id="backpropStepTitle">Forward pass</h4>
                            </div>
                            <p id="backpropStepText"></p>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="backpropCanvas" width="400" height="400"></canvas>
                        <div class="controls">
                            <button type="button" id="backpropPrevStep">Previous step</button>
                            <button type="button" id="backpropNextStep">Next step</button>
                            <button type="button" id="backpropPlay">Play steps</button>
                            <button type="button" id="backpropReset">Reset</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Deep neural networks: stacking layers</h3>
                        <p>More layers let the model build a hierarchy of features.</p>
                        <ul class="concept-bullets">
                            <li>Early layers: edges and simple shapes.</li>
                            <li>Middle layers: textures and parts.</li>
                            <li>Late layers: whole objects or concepts.</li>
                        </ul>
                        <p class="example-note">Examples: face recognition, speech-to-text, medical scans.</p>
                    </div>
                    <div class="visualization">
                        <canvas id="deepNetCanvas" width="420" height="320"></canvas>
                        <div class="controls">
                            <div class="slider-group">
                                <span class="slider-title">Depth</span>
                                <label>Layers <span id="deepDepthVal">5</span></label>
                                <input type="range" id="deepDepth" min="3" max="7" step="1" value="5">
                            </div>
                            <button type="button" id="deepRun">Run signal</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>CNNs: slide a filter across the image</h3>
                        <p>Convolutions scan a small filter across pixels to detect patterns like edges or corners.</p>
                        <ul class="concept-bullets">
                            <li>Shared weights detect the same pattern anywhere.</li>
                            <li>Pooling summarizes nearby activations.</li>
                            <li>Stacked filters build complex features.</li>
                        </ul>
                        <div class="example-chips" role="group" aria-label="CNN examples">
                            <button class="toggle-btn is-active" type="button" data-cnn-example="edge">Edge detector</button>
                            <button class="toggle-btn" type="button" data-cnn-example="corner">Corner detector</button>
                            <button class="toggle-btn" type="button" data-cnn-example="diagonal">Diagonal stroke</button>
                        </div>
                        <p class="example-note" id="cnnExampleNote"></p>
                        <div class="neural-readout">
                            <div class="readout-card">
                                <span class="readout-label">Patch</span>
                                <span class="readout-value" id="cnnPatch">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Output value</span>
                                <span class="readout-value" id="cnnOutputValue">-</span>
                            </div>
                        </div>
                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="cnnStepBadge">Step 1 of 16</span>
                                <h4 id="cnnStepTitle">Filter sweep</h4>
                            </div>
                            <p id="cnnStepText"></p>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="cnnCanvas" width="420" height="320"></canvas>
                        <div class="controls">
                            <button type="button" id="cnnPrevStep">Previous patch</button>
                            <button type="button" id="cnnNextStep">Next patch</button>
                            <button type="button" id="cnnPlay">Play sweep</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>RNNs: memory over time</h3>
                        <p>Recurrent networks reuse the same weights at every time step, passing a hidden state forward.</p>
                        <ul class="concept-bullets">
                            <li>Hidden state stores short-term memory.</li>
                            <li>Great for sequences like text or sensor data.</li>
                            <li>Outputs can appear at every step.</li>
                        </ul>
                        <div class="example-chips" role="group" aria-label="RNN examples">
                            <button class="toggle-btn is-active" type="button" data-rnn-example="sentence">Next word</button>
                            <button class="toggle-btn" type="button" data-rnn-example="weather">Forecast</button>
                            <button class="toggle-btn" type="button" data-rnn-example="music">Music pattern</button>
                        </div>
                        <p class="example-note" id="rnnExampleNote"></p>
                        <div class="neural-readout">
                            <div class="readout-card">
                                <span class="readout-label">Token</span>
                                <span class="readout-value" id="rnnToken">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Hidden state</span>
                                <span class="readout-value" id="rnnHidden">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Next output</span>
                                <span class="readout-value" id="rnnOutput">-</span>
                            </div>
                        </div>
                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="rnnStepBadge">Step 1 of 4</span>
                                <h4 id="rnnStepTitle">Time step 1</h4>
                            </div>
                            <p id="rnnStepText"></p>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="rnnCanvas" width="420" height="320"></canvas>
                        <div class="controls">
                            <button type="button" id="rnnPrevStep">Previous step</button>
                            <button type="button" id="rnnNextStep">Next step</button>
                            <button type="button" id="rnnPlay">Play sequence</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>LSTM: long-short term memory</h3>
                        <p>LSTMs add gates that decide what to forget, what to write, and what to output.</p>
                        <ul class="concept-bullets">
                            <li>Forget gate keeps or drops old memory.</li>
                            <li>Input gate writes new information.</li>
                            <li>Output gate reveals the right part.</li>
                        </ul>
                        <div class="example-chips" role="group" aria-label="LSTM examples">
                            <button class="toggle-btn is-active" type="button" data-lstm-example="story">Story clue</button>
                            <button class="toggle-btn" type="button" data-lstm-example="quotes">Quote tracking</button>
                            <button class="toggle-btn" type="button" data-lstm-example="sensor">Sensor drift</button>
                        </div>
                        <p class="example-note" id="lstmExampleNote"></p>
                        <div class="neural-readout">
                            <div class="readout-card">
                                <span class="readout-label">Memory before</span>
                                <span class="readout-value" id="lstmMemoryBefore">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Forget gate</span>
                                <span class="readout-value" id="lstmForgetGate">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Input gate</span>
                                <span class="readout-value" id="lstmInputGate">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Output gate</span>
                                <span class="readout-value" id="lstmOutputGate">-</span>
                            </div>
                        </div>
                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="lstmStepBadge">Step 1 of 4</span>
                                <h4 id="lstmStepTitle">Forget gate</h4>
                            </div>
                            <p id="lstmStepText"></p>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="lstmCanvas" width="420" height="320"></canvas>
                        <div class="controls">
                            <button type="button" id="lstmPrevStep">Previous gate</button>
                            <button type="button" id="lstmNextStep">Next gate</button>
                            <button type="button" id="lstmPlay">Play gates</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module">
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Transformers: staged pipeline</h3>
                        <p>Transformers process all tokens at once, then use attention to mix information.</p>
                        <ol class="step-list">
                            <li>Tokenize and embed.</li>
                            <li>Add positional encoding.</li>
                            <li>Self-attention mixes context.</li>
                            <li>Feedforward + residual.</li>
                            <li>Output probabilities.</li>
                        </ol>
                        <div class="example-chips" role="group" aria-label="Transformer examples">
                            <button class="toggle-btn is-active" type="button" data-transformer-example="translate">Translation</button>
                            <button class="toggle-btn" type="button" data-transformer-example="summary">Summarization</button>
                            <button class="toggle-btn" type="button" data-transformer-example="code">Code completion</button>
                        </div>
                        <p class="example-note" id="transformerExampleNote"></p>
                        <div class="example-chips" role="group" aria-label="Transformer stages">
                            <button class="toggle-btn is-active" type="button" data-transformer-stage="0">Embed</button>
                            <button class="toggle-btn" type="button" data-transformer-stage="1">Positions</button>
                            <button class="toggle-btn" type="button" data-transformer-stage="2">Attention</button>
                            <button class="toggle-btn" type="button" data-transformer-stage="3">Feedforward</button>
                            <button class="toggle-btn" type="button" data-transformer-stage="4">Output</button>
                        </div>
                        <div class="neural-readout">
                            <div class="readout-card">
                                <span class="readout-label">Tokens</span>
                                <span class="readout-value" id="transformerTokenCount">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Focus token</span>
                                <span class="readout-value" id="transformerFocusToken">-</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Stage</span>
                                <span class="readout-value" id="transformerStageLabel">-</span>
                            </div>
                        </div>
                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="transformerStageBadge">Stage 1 of 5</span>
                                <h4 id="transformerStageTitle">Tokenize + embed</h4>
                            </div>
                            <p id="transformerStageText"></p>
                        </div>
                    </div>
                    <div class="visualization">
                        <canvas id="transformerCanvas" width="420" height="340"></canvas>
                        <div class="controls">
                            <button type="button" id="transformerPrevStage">Previous stage</button>
                            <button type="button" id="transformerNextStage">Next stage</button>
                            <button type="button" id="transformerPlay">Play stages</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="neural-module transformer-advanced" id="transformer-advanced">
                <div class="content-grid transformer-advanced-grid">
                    <div class="explanation">
                        <h3>Advanced Transformer Model: step-by-step visualization</h3>
                        <p class="section-intro">Use the stepper to follow the full Transformer pipeline without leaving the visuals.</p>

                        <div class="scene-panel step-panel" aria-live="polite">
                            <div class="scene-header">
                                <span class="scene-badge" id="transformerAdvancedBadge">Step 1 of 15</span>
                                <h4 id="transformerAdvancedTitle">Tokenization</h4>
                            </div>
                            <p id="transformerAdvancedText"></p>
                            <ul class="step-points" id="transformerAdvancedPoints"></ul>
                            <div class="math-formula" id="transformerAdvancedMath"></div>
                        </div>

                        <div class="example-chips transformer-advanced-steps" role="group" aria-label="Transformer advanced steps">
                            <button class="toggle-btn is-active" type="button" data-transformer-advanced-step="0">Tokenize</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="1">Token embed</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="2">Position</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="3">Final embed</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="4">QKV</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="5">Split heads</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="6">QK^T</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="7">Mask</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="8">Softmax</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="9">Concat</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="10">MLP expand</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="11">MLP project</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="12">Logits</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="13">Sampling</button>
                            <button class="toggle-btn" type="button" data-transformer-advanced-step="14">Aux</button>
                        </div>

                        <div class="neural-readout">
                            <div class="readout-card">
                                <span class="readout-label">Model</span>
                                <span class="readout-value">GPT-2 (small)</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Embedding dim</span>
                                <span class="readout-value">768</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Heads</span>
                                <span class="readout-value">12</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Blocks</span>
                                <span class="readout-value">12</span>
                            </div>
                            <div class="readout-card">
                                <span class="readout-label">Vocabulary</span>
                                <span class="readout-value">50,257</span>
                            </div>
                        </div>

                        <details class="reference-drawer">
                            <summary>Reference narrative (full explanation)</summary>
                            <div class="guide-stack">
                                <article class="guide-card">
                                    <h4>What is a Transformer?</h4>
                                    <p>Transformer is a neural network architecture that has fundamentally changed the approach to artificial intelligence. It was introduced in the 2017 paper "Attention is All You Need" and now powers models like OpenAI GPT, Meta Llama, and Google Gemini.</p>
                                    <p>Transformers are not limited to text. They also drive audio generation, image recognition, protein structure prediction, and game playing, showing how broadly the architecture applies across domains.</p>
                                    <p>Text-generative Transformers operate on next-token prediction: given a prompt, the model estimates the most probable next token. The core innovation is self-attention, which lets all tokens communicate and capture long-range dependencies.</p>
                                    <p>Transformer Explainer is powered by GPT-2 (small) with 124 million parameters. While it is not the largest model, its components match the structure of more recent systems.</p>
                                </article>

                                <article class="guide-card">
                                    <h4>Transformer architecture</h4>
                                    <p>Every text-generative Transformer consists of three components:</p>
                                    <ul class="concept-bullets">
                                        <li><strong>Embedding</strong>: tokens become vectors and receive positional signals.</li>
                                        <li><strong>Transformer block</strong>: multi-head attention routes context; an MLP refines each token.</li>
                                        <li><strong>Output probabilities</strong>: logits are turned into a probability distribution for the next token.</li>
                                    </ul>
                                </article>

                                <article class="guide-card">
                                    <h4>Embedding pipeline</h4>
                                    <p>Suppose the prompt is: "Data visualization empowers users to". Embedding converts this text into a numerical representation in four steps:</p>
                                    <ol class="step-list">
                                        <li><strong>Tokenization</strong>: split into word or subword tokens.</li>
                                        <li><strong>Token embedding</strong>: map tokens to a vector space.</li>
                                        <li><strong>Positional encoding</strong>: add position information.</li>
                                        <li><strong>Final embedding</strong>: sum token and positional vectors.</li>
                                    </ol>
                                    <p class="figure-note">Figure 1. Expanding the embedding view: tokenization, token embedding, positional encoding, and final embedding.</p>
                                    <p>GPT-2 (small) uses 768-dimensional embeddings and a vocabulary of 50,257 tokens. The embedding matrix has shape (50,257, 768) with about 39 million parameters.</p>
                                </article>

                                <article class="guide-card">
                                    <h4>Transformer block</h4>
                                    <p>The block combines multi-head self-attention and an MLP. GPT-2 (small) stacks 12 blocks, allowing token representations to evolve into higher-level meanings over depth.</p>
                                    <p>Multi-head attention captures context across tokens. The MLP processes each token independently to refine its representation.</p>
                                </article>

                                <article class="guide-card">
                                    <h4>Multi-head self-attention</h4>
                                    <p>Each token is transformed into Query (Q), Key (K), and Value (V) vectors:</p>
                                    <div class="math-formula">
                                        \[
                                        QKV_{ij} = \left( \sum_{d=1}^{768} \text{Embedding}_{i,d} \cdot \text{Weights}_{d,j} \right) + \text{Bias}_j
                                        \]
                                    </div>
                                    <p>Query is like the search text, Key is the result title, and Value is the page content. This analogy helps explain why attention scores route information from relevant tokens.</p>
                                    <p class="figure-note">Figure 2. Computing Q, K, and V from the embedding.</p>
                                    <ul class="concept-bullets">
                                        <li><strong>Split into heads</strong>: GPT-2 uses 12 attention heads.</li>
                                        <li><strong>Masked attention</strong>: prevents peeking at future tokens.</li>
                                        <li><strong>Concat + projection</strong>: heads are merged for the next stage.</li>
                                    </ul>
                                    <p>Scaling and masking set future positions to negative infinity so each token predicts without looking ahead.</p>
                                    <p class="figure-note">Figure 3. Masked self-attention: dot product, scale + mask, softmax + dropout.</p>
                                </article>

                                <article class="guide-card">
                                    <h4>MLP: multi-layer perceptron</h4>
                                    <p>The MLP expands each token from 768 to 3072 dimensions with a GELU activation, then compresses back to 768. This enriches the representation independently per token.</p>
                                    <p class="figure-note">Figure 4. The MLP expands then compresses each token representation.</p>
                                </article>

                                <article class="guide-card">
                                    <h4>Output probabilities and sampling</h4>
                                    <p>The final linear layer maps to 50,257 logits, one for each token in the vocabulary. Softmax turns logits into probabilities for the next token.</p>
                                    <p class="figure-note">Figure 5. Each token receives a probability from the output logits.</p>
                                    <p>Temperature controls sharpness: T=1 keeps logits unchanged, T&lt;1 makes outputs more deterministic, and T&gt;1 increases randomness.</p>
                                    <div class="info-grid">
                                        <div class="info-card">
                                            <h5>Temperature</h5>
                                            <p>Lower values make outputs more deterministic; higher values add creativity.</p>
                                        </div>
                                        <div class="info-card">
                                            <h5>Top-k</h5>
                                            <p>Restrict sampling to the top k highest-probability tokens.</p>
                                        </div>
                                        <div class="info-card">
                                            <h5>Top-p</h5>
                                            <p>Sample from the smallest set whose cumulative probability exceeds p.</p>
                                        </div>
                                    </div>
                                </article>

                                <article class="guide-card">
                                    <h4>Auxiliary architectural features</h4>
                                    <p>Layer normalization stabilizes training and is applied twice per block. Dropout regularizes by randomly deactivating units during training and is disabled during inference. Residual connections add skip paths twice per block, helping gradients flow and preventing vanishing gradients.</p>
                                </article>
                            </div>
                        </details>
                    </div>
                    <div class="visualization transformer-advanced-visuals">
                        <div class="transformer-advanced-canvas-grid">
                            <canvas id="transformerAdvancedOverviewCanvas" width="420" height="200"></canvas>
                            <canvas id="transformerAdvancedCanvas" width="420" height="320"></canvas>
                        </div>
                        <p class="figure-note">The overview highlights where you are in the stack; the detail panel shows the math.</p>
                        <div class="controls">
                            <button type="button" id="transformerAdvancedPrev">Previous step</button>
                            <button type="button" id="transformerAdvancedNext">Next step</button>
                            <button type="button" id="transformerAdvancedPlay">Play steps</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        </section>

        <section class="chapter" data-chapter="llm-foundations">
            <nav class="chapter-nav" aria-label="LLM foundations sections">
                <a href="#llm-tutorial">Tutorial</a>
                <a href="#prompt-engineering">Prompt Engineering</a>
                <a href="#llm-fundamentals">LLM Fundamentals</a>
                <a href="#ai-agents">AI Agents</a>
            </nav>

            <!-- LLM Tutorial Section -->
            <section id="llm-tutorial" class="example-section">
                <h2>LLM Foundations: Guided Tutorial</h2>
                <p class="section-intro">A hands-on path that ties prompting, model behavior, and agent building into one workflow.</p>
                <div class="learning-path">
                    <div class="path-card">
                        <span class="path-step">Step 1</span>
                        <h4>Frame the task</h4>
                        <p>Define the role, goal, and success criteria before you write prompts.</p>
                        <span class="path-goal">Goal: a clear, testable objective.</span>
                    </div>
                    <div class="path-card">
                        <span class="path-step">Step 2</span>
                        <h4>Structure the prompt</h4>
                        <p>Use context blocks, constraints, and a target format.</p>
                        <span class="path-goal">Goal: predictable, repeatable outputs.</span>
                    </div>
                    <div class="path-card">
                        <span class="path-step">Step 3</span>
                        <h4>Inspect model behavior</h4>
                        <p>Adjust temperature, context, and stop rules to stabilize responses.</p>
                        <span class="path-goal">Goal: reduce variance and hallucinations.</span>
                    </div>
                    <div class="path-card">
                        <span class="path-step">Step 4</span>
                        <h4>Add tools</h4>
                        <p>Introduce tool calling for data access or automation.</p>
                        <span class="path-goal">Goal: verified outputs with traceability.</span>
                    </div>
                    <div class="path-card">
                        <span class="path-step">Step 5</span>
                        <h4>Evaluate and iterate</h4>
                        <p>Write evals, measure regressions, and refine.</p>
                        <span class="path-goal">Goal: steady improvements with evidence.</span>
                    </div>
                </div>
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Quick tutorial checklist</h3>
                        <ol class="step-list">
                            <li>Collect 5 real inputs and draft a baseline prompt.</li>
                            <li>Define the output format and failure cases.</li>
                            <li>Create a tool schema for any external data.</li>
                            <li>Write 5 evals with expected results.</li>
                            <li>Iterate until the eval pass rate stabilizes.</li>
                        </ol>
                        <div class="mini-mission">Mini mission: run a 5-example eval before you ship.</div>
                    </div>
                    <div class="visualization card-column">
                        <div class="prompt-template">
                            <h4>Tutorial starter prompt</h4>
                            <pre>ROLE: You are an AI PM.
TASK: Draft a 1-page feature brief.
CONTEXT:
"""
Include 5 user notes, metrics, and constraints.
"""
CONSTRAINTS: 250 words max. Bullet format.
OUTPUT FORMAT:
- Problem
- Users
- Constraints
- Proposal
- Risks
CHECKS: List missing inputs.</pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Prompt Engineering Section -->
            <section id="prompt-engineering" class="example-section">
                <h2>Prompt Engineering: Crafting Clear Instructions</h2>
                <p class="section-intro">Design prompts that reduce ambiguity, keep responses grounded, and make iteration fast.</p>
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Prompt anatomy</h3>
                        <ul class="concept-bullets">
                            <li><strong>Role</strong>: who the model is acting as.</li>
                            <li><strong>Goal</strong>: the task and the success criteria.</li>
                            <li><strong>Context</strong>: background data, definitions, and scope.</li>
                            <li><strong>Constraints</strong>: length, tone, must include, must avoid.</li>
                            <li><strong>Output format</strong>: schema, bullets, JSON, table.</li>
                            <li><strong>Checks</strong>: ask for missing info or confidence notes.</li>
                        </ul>
                        <div class="mini-mission">Mini mission: rewrite a vague request into a 6-part prompt.</div>
                        <div class="guide-stack">
                            <article class="guide-card">
                                <h4>Pattern: Delimiters + grounding</h4>
                                <p>Use clear separators so the model knows what to quote, summarize, or transform.</p>
                            </article>
                            <article class="guide-card">
                                <h4>Pattern: Few-shot exemplars</h4>
                                <p>Add one or two examples that match the output style you want.</p>
                            </article>
                            <article class="guide-card">
                                <h4>Pattern: Self-checks</h4>
                                <p>Ask for a brief verification step or uncertainties before the final answer.</p>
                            </article>
                        </div>
                    </div>
                    <div class="visualization card-column">
                        <div class="prompt-template">
                            <h4>Prompt template</h4>
                            <pre>ROLE: You are a product analyst.
TASK: Summarize customer feedback into 3 themes.
CONTEXT:
"""
Paste notes here.
"""
CONSTRAINTS: Max 8 bullets. No speculation.
OUTPUT FORMAT:
- Theme:
- Evidence:
CHECKS: Flag missing data.</pre>
                        </div>
                        <div class="prompt-template">
                            <h4>Prompt technique examples</h4>
                            <pre>Technique: Role + constraints
ROLE: You are a support analyst.
TASK: Summarize the ticket in 3 bullets.
CONSTRAINTS: Neutral tone. No jargon.

Technique: Few-shot style match
TASK: Turn notes into a decision line.
EXAMPLE:
Input: "Latency 120ms, budget ok"
Output: "Decision: proceed with rollout"

Technique: Delimiters + extraction
Extract action items from &lt;notes&gt;...&lt;/notes&gt;.
Return JSON with owner, task, and due.</pre>
                        </div>
                        <div class="prompt-template">
                            <h4>Prompt refinement loop</h4>
                            <ol class="step-list">
                                <li>Draft the instruction and the output format.</li>
                                <li>Test with a real example and inspect the gaps.</li>
                                <li>Add constraints, examples, or definitions.</li>
                                <li>Repeat until outputs are stable and on-brand.</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </section>

            <!-- LLM Fundamentals Section -->
            <section id="llm-fundamentals" class="example-section">
                <h2>LLM Fundamentals: How Models Respond</h2>
                <p class="section-intro">Know the mechanics behind next-token prediction so your prompts behave consistently.</p>
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Core behaviors</h3>
                        <ul class="concept-bullets">
                            <li>LLMs predict the next token based on all prior context.</li>
                            <li>Context windows limit how much text the model can see at once.</li>
                            <li>Sampling settings trade off creativity vs stability.</li>
                            <li>System instructions set global rules; user prompts set tasks.</li>
                            <li>Hallucinations appear when the prompt is underspecified.</li>
                        </ul>
                        <div class="info-grid">
                            <div class="info-card">
                                <h5>Temperature</h5>
                                <p>Controls randomness; lower is more deterministic.</p>
                            </div>
                            <div class="info-card">
                                <h5>Top-p</h5>
                                <p>Limits choices to a probability mass.</p>
                            </div>
                            <div class="info-card">
                                <h5>Max tokens</h5>
                                <p>Budget for output length and cost.</p>
                            </div>
                            <div class="info-card">
                                <h5>Stop sequences</h5>
                                <p>End outputs at safe boundaries.</p>
                            </div>
                        </div>
                    </div>
                    <div class="visualization card-column">
                        <div class="guide-stack">
                            <article class="guide-card">
                                <h4>Prompting best practices</h4>
                                <p>See the full playbook at <a class="text-link" href="https://www.promptingguide.ai" target="_blank" rel="noopener">promptingguide.ai</a>.</p>
                                <ul class="concept-bullets">
                                    <li>Be explicit about the role, task, and constraints.</li>
                                    <li>Use delimiters to separate instructions from data.</li>
                                    <li>Provide a target format and a short example.</li>
                                    <li>Ask for assumptions, risks, or missing data.</li>
                                    <li>Iterate with real inputs, not toy prompts.</li>
                                </ul>
                            </article>
                            <article class="guide-card">
                                <h4>Context hygiene</h4>
                                <ul class="concept-bullets">
                                    <li>Keep only relevant context; remove stale instructions.</li>
                                    <li>Define terms once and reuse them consistently.</li>
                                    <li>Chunk long inputs and summarize key decisions.</li>
                                </ul>
                            </article>
                        </div>
                    </div>
                </div>
            </section>

            <!-- AI Agents Section -->
            <section id="ai-agents" class="example-section">
                <h2>AI Agents: Tool-Using Systems</h2>
                <p class="section-intro">Agents combine planning, tools, memory, and evals to finish real tasks.</p>
                <div class="content-grid">
                    <div class="explanation">
                        <h3>Agent loop</h3>
                        <ol class="step-list">
                            <li>Plan the task and choose a strategy.</li>
                            <li>Select tools and call them with structured inputs.</li>
                            <li>Observe results and update the plan.</li>
                            <li>Decide when to stop and respond.</li>
                        </ol>
                        <div class="step-grid">
                            <div class="step-card">
                                <h4>Planner</h4>
                                <p>Breaks the goal into steps and picks the next action.</p>
                            </div>
                            <div class="step-card">
                                <h4>Tool router</h4>
                                <p>Chooses APIs, search, or code execution based on the task.</p>
                            </div>
                            <div class="step-card">
                                <h4>Memory</h4>
                                <p>Stores notes, intermediate results, and long-term facts.</p>
                            </div>
                            <div class="step-card">
                                <h4>Critic</h4>
                                <p>Checks outputs, runs evals, and flags regressions.</p>
                            </div>
                        </div>
                        <h3>Tool calling basics</h3>
                        <ul class="concept-bullets">
                            <li>Define clear tool schemas with typed inputs and outputs.</li>
                            <li>Validate tool results and handle failures explicitly.</li>
                            <li>Constrain tool access with allowlists and budgets.</li>
                            <li>Log tool calls for tracing and debugging.</li>
                        </ul>
                    </div>
                    <div class="visualization card-column">
                        <div class="guide-stack">
                            <article class="guide-card">
                                <h4>How to write evals</h4>
                                <ol class="step-list">
                                    <li>Define a task set and success criteria.</li>
                                    <li>Collect examples with expected outputs.</li>
                                    <li>Use automatic checks plus human review when needed.</li>
                                    <li>Track regressions and edge cases over time.</li>
                                </ol>
                            </article>
                            <article class="guide-card">
                                <h4>Eval-driven development</h4>
                                <ol class="step-list">
                                    <li>Write evals before adding new agent logic.</li>
                                    <li>Run evals on every change to the prompt or tools.</li>
                                    <li>Promote only the changes that improve the score.</li>
                                    <li>Version datasets and prompts alongside code.</li>
                                </ol>
                            </article>
                        </div>
                        <div class="info-grid">
                            <div class="info-card">
                                <h5>Frameworks</h5>
                                <p>LangChain, LlamaIndex, and OpenAI or Anthropic SDKs.</p>
                            </div>
                            <div class="info-card">
                                <h5>Tracing</h5>
                                <p>Capture tool calls, prompts, and outputs for audits.</p>
                            </div>
                            <div class="info-card">
                                <h5>Evals</h5>
                                <p>Use unit tests, golden sets, and regression suites.</p>
                            </div>
                            <div class="info-card">
                                <h5>Safety</h5>
                                <p>Guardrails for tool use, data access, and output policy.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </section>

    </main>

    <footer>
        <p>Built with â¤ï¸ for intuitive machine learning education</p>
        <p>All visualizations are interactive - click buttons to see animations!</p>
    </footer>

    <script src="script.js"></script>
</body>
</html>
